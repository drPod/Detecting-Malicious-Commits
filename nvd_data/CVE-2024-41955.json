{
  "cve_id": "CVE-2024-41955",
  "github_data": {
    "repository": "MobSF/Mobile-Security-Framework-MobSF",
    "fix_commit": "fdaad81314f393d324c1ede79627e9d47986c8c8",
    "related_commits": [
      "fdaad81314f393d324c1ede79627e9d47986c8c8"
    ],
    "patch_url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/fdaad81314f393d324c1ede79627e9d47986c8c8.patch",
    "fix_commit_details": {
      "sha": "fdaad81314f393d324c1ede79627e9d47986c8c8",
      "commit_date": "2024-07-31T18:51:27Z",
      "author": {
        "login": "ajinabraham",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "HOTFIX: Fix and OpenRedirect vulnerability",
        "length": 42,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 29,
        "additions": 23,
        "deletions": 6
      },
      "files": [
        {
          "filename": "mobsf/MobSF/init.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n \n logger = logging.getLogger(__name__)\n \n-VERSION = '4.0.4'\n+VERSION = '4.0.5'\n BANNER = \"\"\"\n   __  __       _    ____  _____       _  _    ___  \n  |  \\/  | ___ | |__/ ___||  ___|_   _| || |  / _ \\ "
        },
        {
          "filename": "mobsf/MobSF/security.py",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -195,3 +195,13 @@ def wrap_function(oldfunction, newfunction):\n     def run(*args, **kwargs):\n         return newfunction(oldfunction, *args, **kwargs)\n     return run\n+\n+\n+def sanitize_redirect(url):\n+    \"\"\"Sanitize Redirect URL.\"\"\"\n+    root = '/'\n+    if url.startswith('//'):\n+        return root\n+    elif url.startswith('/'):\n+        return url\n+    return root"
        },
        {
          "filename": "mobsf/MobSF/views/authentication.py",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -18,6 +18,10 @@\n from django.contrib import messages\n from django.contrib.auth.decorators import login_required as lg\n \n+from mobsf.MobSF.security import (\n+    sanitize_redirect,\n+)\n+\n from brake.decorators import ratelimit\n \n \n@@ -57,7 +61,7 @@ def login_view(request):\n     else:\n         allow_pwd = False\n     nextp = request.GET.get('next', '')\n-    redirect_url = nextp if nextp.startswith('/') else '/'\n+    redirect_url = sanitize_redirect(nextp)\n     if request.user.is_authenticated:\n         return redirect(redirect_url)\n     if request.method == 'POST':"
        },
        {
          "filename": "mobsf/MobSF/views/saml2.py",
          "status": "modified",
          "additions": 6,
          "deletions": 3,
          "patch": "@@ -26,6 +26,9 @@\n from mobsf.MobSF.utils import (\n     print_n_send_error_response,\n )\n+from mobsf.MobSF.security import (\n+    sanitize_redirect,\n+)\n \n logger = logging.getLogger(__name__)\n ASSERTION_IDS = set()\n@@ -117,8 +120,8 @@ def get_redirect_url(req):\n         return redirect_url\n     relay_state = req['post_data']['RelayState']\n     # Allow only relative URLs\n-    if (relay_state and relay_state.startswith('/')):\n-        redirect_url = relay_state\n+    if relay_state:\n+        redirect_url = sanitize_redirect(relay_state)\n     return redirect_url\n \n \n@@ -139,7 +142,7 @@ def saml_login(request):\n         req = prepare_django_request(request)\n         auth = init_saml_auth(req)\n         nextp = request.GET.get('next', '')\n-        redirect_url = nextp if nextp.startswith('/') else '/'\n+        redirect_url = sanitize_redirect(nextp)\n         return redirect(auth.login(return_to=redirect_url))\n     except Exception as exp:\n         return print_n_send_error_response("
        },
        {
          "filename": "pyproject.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n [tool.poetry]\n name = \"mobsf\"\n-version = \"4.0.4\"\n+version = \"4.0.5\"\n description = \"Mobile Security Framework (MobSF) is an automated, all-in-one mobile application (Android/iOS/Windows) pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis.\"\n keywords = [\"mobsf\", \"mobile security framework\", \"mobile security\", \"security tool\", \"static analysis\", \"dynamic analysis\", \"malware analysis\"]\n authors = [\"Ajin Abraham <ajin@opensecurity.in>\"]"
        }
      ],
      "file_patterns": {
        "security_files": 2,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "79b2d28c3b45dd176b0e63bd3deef2608960339a",
            "date": "2024-12-19T02:35:11Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "180de6b6110c9deba5284ae65ffaa46b660516ad",
            "date": "2024-12-18T01:56:54Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "17332e88c0f6c264c689af4eeedd515327c2713c",
            "date": "2024-12-18T01:56:25Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "fbf567446bfe818b179aed074ec5f2c4de3915d3",
            "date": "2024-12-18T01:03:03Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "3223736d93b2c7e4b55e739e135f5d728d0b66dd",
            "date": "2024-12-12T02:08:06Z",
            "author_login": "ajinabraham"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:L/I:H/A:N",
    "cwe_id": "CWE-601",
    "description": "Mobile Security Framework (MobSF) is a security research platform for mobile applications in Android, iOS and Windows Mobile. An open redirect vulnerability exist in MobSF authentication view. Update to MobSF v4.0.5.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-31T20:15:06.793",
    "last_modified": "2024-08-15T14:10:40.157",
    "fix_date": "2024-07-31T18:51:27Z"
  },
  "references": [
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/fdaad81314f393d324c1ede79627e9d47986c8c8",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-8m9j-2f32-2vx4",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.515419",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Mobile-Security-Framework-MobSF",
    "owner": "MobSF",
    "created_at": "2015-01-31T04:36:01Z",
    "updated_at": "2025-01-14T12:25:42Z",
    "pushed_at": "2024-12-19T02:35:13Z",
    "size": 1525379,
    "stars": 17868,
    "forks": 3277,
    "open_issues": 13,
    "watchers": 17868,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 1582153,
      "Python": 1354876,
      "HTML": 1073775,
      "CSS": 148866,
      "Shell": 11552,
      "Batchfile": 4318,
      "PowerShell": 3089,
      "Dockerfile": 2892
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:25:15.645730"
  }
}