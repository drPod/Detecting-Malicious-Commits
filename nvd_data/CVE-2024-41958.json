{
  "cve_id": "CVE-2024-41958",
  "github_data": {
    "repository": "mailcow/mailcow-dockerized",
    "fix_commit": "f33d82ffc11ed3438609d4e7a6baa78cb3305bc3",
    "related_commits": [
      "f33d82ffc11ed3438609d4e7a6baa78cb3305bc3"
    ],
    "patch_url": "https://github.com/mailcow/mailcow-dockerized/commit/f33d82ffc11ed3438609d4e7a6baa78cb3305bc3.patch",
    "fix_commit_details": {
      "sha": "f33d82ffc11ed3438609d4e7a6baa78cb3305bc3",
      "commit_date": "2024-07-03T13:50:17Z",
      "author": {
        "login": "FreddleSpl0it",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[Web] use correct user to fetch TFA authenticators",
        "length": 50,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "data/web/inc/functions.inc.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1560,7 +1560,7 @@ function unset_tfa_key($_data) {\n }\r\n function get_tfa($username = null, $id = null) {\r\n   global $pdo;\r\n-  if (isset($_SESSION['mailcow_cc_username'])) {\r\n+  if (empty($username) && isset($_SESSION['mailcow_cc_username'])) {\r\n     $username = $_SESSION['mailcow_cc_username'];\r\n   }\r\n   elseif (empty($username)) {\r"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bd9f4ba0a57a159939760ecd319f2d44abf6b27a",
            "date": "2024-11-15T15:21:17Z",
            "author_login": "DerLinkman"
          },
          {
            "sha": "d10d64dd9216ca0d0f70280a3c7a4c12bbc463dc",
            "date": "2024-11-15T15:07:18Z",
            "author_login": "DerLinkman"
          },
          {
            "sha": "6d1f7482edae6927fa1b2b540d5ef11fa8e2bcb2",
            "date": "2024-11-13T09:42:38Z",
            "author_login": "FreddleSpl0it"
          },
          {
            "sha": "b9f52df3f10e43c1fc9364ff0ef5a6008d959a40",
            "date": "2024-11-13T11:04:49Z",
            "author_login": "FreddleSpl0it"
          },
          {
            "sha": "4d688c55007216e50434060398ee91b2755e25d6",
            "date": "2024-11-12T14:57:17Z",
            "author_login": "DerLinkman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:C/C:H/I:L/A:N",
    "cwe_id": "CWE-697",
    "description": "mailcow: dockerized is an open source groupware/email suite based on docker. A vulnerability has been discovered in the two-factor authentication (2FA) mechanism. This flaw allows an authenticated attacker to bypass the 2FA protection, enabling unauthorized access to other accounts that are otherwise secured with 2FA. To exploit this vulnerability, the attacker must first have access to an account within the system and possess the credentials of the target account that has 2FA enabled. By leveraging these credentials, the attacker can circumvent the 2FA process and gain access to the protected account. This issue has been addressed in the `2024-07` release. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-08-05T20:15:36.063",
    "last_modified": "2024-09-20T12:58:23.553",
    "fix_date": "2024-07-03T13:50:17Z"
  },
  "references": [
    {
      "url": "https://github.com/mailcow/mailcow-dockerized/commit/f33d82ffc11ed3438609d4e7a6baa78cb3305bc3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/mailcow/mailcow-dockerized/security/advisories/GHSA-4fcc-q245-qqgg",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.532459",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mailcow-dockerized",
    "owner": "mailcow",
    "created_at": "2016-12-09T19:38:35Z",
    "updated_at": "2025-01-13T23:53:22Z",
    "pushed_at": "2025-01-14T11:18:29Z",
    "size": 48668,
    "stars": 9437,
    "forks": 1223,
    "open_issues": 392,
    "watchers": 9437,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master",
      "staging"
    ],
    "languages": {
      "JavaScript": 1405369,
      "PHP": 1135521,
      "Twig": 591918,
      "CSS": 352712,
      "Shell": 306925,
      "Python": 113018,
      "Lua": 36105,
      "Dockerfile": 18443,
      "Perl": 5763,
      "HTML": 5479,
      "Smarty": 5136,
      "Ruby": 943,
      "C++": 891,
      "BitBake": 708,
      "Sieve": 296
    },
    "commit_activity": {
      "total_commits_last_year": 213,
      "avg_commits_per_week": 4.096153846153846,
      "days_active_last_year": 100
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T13:27:01.167324"
  }
}