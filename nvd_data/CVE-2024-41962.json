{
  "cve_id": "CVE-2024-41962",
  "github_data": {
    "repository": "Yonle/bostr",
    "fix_commit": "49181f4ec9ae1472c6675cab56bbc01e723855af",
    "related_commits": [
      "49181f4ec9ae1472c6675cab56bbc01e723855af"
    ],
    "patch_url": "https://github.com/Yonle/bostr/commit/49181f4ec9ae1472c6675cab56bbc01e723855af.patch",
    "fix_commit_details": {
      "sha": "49181f4ec9ae1472c6675cab56bbc01e723855af",
      "commit_date": "2024-08-01T15:54:23Z",
      "author": {
        "login": "Yonle",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "auth.js: fix auth that let's everyone in",
        "length": 262,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 3,
        "deletions": 1
      },
      "files": [
        {
          "filename": "auth.js",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -18,7 +18,9 @@ module.exports = (authKey, data, ws, req) => {\n     return false;\n   }\n \n-  if (!authorized_keys?.includes(data.pubkey) && !private_keys[data.pubkey] && !noscraper) {\n+  let pubkeyInConfig = authorized_keys?.includes(data.pubkey) || data.pubkey in private_keys;\n+\n+  if (authorized_keys?.length && !pubkeyInConfig) {\n     ws.send(JSON.stringify([\"OK\", data.id, false, \"unauthorized.\"]));\n     return false;\n   }"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2013c36836c7dd7ca64327967f6418b65a787471",
            "date": "2025-01-06T15:37:36Z",
            "author_login": "Yonle"
          },
          {
            "sha": "41bc4c5572ea4aa30d36f53eb6c733fe41b8ce44",
            "date": "2025-01-06T15:36:01Z",
            "author_login": "Yonle"
          },
          {
            "sha": "499e765a28f78a686f2f507a1572f2eed3901c88",
            "date": "2025-01-06T15:27:40Z",
            "author_login": "Yonle"
          },
          {
            "sha": "d3c73eb05ac701b1f9a74b0661579da7fd0bbc95",
            "date": "2024-08-29T09:45:55Z",
            "author_login": "Yonle"
          },
          {
            "sha": "2a0c641133541792d2b8dc2de786d80c48c416c3",
            "date": "2024-08-01T15:59:33Z",
            "author_login": "Yonle"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:L",
    "cwe_id": "CWE-285",
    "description": "Bostr is an nostr relay aggregator proxy that acts like a regular nostr relay. bostr let everyone in even having authorized_keys being set when noscraper is set to true. This vulnerability is fixed in 3.0.10.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-01T17:16:09.507",
    "last_modified": "2024-08-16T16:34:48.873",
    "fix_date": "2024-08-01T15:54:23Z"
  },
  "references": [
    {
      "url": "https://github.com/Yonle/bostr/blob/8665374a66e2afb9f92d0414b0d6f420a95d5d2d/auth.js#L21",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/Yonle/bostr/commit/49181f4ec9ae1472c6675cab56bbc01e723855af",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Yonle/bostr/releases/tag/3.0.10",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/Yonle/bostr/security/advisories/GHSA-5cf7-cxrf-mq73",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.519794",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "bostr",
    "owner": "Yonle",
    "created_at": "2023-10-29T20:15:19Z",
    "updated_at": "2025-01-13T16:25:58Z",
    "pushed_at": "2025-01-06T15:45:40Z",
    "size": 377,
    "stars": 96,
    "forks": 14,
    "open_issues": 0,
    "watchers": 96,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 38991,
      "Dockerfile": 1057
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:33:12.924829"
  }
}