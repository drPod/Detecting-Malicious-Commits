{
  "cve_id": "CVE-2024-42055",
  "github_data": {
    "repository": "CervantesSec/cervantes",
    "fix_commit": "78631a034d0fb3323a53fb7428b2022b29a0d2cd",
    "related_commits": [
      "78631a034d0fb3323a53fb7428b2022b29a0d2cd",
      "78631a034d0fb3323a53fb7428b2022b29a0d2cd"
    ],
    "patch_url": "https://github.com/CervantesSec/cervantes/commit/78631a034d0fb3323a53fb7428b2022b29a0d2cd.patch",
    "fix_commit_details": {
      "sha": "78631a034d0fb3323a53fb7428b2022b29a0d2cd",
      "commit_date": "2024-02-03T11:31:25Z",
      "author": {
        "login": "mesquidar",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "minor fixes and import sanitization",
        "length": 35,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 364,
        "additions": 214,
        "deletions": 150
      },
      "files": [
        {
          "filename": "Cervantes.CORE/ViewModel/UserEditViewModel.cs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -40,6 +40,6 @@ public class UserEditViewModel\n     public Guid? ClientId { get; set; }\n     public string ImagePath { get; set; }\n     \n-    public bool LockoutEnabled { get; set; }\n+    public bool Lockout { get; set; }\n     public bool TwoFactorEnabled { get; set; }\n }\n\\ No newline at end of file"
        },
        {
          "filename": "Cervantes.DAL/Cervantes.DAL.csproj",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -13,6 +13,7 @@\n     </ItemGroup>\n \n     <ItemGroup>\n+      <PackageReference Include=\"HtmlSanitizer\" Version=\"8.0.811\" />\n       <PackageReference Include=\"Microsoft.AspNetCore.Identity.EntityFrameworkCore\" Version=\"8.0.1\" />\n       <PackageReference Include=\"Microsoft.EntityFrameworkCore\" Version=\"8.0.1\" />\n       <PackageReference Include=\"Microsoft.EntityFrameworkCore.Abstractions\" Version=\"8.0.1\" />"
        },
        {
          "filename": "Cervantes.DAL/DataInitializer.cs",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -3,9 +3,11 @@\n using Microsoft.AspNetCore.Identity;\n using System.Linq;\n using System.Security.Cryptography;\n+using System.Web;\n using System.Xml;\n using Cervantes.Contracts;\n using Cervantes.CORE.Entities;\n+using Ganss.Xss;\n using Microsoft.Extensions.Logging;\n using Task = System.Threading.Tasks.Task;\n \n@@ -35,7 +37,9 @@ public static void SeedCwe(ICweManager cweManager, string cweFile)\n             xmlDocument.Load(cweFile);\n \n             XmlNodeList weaknessNodes = xmlDocument.GetElementsByTagName(\"Weakness\");\n-\n+            var sanitizer = new HtmlSanitizer();\n+            sanitizer.AllowedSchemes.Add(\"data\");\n+            \n             foreach (XmlNode weaknessNode in weaknessNodes)\n             {\n                 string id = weaknessNode.Attributes[\"ID\"].Value;\n@@ -47,8 +51,8 @@ public static void SeedCwe(ICweManager cweManager, string cweFile)\n \n                 Cwe cwe = new Cwe();\n                 cwe.Id = Convert.ToInt32(id);\n-                cwe.Name = name;\n-                cwe.Description = desc;\n+                cwe.Name = sanitizer.Sanitize(HttpUtility.HtmlDecode(name));\n+                cwe.Description = sanitizer.Sanitize(HttpUtility.HtmlDecode(desc));\n                 \n                 cweManager.Add(cwe);\n                 cweManager.Context.SaveChanges();"
        },
        {
          "filename": "Cervantes.IFR/Cervantes.IFR.csproj",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -19,6 +19,7 @@\n       <PackageReference Include=\"CsvHelper\" Version=\"30.1.0\" />\n       <PackageReference Include=\"Html2JiraMarkup\" Version=\"1.0.4\" />\n       <PackageReference Include=\"HtmlAgilityPack\" Version=\"1.11.58\" />\n+      <PackageReference Include=\"HtmlSanitizer\" Version=\"8.0.811\" />\n       <PackageReference Include=\"MailKit\" Version=\"4.3.0\" />\n       <PackageReference Include=\"Microsoft.AspNetCore.Hosting\" Version=\"2.2.7\" />\n       <PackageReference Include=\"Microsoft.AspNetCore.Hosting.Abstractions\" Version=\"2.2.0\" />"
        },
        {
          "filename": "Cervantes.IFR/Parsers/CSV/CsvParser.cs",
          "status": "modified",
          "additions": 26,
          "deletions": 21,
          "patch": "@@ -3,11 +3,13 @@\n using System.IO;\n using System.Linq;\n using System.Security.Claims;\n+using System.Web;\n using Cervantes.Contracts;\n using Cervantes.CORE;\n using Cervantes.CORE.Entities;\n using CsvHelper;\n using CsvHelper.Configuration;\n+using Ganss.Xss;\n \n namespace Cervantes.IFR.Parsers.CSV;\n \n@@ -31,6 +33,9 @@ public void Parse(Guid? project, string user, string path)\n         {\n             Delimiter = \";\"\n         };\n+        var sanitizer = new HtmlSanitizer();\n+        sanitizer.AllowedSchemes.Add(\"data\");\n+        \n         using (var reader = new StreamReader(path))\n         using (var csv = new CsvReader(reader, config))\n         {\n@@ -44,28 +49,28 @@ public void Parse(Guid? project, string user, string path)\n                 foreach (var vul in records)\n                 {\n                     Vuln vuln = new Vuln();\n-                    vuln.Name = vul.Name == \"\" ? \"No Name\" : vul.Name;\n+                    vuln.Name = vul.Name == \"\" ? \"No Name\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Name));\n                     \n                     vuln.Template = vul.Template.HasValue && vul.Template.Value;\n-                    vuln.cve = vul.CVE == \"\" ? \"None\" : vul.CVE;\n-                    vuln.Description = vul.Description == \"\" ? \"No Data\" : vul.Description;\n-                    vuln.Impact = vul.Impact == \"\" ? \"No Data\" : vul.Impact;\n+                    vuln.cve = vul.CVE == \"\" ? \"None\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.CVE));\n+                    vuln.Description = vul.Description == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Description));\n+                    vuln.Impact = vul.Impact == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Impact));\n                     vuln.Risk = vul.Risk ?? VulnRisk.Info;\n                     vuln.Status = vul.Status ?? VulnStatus.Open;\n                     vuln.CreatedDate = DateTime.Now.ToUniversalTime();\n                     vuln.JiraCreated = false;\n-                    vuln.Remediation = vul.Remediation == \"\" ? \"No Data\" : vul.Remediation;\n+                    vuln.Remediation = vul.Remediation == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Remediation));\n                     vuln.RemediationPriority = vul.RemediationPriority ?? RemediationPriority.Low;\n                     vuln.RemediationComplexity = vul.RemediationComplexity ?? RemediationComplexity.Low;\n-                    vuln.OWASPRisk = vul.OwaspRisk == \"\" ? \"No Data\" : vul.OwaspRisk;\n-                    vuln.OWASPImpact = vul.OwaspImpact == \"\" ? \"No Data\" : vul.OwaspImpact;\n-                    vuln.OWASPLikehood = vul.OwaspLikehood == \"\" ? \"No Data\" : vul.OwaspLikehood;\n-                    vuln.OWASPVector = vul.OwaspVector == \"\" ? \"No Data\" : vul.OwaspVector;\n+                    vuln.OWASPRisk = vul.OwaspRisk == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspRisk));\n+                    vuln.OWASPImpact = vul.OwaspImpact == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspImpact));\n+                    vuln.OWASPLikehood = vul.OwaspLikehood == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspLikehood));\n+                    vuln.OWASPVector = vul.OwaspVector == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspVector));\n                     vuln.ProjectId = project;\n-                    vuln.ProofOfConcept = vul.Poc == \"\" ? \"No Data\" : vul.Poc;\n+                    vuln.ProofOfConcept = vul.Poc == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Poc));\n                     vuln.UserId = user;\n                     vuln.CVSS3 = vul.CVSS3 ?? 0;\n-                    vuln.CVSSVector = vul.CVSSVector == \"\" ? \"No Data\" : vul.CVSSVector;\n+                    vuln.CVSSVector = vul.CVSSVector == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.CVSSVector));\n                     var cat = vulnCategoryManager.GetByName(vul.VulnCategory);\n                     if (cat != null)\n                     {\n@@ -86,28 +91,28 @@ public void Parse(Guid? project, string user, string path)\n                 foreach (var vul in records)\n                 {\n                     Vuln vuln = new Vuln();\n-                    vuln.Name = vul.Name == \"\" ? \"No Name\" : vul.Name;\n+                    vuln.Name = vul.Name == \"\" ? \"No Name\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Name));\n                     \n                     vuln.Template = vul.Template.HasValue && vul.Template.Value;\n-                    vuln.cve = vul.CVE == \"\" ? \"None\" : vul.CVE;\n-                    vuln.Description = vul.Description == \"\" ? \"No Data\" : vul.Description;\n-                    vuln.Impact = vul.Impact == \"\" ? \"No Data\" : vul.Impact;\n+                    vuln.cve = vul.CVE == \"\" ? \"None\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.CVE));\n+                    vuln.Description = vul.Description == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Description));\n+                    vuln.Impact = vul.Impact == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Impact));\n                     vuln.Risk = vul.Risk ?? VulnRisk.Info;\n                     vuln.Status = vul.Status ?? VulnStatus.Open;\n                     vuln.CreatedDate = DateTime.Now.ToUniversalTime();\n                     vuln.JiraCreated = false;\n-                    vuln.Remediation = vul.Remediation == \"\" ? \"No Data\" : vul.Remediation;\n+                    vuln.Remediation = vul.Remediation == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Remediation));\n                     vuln.RemediationPriority = vul.RemediationPriority ?? RemediationPriority.Low;\n                     vuln.RemediationComplexity = vul.RemediationComplexity ?? RemediationComplexity.Low;\n-                    vuln.OWASPRisk = vul.OwaspRisk == \"\" ? \"No Data\" : vul.OwaspRisk;\n-                    vuln.OWASPImpact = vul.OwaspImpact == \"\" ? \"No Data\" : vul.OwaspImpact;\n-                    vuln.OWASPLikehood = vul.OwaspLikehood == \"\" ? \"No Data\" : vul.OwaspLikehood;\n-                    vuln.OWASPVector = vul.OwaspVector == \"\" ? \"No Data\" : vul.OwaspVector;\n+                    vuln.OWASPRisk = vul.OwaspRisk == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspRisk));\n+                    vuln.OWASPImpact = vul.OwaspImpact == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspImpact));\n+                    vuln.OWASPLikehood = vul.OwaspLikehood == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspLikehood));\n+                    vuln.OWASPVector = vul.OwaspVector == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.OwaspVector));\n                     vuln.ProjectId = null;\n                     vuln.ProofOfConcept = vul.Poc == \"\" ? \"No Data\" : vul.Poc;\n                     vuln.UserId = user;\n                     vuln.CVSS3 = vul.CVSS3 ?? 0;\n-                    vuln.CVSSVector = vul.CVSSVector == \"\" ? \"No Data\" : vul.CVSSVector;\n+                    vuln.CVSSVector = vul.CVSSVector == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.CVSSVector));\n                     var cat = vulnCategoryManager.GetByName(vul.VulnCategory);\n                     if (cat != null)\n                     {"
        },
        {
          "filename": "Cervantes.IFR/Parsers/Nessus/NessusParser.cs",
          "status": "modified",
          "additions": 20,
          "deletions": 17,
          "patch": "@@ -1,10 +1,12 @@\n using System;\n using System.Globalization;\n using System.Linq;\n+using System.Web;\n using System.Xml;\n using Cervantes.Contracts;\n using Cervantes.CORE;\n using Cervantes.CORE.Entities;\n+using Ganss.Xss;\n \n namespace Cervantes.IFR.Parsers.Nessus;\n \n@@ -28,7 +30,8 @@ public void Parse(Guid? project, string user, string path)\n         doc.Load(path);\n \n         XmlNodeList hosts = doc.GetElementsByTagName(\"ReportHost\");\n-\n+        var sanitizer = new HtmlSanitizer();\n+        sanitizer.AllowedSchemes.Add(\"data\");\n         if (project != null)\n         {\n             var pro = projectManager.GetById((Guid) project);\n@@ -56,8 +59,8 @@ public void Parse(Guid? project, string user, string path)\n                     {\n                         UserId = user,\n                         ProjectId = project,\n-                        Name = hostName,\n-                        Description = \"<p>Host created from Nessus Scan Import</p>\" + \"<p>OS: \"+ os +\"</p>\"+ \"<p>Host Ip: \"+ hostIp +\"</p>\",\n+                        Name = sanitizer.Sanitize(HttpUtility.HtmlDecode(hostName)),\n+                        Description = \"<p>Host created from Nessus Scan Import</p>\" + \"<p>OS: \"+ sanitizer.Sanitize(HttpUtility.HtmlDecode(os)) +\"</p>\"+ \"<p>Host Ip: \"+ sanitizer.Sanitize(HttpUtility.HtmlDecode(hostIp)) +\"</p>\",\n                         Type = TargetType.Hostname\n                     };\n \n@@ -96,7 +99,7 @@ public void Parse(Guid? project, string user, string path)\n                     var vulNum = vulnManager.GetAll().Count(x => x.ProjectId == project && x.Template == false) + 1;\n                     vuln.FindingId = pro.FindingsId + \"-\" + vulNum.ToString(\"D2\");\n                     vuln.Template = false;\n-                    vuln.Name = pluginName;\n+                    vuln.Name = sanitizer.Sanitize(HttpUtility.HtmlDecode(pluginName));\n                     vuln.CreatedDate = DateTime.Now.ToUniversalTime();\n                     vuln.UserId = user;\n                     vuln.ProjectId = project;\n@@ -120,10 +123,10 @@ public void Parse(Guid? project, string user, string path)\n                             break;\n                     }\n                     vuln.Status = VulnStatus.Open;\n-                    vuln.cve = cve;\n-                    vuln.Description = \"<p>\"+description+\"</p>\"+ \"<p>References: \" +\"<p>\"+refrences+\"</p>\";\n-                    vuln.ProofOfConcept = pluginOutput;\n-                    vuln.Impact = impact;\n+                    vuln.cve = sanitizer.Sanitize(HttpUtility.HtmlDecode(cve));\n+                    vuln.Description = \"<p>\"+sanitizer.Sanitize(HttpUtility.HtmlDecode(description))+\"</p>\"+ \"<p>References: \" +\"<p>\"+sanitizer.Sanitize(HttpUtility.HtmlDecode(refrences))+\"</p>\";\n+                    vuln.ProofOfConcept = sanitizer.Sanitize(HttpUtility.HtmlDecode(pluginOutput));\n+                    vuln.Impact = sanitizer.Sanitize(HttpUtility.HtmlDecode(impact));\n                     if (cvss != \"\")\n                     {\n                         vuln.CVSS3 = float.Parse(cvss,CultureInfo.InvariantCulture);\n@@ -133,8 +136,8 @@ public void Parse(Guid? project, string user, string path)\n                         vuln.CVSS3 = 0;\n                     }\n                     \n-                    vuln.CVSSVector = cvssVector;\n-                    vuln.Remediation = solution;\n+                    vuln.CVSSVector = sanitizer.Sanitize(HttpUtility.HtmlDecode(cvssVector));\n+                    vuln.Remediation = sanitizer.Sanitize(HttpUtility.HtmlDecode(solution));\n                     vuln.RemediationComplexity = RemediationComplexity.Low;\n                     vuln.RemediationPriority = RemediationPriority.Low;\n                     vuln.JiraCreated = false;\n@@ -205,7 +208,7 @@ public void Parse(Guid? project, string user, string path)\n                     \n                     var vuln = new Vuln();\n                     vuln.Template = false;\n-                    vuln.Name = pluginName;\n+                    vuln.Name = sanitizer.Sanitize(HttpUtility.HtmlDecode(pluginName));\n                     vuln.CreatedDate = DateTime.Now.ToUniversalTime();\n                     vuln.UserId = user;\n                     vuln.ProjectId = null;\n@@ -229,10 +232,10 @@ public void Parse(Guid? project, string user, string path)\n                             break;\n                     }\n                     vuln.Status = VulnStatus.Open;\n-                    vuln.cve = cve;\n-                    vuln.Description = \"<p>\"+description+\"</p>\"+ \"<p>References: \" +\"<p>\"+refrences+\"</p>\";\n-                    vuln.ProofOfConcept = pluginOutput;\n-                    vuln.Impact = impact;\n+                    vuln.cve = sanitizer.Sanitize(HttpUtility.HtmlDecode(cve));\n+                    vuln.Description = \"<p>\"+sanitizer.Sanitize(HttpUtility.HtmlDecode(description))+\"</p>\"+ \"<p>References: \" +\"<p>\"+sanitizer.Sanitize(HttpUtility.HtmlDecode(refrences))+\"</p>\";\n+                    vuln.ProofOfConcept = sanitizer.Sanitize(HttpUtility.HtmlDecode(pluginOutput));\n+                    vuln.Impact = sanitizer.Sanitize(HttpUtility.HtmlDecode(impact));\n                     if (cvss != \"\")\n                     {\n                         vuln.CVSS3 = float.Parse(cvss,CultureInfo.InvariantCulture);\n@@ -242,8 +245,8 @@ public void Parse(Guid? project, string user, string path)\n                         vuln.CVSS3 = 0;\n                     }\n                     \n-                    vuln.CVSSVector = cvssVector;\n-                    vuln.Remediation = solution;\n+                    vuln.CVSSVector = sanitizer.Sanitize(HttpUtility.HtmlDecode(cvssVector));\n+                    vuln.Remediation = sanitizer.Sanitize(HttpUtility.HtmlDecode(solution));\n                     vuln.RemediationComplexity = RemediationComplexity.Low;\n                     vuln.RemediationPriority = RemediationPriority.Low;\n                     vuln.JiraCreated = false;"
        },
        {
          "filename": "Cervantes.IFR/Parsers/Nmap/NmapParser.cs",
          "status": "modified",
          "additions": 9,
          "deletions": 5,
          "patch": "@@ -2,11 +2,13 @@\n using System.IO;\n using System.Linq;\n using System.Text;\n+using System.Web;\n using System.Xml;\n using System.Xml.Linq;\n using Cervantes.Contracts;\n using Cervantes.CORE;\n using Cervantes.CORE.Entities;\n+using Ganss.Xss;\n \n \n namespace Cervantes.IFR.Parsers.Nmap;\n@@ -34,7 +36,9 @@ public void Parse(Guid project, string user, string path)\n         XElement nmap = XElement.Load(file);\n \n         var hosts = nmap.Descendants(\"host\");\n-\n+        var sanitizer = new HtmlSanitizer();\n+        sanitizer.AllowedSchemes.Add(\"data\");\n+        \n         foreach (var host in hosts)\n         {\n             var status = host.Element(\"status\");\n@@ -47,7 +51,7 @@ public void Parse(Guid project, string user, string path)\n             \n             Target target = new Target\n             {\n-                Name = address.Attribute(\"addr\").Value,\n+                Name = sanitizer.Sanitize(HttpUtility.HtmlDecode(address.Attribute(\"addr\").Value)),\n                 Description = \"Imported from Nmap\",\n                 Type = TargetType.IP,\n                 ProjectId = project,\n@@ -131,10 +135,10 @@ public void Parse(Guid project, string user, string path)\n                 {\n                     UserId = user,\n                     TargetId = target.Id,\n-                    Name = product + \" (\" + name +\")\",\n-                    Description = info + Environment.NewLine + sb.ToString(),\n+                    Name = sanitizer.Sanitize(HttpUtility.HtmlDecode(product)) + \" (\" + sanitizer.Sanitize(HttpUtility.HtmlDecode(name)) +\")\",\n+                    Description = sanitizer.Sanitize(HttpUtility.HtmlDecode(info)) + Environment.NewLine + sanitizer.Sanitize(HttpUtility.HtmlDecode(sb.ToString())),\n                     Port = Int32.Parse(number),\n-                    Version = version,\n+                    Version =sanitizer.Sanitize(HttpUtility.HtmlDecode(version)),\n                     Note = \"Imported from Nmap\"\n                     \n                     "
        },
        {
          "filename": "Cervantes.IFR/Parsers/Pwndoc/PwndocParser.cs",
          "status": "modified",
          "additions": 13,
          "deletions": 9,
          "patch": "@@ -2,9 +2,11 @@\n using System.Collections.Generic;\n using System.IO;\n using System.Linq;\n+using System.Web;\n using Cervantes.Contracts;\n using Cervantes.CORE;\n using Cervantes.CORE.Entities;\n+using Ganss.Xss;\n using YamlDotNet.RepresentationModel;\n using YamlDotNet.Serialization;\n using YamlDotNet.Serialization.NamingConventions;\n@@ -31,17 +33,19 @@ public void Parse(Guid? project, string user, string path)\n \n             //yml contains a string containing your YAML\n            var vulns = deserializer.Deserialize<List<PwndocVuln>>(reader);\n-\n+           var sanitizer = new HtmlSanitizer();\n+           sanitizer.AllowedSchemes.Add(\"data\");\n+           \n             if (project != null)\n             {\n                 var pro = projectManager.GetById((Guid) project);\n                 foreach (var vul in vulns)\n                 {\n                     int i = 0;\n                     Vuln vuln = new Vuln();\n-                    vuln.Name = vul.Details[i].Title == \"\" ? \"No Name\" : vul.Details[i].Title;\n-                    vuln.Description = vul.Details[i].Description  == \"\" ? \"No Data\" : vul.Details[i].Description;\n-                    vuln.Impact = vul.Details[i].Observation == \"\" ? \"No Data\" : vul.Details[i].Observation;\n+                    vuln.Name = vul.Details[i].Title == \"\" ? \"No Name\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Title)); \n+                    vuln.Description = vul.Details[i].Description  == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Description));\n+                    vuln.Impact = vul.Details[i].Observation == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Observation));\n                     switch (vul.Priority)\n                     {\n                         case 1:\n@@ -61,7 +65,7 @@ public void Parse(Guid? project, string user, string path)\n                     vuln.Status = VulnStatus.Open;\n                     vuln.CreatedDate = DateTime.Now.ToUniversalTime();\n                     vuln.JiraCreated = false;\n-                    vuln.Remediation = vul.Details[i].Remediation == \"\" ? \"No Data\" : vul.Details[i].Remediation;\n+                    vuln.Remediation = vul.Details[i].Remediation == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Remediation));\n                     switch (vul.Priority)\n                     {\n                         case 1:\n@@ -112,9 +116,9 @@ public void Parse(Guid? project, string user, string path)\n                 {\n                     int i = 0;\n                     Vuln vuln = new Vuln();\n-                    vuln.Name = vul.Details[i].Title == \"\" ? \"No Name\" : vul.Details[i].Title;\n-                    vuln.Description = vul.Details[i].Description  == \"\" ? \"No Data\" : vul.Details[i].Description;\n-                    vuln.Impact = vul.Details[i].Observation == \"\" ? \"No Data\" : vul.Details[i].Observation;\n+                    vuln.Name = vul.Details[i].Title == \"\" ? \"No Name\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Title)); \n+                    vuln.Description = vul.Details[i].Description  == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Description));\n+                    vuln.Impact = vul.Details[i].Observation == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Observation));\n                     switch (vul.Priority)\n                     {\n                         case 1:\n@@ -134,7 +138,7 @@ public void Parse(Guid? project, string user, string path)\n                     vuln.Status = VulnStatus.Open;\n                     vuln.CreatedDate = DateTime.Now.ToUniversalTime();\n                     vuln.JiraCreated = false;\n-                    vuln.Remediation = vul.Details[i].Remediation == \"\" ? \"No Data\" : vul.Details[i].Remediation;\n+                    vuln.Remediation = vul.Details[i].Remediation == \"\" ? \"No Data\" : sanitizer.Sanitize(HttpUtility.HtmlDecode(vul.Details[i].Remediation));\n                     switch (vul.Priority)\n                     {\n                         case 1:"
        },
        {
          "filename": "Cervantes.Web/Components/Pages/Admin/Users/UserDialog.razor",
          "status": "modified",
          "additions": 79,
          "deletions": 77,
          "patch": "@@ -46,83 +46,85 @@\n \t\t\t\t        <MudForm Model=\"@model\" @ref=\"@form\" Validation=\"@(userModelFluentValidator.ValidateValue)\" ValidationDelay=\"0\">\n \n \t\t\t\t\t        <MudStack AlignItems=\"AlignItems.Stretch\">\n-\t\t\t\t\t\t\t<MudTextField Placeholder=\"John Doe\"  @bind-Value=\"model.FullName\"\n-                            \t\t\t\t              For=\"@(() => model.FullName)\"\n-                            \t\t\t\t              Immediate=\"true\"\n-                            \t\t\t\t              Label=\"@localizer[\"name\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Person\"/>\n-                            \n-                            \n-                            \t\t\t\t<MudTextField Placeholder=\"john.doe@foobar.com\" @bind-Value=\"model.Email\"\n-                            \t\t\t\t              For=\"@(() => model.Email)\"\n-                            \t\t\t\t              Immediate=\"true\"\n-                            \t\t\t\t              Label=\"Email\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Email\" InputType=\"InputType.Email\"/>\n-                            \t\t\t\t\n-                            \t\t\t\t<MudTextField Placeholder=\"+00 000 00 00 00\" @bind-Value=\"model.PhoneNumber\"\n-                            \t\t\t\t              For=\"@(() => model.PhoneNumber)\"\n-                            \t\t\t\t              Immediate=\"true\"\n-                            \t\t\t\t              Label=\"@localizer[\"phone\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Phone\" InputType=\"InputType.Telephone\"/>\n-                            \t\t\t\t\n-                            \t\t\t\t<TinyMCE.Blazor.Editor ScriptSrc=\"lib/tinymce/tinymce.min.js\" Conf=\"@editorConf\" @bind-Value=\"model.Description\" data-mce-placeholder=\"Description\"/>\n-                            \n-\t\t\t\t                            <MudTextField @bind-Value=\"model.Password\"\n-\t\t\t\t                                          For=\"@(() => model.Password)\"\n-\t\t\t\t                                          Immediate=\"true\"\n-\t\t\t\t                                          Label=\"@localizer[\"changePassword\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Password\" InputType=\"InputType.Password\"/>\n-\t\t\t\t                            <MudTextField @bind-Value=\"model.ConfirmPassword\"\n-\t\t\t\t                                          For=\"@(() => model.ConfirmPassword)\"\n-\t\t\t\t                                          Immediate=\"true\"\n-\t\t\t\t                                          Label=\"@localizer[\"confirmPassword\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Password\" InputType=\"InputType.Password\"/>\n-\t\t\t\t                            \n-                            \n-                            \t\t\t\t<MudTextField Placeholder=\"Pentester...\"  @bind-Value=\"model.Position\"\n-                            \t\t\t\t              For=\"@(() => model.Position)\"\n-                            \t\t\t\t              Immediate=\"true\"\n-                            \t\t\t\t              Label=\"@localizer[\"position\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.PermIdentity\"/>\n-                            \n-                            \t\t\t\t<MudSelect Placeholder=\"@localizer[\"role\"]\" @bind-Value=\"model.Role\" For=\"@(() => model.Role)\" Label=\"@localizer[\"role\"]\" AdornmentIcon=\"@Icons.Material.Filled.PersonSearch\" Adornment=\"Adornment.Start\" TransformOrigin=\"Origin.BottomCenter\" AnchorOrigin=\"Origin.BottomCenter\" PopoverClass=\"fixed\">\n-                            \t\t\t\t\t<MudSelectItem Value=\"Guid.Empty.ToString()\" Disabled=\"true\">@localizer[\"selectRole\"]</MudSelectItem>\n-                            \t\t\t\t\t@foreach (var role in Roles)\n-                            \t\t\t\t\t{\n-                            \t\t\t\t\t\t<MudSelectItem Value=\"@role.Name\">@role.Name</MudSelectItem>\n-                            \t\t\t\t\t}\n-                            \t\t\t\t</MudSelect>\n-                            \t\t\t\t\n-                            \t\t\t\t@if (model.Role == \"Client\")\n-                            \t\t\t\t{\n-                            \t\t\t\t\t<MudSelect Placeholder=\"@localizer[\"client\"]\" @bind-Value=\"model.ClientId\" For=\"@(() => model.ClientId)\" Label=\"Client\" AdornmentIcon=\"@Icons.Material.Filled.Contacts\" Adornment=\"Adornment.Start\" TransformOrigin=\"Origin.BottomCenter\" AnchorOrigin=\"Origin.BottomCenter\" PopoverClass=\"fixed\">\n-                            \t\t\t\t\t\t<MudSelectItem Value=\"Guid.Empty.ToString()\" Disabled=\"true\">@localizer[\"selectClient\"]</MudSelectItem>\n-                            \t\t\t\t\t\t@foreach (var cli in Clients)\n-                            \t\t\t\t\t\t{\n-                            \t\t\t\t\t\t\t<MudSelectItem Value=\"@cli.Id\">@cli.Name</MudSelectItem>\n-                            \t\t\t\t\t\t}\n-                            \t\t\t\t\t</MudSelect>\n-                            \t\t\t\t\t\n-                            \t\t\t\t}\n-                            \n-                            \t\t\t\t<MudFileUpload T=\"IBrowserFile\" @bind-Files=\"File\" Accept=\".jpg,.png,.gif,.jpeg,.tiff,.bmp\">\n-                            \t\t\t\t\t<ButtonTemplate>\n-                            \t\t\t\t\t\t<MudButton HtmlTag=\"label\"\n-                            \t\t\t\t\t\t           Variant=\"Variant.Filled\"\n-                            \t\t\t\t\t\t           Color=\"Color.Primary\"\n-                            \t\t\t\t\t\t           StartIcon=\"@Icons.Material.Filled.CloudUpload\"\n-                            \t\t\t\t\t\t           for=\"@context\">\n-                            \t\t\t\t\t\t\t@localizer[\"uploadFile\"]\n-                            \t\t\t\t\t\t</MudButton>\n-                            \t\t\t\t\t</ButtonTemplate>\n-                            \t\t\t\t\t<SelectedTemplate>\n-                            \n-                            \t\t\t\t\t\t@if (File != null)\n-                            \t\t\t\t\t\t{\n-                            \t\t\t\t\t\t\t<MudText> <MudIcon Icon=\"@Icons.Material.Filled.Attachment\" /> @File.Name </MudText>\n-                                                            \n-                            \t\t\t\t\t\t}\n-                            \t\t\t\t\t\telse\n-                            \t\t\t\t\t\t{\n-                            \t\t\t\t\t\t\t<MudText><MudIcon Icon=\"@Icons.Material.Filled.Attachment\" /> @localizer[\"noFiles\"]</MudText>\n-                            \t\t\t\t\t\t}\n-                            \t\t\t\t\t</SelectedTemplate>\n-                            \t\t\t\t</MudFileUpload>\n-\t\t\t\t\t\t        \n+\t\t\t\t\t\t        <MudSwitch @bind-Value=\"@model.Lockout\" Label=\"@localizer[\"locked\"]\" Color=\"Color.Primary\"  />\n+\t\t\t\t\t\t        <MudSwitch @bind-Value=\"@model.TwoFactorEnabled\" Label=\"@localizer[\"twoFactor\"]\" Color=\"Color.Primary\" />\n+\t\t\t\t\t\t        <MudTextField Placeholder=\"John Doe\" @bind-Value=\"model.FullName\"\n+\t\t\t\t\t\t                      For=\"@(() => model.FullName)\"\n+\t\t\t\t\t\t                      Immediate=\"true\"\n+\t\t\t\t\t\t                      Label=\"@localizer[\"name\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Person\"/>\n+\n+\n+\t\t\t\t\t\t        <MudTextField Placeholder=\"john.doe@foobar.com\" @bind-Value=\"model.Email\"\n+\t\t\t\t\t\t                      For=\"@(() => model.Email)\"\n+\t\t\t\t\t\t                      Immediate=\"true\"\n+\t\t\t\t\t\t                      Label=\"Email\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Email\" InputType=\"InputType.Email\"/>\n+\n+\t\t\t\t\t\t        <MudTextField Placeholder=\"+00 000 00 00 00\" @bind-Value=\"model.PhoneNumber\"\n+\t\t\t\t\t\t                      For=\"@(() => model.PhoneNumber)\"\n+\t\t\t\t\t\t                      Immediate=\"true\"\n+\t\t\t\t\t\t                      Label=\"@localizer[\"phone\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Phone\" InputType=\"InputType.Telephone\"/>\n+\n+\t\t\t\t\t\t        <TinyMCE.Blazor.Editor ScriptSrc=\"lib/tinymce/tinymce.min.js\" Conf=\"@editorConf\" @bind-Value=\"model.Description\" data-mce-placeholder=\"Description\"/>\n+\n+\t\t\t\t\t\t        <MudTextField @bind-Value=\"model.Password\"\n+\t\t\t\t\t\t                      For=\"@(() => model.Password)\"\n+\t\t\t\t\t\t                      Immediate=\"true\"\n+\t\t\t\t\t\t                      Label=\"@localizer[\"changePassword\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Password\" InputType=\"InputType.Password\"/>\n+\t\t\t\t\t\t        <MudTextField @bind-Value=\"model.ConfirmPassword\"\n+\t\t\t\t\t\t                      For=\"@(() => model.ConfirmPassword)\"\n+\t\t\t\t\t\t                      Immediate=\"true\"\n+\t\t\t\t\t\t                      Label=\"@localizer[\"confirmPassword\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.Password\" InputType=\"InputType.Password\"/>\n+\n+\n+\t\t\t\t\t\t        <MudTextField Placeholder=\"Pentester...\" @bind-Value=\"model.Position\"\n+\t\t\t\t\t\t                      For=\"@(() => model.Position)\"\n+\t\t\t\t\t\t                      Immediate=\"true\"\n+\t\t\t\t\t\t                      Label=\"@localizer[\"position\"]\" Adornment=\"Adornment.Start\" AdornmentIcon=\"@Icons.Material.Filled.PermIdentity\"/>\n+\n+\t\t\t\t\t\t        <MudSelect Placeholder=\"@localizer[\"role\"]\" @bind-Value=\"model.Role\" For=\"@(() => model.Role)\" Label=\"@localizer[\"role\"]\" AdornmentIcon=\"@Icons.Material.Filled.PersonSearch\" Adornment=\"Adornment.Start\" TransformOrigin=\"Origin.BottomCenter\" AnchorOrigin=\"Origin.BottomCenter\" PopoverClass=\"fixed\">\n+\t\t\t\t\t\t\t        <MudSelectItem Value=\"Guid.Empty.ToString()\" Disabled=\"true\">@localizer[\"selectRole\"]</MudSelectItem>\n+\t\t\t\t\t\t\t        @foreach (var role in Roles)\n+\t\t\t\t\t\t\t        {\n+\t\t\t\t\t\t\t\t        <MudSelectItem Value=\"@role.Name\">@role.Name</MudSelectItem>\n+\t\t\t\t\t\t\t        }\n+\t\t\t\t\t\t        </MudSelect>\n+\n+\t\t\t\t\t\t        @if (model.Role == \"Client\")\n+\t\t\t\t\t\t        {\n+\t\t\t\t\t\t\t        <MudSelect Placeholder=\"@localizer[\"client\"]\" @bind-Value=\"model.ClientId\" For=\"@(() => model.ClientId)\" Label=\"Client\" AdornmentIcon=\"@Icons.Material.Filled.Contacts\" Adornment=\"Adornment.Start\" TransformOrigin=\"Origin.BottomCenter\" AnchorOrigin=\"Origin.BottomCenter\" PopoverClass=\"fixed\">\n+\t\t\t\t\t\t\t\t        <MudSelectItem Value=\"Guid.Empty.ToString()\" Disabled=\"true\">@localizer[\"selectClient\"]</MudSelectItem>\n+\t\t\t\t\t\t\t\t        @foreach (var cli in Clients)\n+\t\t\t\t\t\t\t\t        {\n+\t\t\t\t\t\t\t\t\t        <MudSelectItem Value=\"@cli.Id\">@cli.Name</MudSelectItem>\n+\t\t\t\t\t\t\t\t        }\n+\t\t\t\t\t\t\t        </MudSelect>\n+\n+\t\t\t\t\t\t        }\n+\n+\t\t\t\t\t\t        <MudFileUpload T=\"IBrowserFile\" @bind-Files=\"File\" Accept=\".jpg,.png,.gif,.jpeg,.tiff,.bmp\">\n+\t\t\t\t\t\t\t        <ButtonTemplate>\n+\t\t\t\t\t\t\t\t        <MudButton HtmlTag=\"label\"\n+\t\t\t\t\t\t\t\t                   Variant=\"Variant.Filled\"\n+\t\t\t\t\t\t\t\t                   Color=\"Color.Primary\"\n+\t\t\t\t\t\t\t\t                   StartIcon=\"@Icons.Material.Filled.CloudUpload\"\n+\t\t\t\t\t\t\t\t                   for=\"@context\">\n+\t\t\t\t\t\t\t\t\t        @localizer[\"uploadFile\"]\n+\t\t\t\t\t\t\t\t        </MudButton>\n+\t\t\t\t\t\t\t        </ButtonTemplate>\n+\t\t\t\t\t\t\t        <SelectedTemplate>\n+\n+\t\t\t\t\t\t\t\t        @if (File != null)\n+\t\t\t\t\t\t\t\t        {\n+\t\t\t\t\t\t\t\t\t        <MudText> <MudIcon Icon=\"@Icons.Material.Filled.Attachment\"/> @File.Name </MudText>\n+\n+\t\t\t\t\t\t\t\t        }\n+\t\t\t\t\t\t\t\t        else\n+\t\t\t\t\t\t\t\t        {\n+\t\t\t\t\t\t\t\t\t        <MudText><MudIcon Icon=\"@Icons.Material.Filled.Attachment\"/> @localizer[\"noFiles\"]</MudText>\n+\t\t\t\t\t\t\t\t        }\n+\t\t\t\t\t\t\t        </SelectedTemplate>\n+\t\t\t\t\t\t        </MudFileUpload>\n+\n \n \n \t\t\t\t\t        </MudStack>"
        },
        {
          "filename": "Cervantes.Web/Components/Pages/Admin/Users/UserDialog.razor.cs",
          "status": "modified",
          "additions": 12,
          "deletions": 3,
          "patch": "@@ -110,7 +110,16 @@ async Task EditMode()\n             model.Position = user.Position;\n             model.ImagePath = user.Avatar;\n             model.TwoFactorEnabled = user.TwoFactorEnabled;\n-            model.LockoutEnabled = user.LockoutEnabled;\n+            bool locked = false;\n+            if (user.LockoutEnd != null)\n+            {\n+                locked = true;\n+            }\n+            else\n+            {\n+                locked = false;\n+            }\n+            model.Lockout = locked;\n             if (user.ClientId != null)\n             {\n                 model.ClientId = user.ClientId;\n@@ -167,13 +176,13 @@ public UserModelFluentValidator()\n                 .Cascade(CascadeMode.Stop)\n                 .NotEmpty()\n                 .EmailAddress();\n-            RuleFor(p => p.Password).NotEmpty()\n+            RuleFor(p => p.Password)\n                 .MinimumLength(8).WithMessage(\"Your password length must be at least 8.\")\n                 .Matches(@\"[A-Z]+\").WithMessage(\"Your password must contain at least one uppercase letter.\")\n                 .Matches(@\"[a-z]+\").WithMessage(\"Your password must contain at least one lowercase letter.\")\n                 .Matches(@\"[0-9]+\").WithMessage(\"Your password must contain at least one number.\")\n                 .Matches(@\"[\\!\\?\\*\\.]+\").WithMessage(\"Your password must contain at least one (!? *.).\");\n-            RuleFor(x => x.ConfirmPassword).NotEmpty()\n+            RuleFor(x => x.ConfirmPassword)\n                 .MinimumLength(8).WithMessage(\"Your password length must be at least 8.\")\n                 .Matches(@\"[A-Z]+\").WithMessage(\"Your password must contain at least one uppercase letter.\")\n                 .Matches(@\"[a-z]+\").WithMessage(\"Your password must contain at least one lowercase letter.\")"
        },
        {
          "filename": "Cervantes.Web/Components/Pages/Admin/Users/Users.razor",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -81,6 +81,20 @@\n \n                         <PropertyColumn Property=\"x => x.Email\" Title=\"@localizer[\"email\"]\"/>\n                         <PropertyColumn Property=\"x => x.Position\" Title=\"@localizer[\"position\"]\"/>\n+                        <PropertyColumn Property=\"x => x.LockoutEnd\" Title=\"@localizer[\"locked\"]\">\n+                            <CellTemplate Context=\"cellContext\">\n+                                @if (@cellContext.Item.LockoutEnd != null && @cellContext.Item.LockoutEnd > DateTime.Now)\n+                                {\n+                                    <MudIcon Icon=\"@Icons.Material.Filled.CheckCircle\" Color=\"Color.Success\"/>\n+                                }\n+                                else\n+                                {\n+                                    <MudIcon Icon=\"@Icons.Material.Filled.Cancel\" Color=\"Color.Error\"/>\n+                                }\n+                                                \n+                            </CellTemplate>\n+                        </PropertyColumn>\n+                        \n                         <PropertyColumn Property=\"x => x.TwoFactorEnabled\" Title=\"@localizer[\"mfaEnabled\"]\">\n                             <CellTemplate Context=\"cellContext\">\n                                 @if (@cellContext.Item.TwoFactorEnabled)"
        },
        {
          "filename": "Cervantes.Web/Components/Pages/Projects/ProjectDialog.razor",
          "status": "modified",
          "additions": 15,
          "deletions": 12,
          "patch": "@@ -685,19 +685,22 @@ else\n                              Hideable=\"true\" Hover=\"true\" RowClick=\"@RowClickedReports\" MultiSelection=\"true\" SelectedItemsChanged=\"@SelectedReportsChanged\" Virtualize=\"true\" DragDropColumnReordering=\"true\">\n                     <ToolBarContent>\n                         <MudStack Row=\"true\">\n-                            <AuthorizeView Roles=\"Admin,SuperUser\">\n-                                <MudButton Variant=\"Variant.Filled\" StartIcon=\"@Icons.Custom.FileFormats.FilePdf\" Color=\"Color.Primary\" OnClick=\"@((e) => OpenDialogReportCreate(maxWidth))\">@localizer[\"createReport\"]</MudButton>\n-                                @if (seleReports.Count() != 0)\n-                                {\n-                                    <MudButtonGroup Color=\"Color.Primary\" Variant=\"Variant.Outlined\">\n-                                        <MudButton>@localizer[\"actions\"]</MudButton>\n-                                        <MudMenu Icon=\"@Icons.Material.Filled.ArrowDropDown\" Style=\"align-self: auto;\">\n-                                            <MudMenuItem OnClick=\"@((e) => BtnActionsReports(0))\">@localizer[\"delete\"]</MudMenuItem>\n-                                        </MudMenu>\n-                                    </MudButtonGroup>\n-                                }\n+                            @if (inProject)\n+                            {\n+                                <AuthorizeView Roles=\"Admin,SuperUser\">\n+                                    <MudButton Variant=\"Variant.Filled\" StartIcon=\"@Icons.Custom.FileFormats.FilePdf\" Color=\"Color.Primary\" OnClick=\"@((e) => OpenDialogReportCreate(maxWidth))\">@localizer[\"createReport\"]</MudButton>\n+                                    @if (seleReports.Count() != 0)\n+                                    {\n+                                        <MudButtonGroup Color=\"Color.Primary\" Variant=\"Variant.Outlined\">\n+                                            <MudButton>@localizer[\"actions\"]</MudButton>\n+                                            <MudMenu Icon=\"@Icons.Material.Filled.ArrowDropDown\" Style=\"align-self: auto;\">\n+                                                <MudMenuItem OnClick=\"@((e) => BtnActionsReports(0))\">@localizer[\"delete\"]</MudMenuItem>\n+                                            </MudMenu>\n+                                        </MudButtonGroup>\n+                                    }\n \n-                            </AuthorizeView>\n+                                </AuthorizeView>\n+                            }\n                         </MudStack>\n                         <MudSpacer/>\n                         <MudTextField @bind-Value=\"searchStringReport\" Placeholder=\"@localizer[\"search\"]\" Adornment=\"Adornment.Start\" Immediate=\"true\""
        },
        {
          "filename": "Cervantes.Web/Components/Pages/Workspace/Project/WorkspaceProject.razor.cs",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -150,7 +150,7 @@ protected override async Task OnInitializedAsync()\n             new BreadcrumbItem(@localizer[\"home\"], href: \"/\",icon: Icons.Material.Filled.Home),\n             new BreadcrumbItem(\"Workspace\", href: \"/workspaces\",icon: Icons.Material.Filled.Workspaces),\n             new BreadcrumbItem(pro.Name, href: \"/workspace/\"+project,icon: Icons.Material.Filled.Folder),\n-            new BreadcrumbItem(@localizer[\"checklist\"], href: null, disabled: true, icon: Icons.Material.Filled.Checklist)\n+            new BreadcrumbItem(@localizer[\"project\"], href: null, disabled: true, icon: Icons.Material.Filled.Folder)\n         };\n         aiEnabled = _aiService.IsEnabled();\n         await base.OnInitializedAsync();"
        },
        {
          "filename": "Cervantes.Web/Controllers/UserController.cs",
          "status": "modified",
          "additions": 9,
          "deletions": 1,
          "patch": "@@ -267,8 +267,16 @@ public async Task<IActionResult> Edit([FromBody] UserEditViewModel model)\n                 user.FullName = sanitizer.Sanitize(HttpUtility.HtmlDecode(model.FullName));\n                 user.Description = sanitizer.Sanitize(HttpUtility.HtmlDecode(model.Description));\n                 user.Position = sanitizer.Sanitize(HttpUtility.HtmlDecode(model.Position));\n-                user.LockoutEnabled = model.LockoutEnabled;\n                 user.TwoFactorEnabled = model.TwoFactorEnabled;\n+                if (model.Lockout)\n+                {\n+                    user.LockoutEnd = DateTimeOffset.MaxValue;\n+                }\n+                else\n+                {\n+                    user.LockoutEnd = null;\n+                }\n+                \n                 if (model.Role == \"Client\")\n                 {\n                     user.ClientId = model.ClientId;"
        },
        {
          "filename": "Cervantes.Web/Localization/Resource.es-ES.resx",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1758,4 +1758,7 @@ Una vez que hayas escaneado el c\u00f3digo QR o ingresado la clave anterior, tu apli\n     <data name=\"deleteChecklist\" xml:space=\"preserve\">\n         <value>Eliminar Lista de Verificaci\u00f3n</value>\n     </data>\n+    <data name=\"noCategory\" xml:space=\"preserve\">\n+        <value>Sin Categor\u00eda</value>\n+    </data>\n </root>\n\\ No newline at end of file"
        },
        {
          "filename": "Cervantes.Web/Localization/Resource.resx",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1688,4 +1688,7 @@\n     <data name=\"deleteChecklist\" xml:space=\"preserve\">\n         <value>Delete Checklist</value>\n     </data>\n+    <data name=\"noCategory\" xml:space=\"preserve\">\n+        <value>No Category</value>\n+    </data>\n </root>\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 12,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "96159a5cf6851fd1bff8333533369f459cd7dc18",
            "date": "2025-01-03T17:47:42Z",
            "author_login": "mesquidar"
          },
          {
            "sha": "9e9ee33b9aad4c114ae3fd434e1c289ea58981c7",
            "date": "2025-01-03T17:46:22Z",
            "author_login": "mesquidar"
          },
          {
            "sha": "8a43b3ffc58818fed0fdfd7f633a5a01b7d49972",
            "date": "2024-11-24T18:11:34Z",
            "author_login": "mesquidar"
          },
          {
            "sha": "0930bad74461076500dee435cdbace949f2df776",
            "date": "2024-11-21T19:03:14Z",
            "author_login": "mesquidar"
          },
          {
            "sha": "4f9b4159076528daf4dfadcfd1449a440f2e8055",
            "date": "2024-11-14T19:35:37Z",
            "author_login": "mesquidar"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Cervantes through 0.5-alpha allows stored XSS.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-07-28T04:15:01.980",
    "last_modified": "2024-11-21T09:33:29.683",
    "fix_date": "2024-02-03T11:31:25Z"
  },
  "references": [
    {
      "url": "https://github.com/CervantesSec/cervantes/commit/78631a034d0fb3323a53fb7428b2022b29a0d2cd",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.getastra.com/blog/vulnerability/xss-insecure-file-cervantes/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.jinsonvarghese.com/stored-xss-file-upload-vulnerabilities-found-in-cervantes/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/CervantesSec/cervantes/commit/78631a034d0fb3323a53fb7428b2022b29a0d2cd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.getastra.com/blog/vulnerability/xss-insecure-file-cervantes/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.jinsonvarghese.com/stored-xss-file-upload-vulnerabilities-found-in-cervantes/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.485845",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cervantes",
    "owner": "CervantesSec",
    "created_at": "2022-04-30T17:07:34Z",
    "updated_at": "2025-01-13T14:26:08Z",
    "pushed_at": "2025-01-03T17:47:49Z",
    "size": 92327,
    "stars": 286,
    "forks": 44,
    "open_issues": 5,
    "watchers": 286,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "C#": 3903444,
      "HTML": 1480584,
      "JavaScript": 207962,
      "CSS": 15938,
      "Dockerfile": 2228
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T17:28:21.330755"
  }
}