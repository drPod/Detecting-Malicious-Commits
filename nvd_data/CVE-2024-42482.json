{
  "cve_id": "CVE-2024-42482",
  "github_data": {
    "repository": "fish-shop/syntax-check",
    "fix_commit": "91e6817c48ad475542fe4e78139029b036a53b03",
    "related_commits": [
      "91e6817c48ad475542fe4e78139029b036a53b03",
      "c2cb11395e21119ff8d6e7ea050430ee7d6f49ca"
    ],
    "patch_url": "https://github.com/fish-shop/syntax-check/commit/91e6817c48ad475542fe4e78139029b036a53b03.patch",
    "fix_commit_details": {
      "sha": "91e6817c48ad475542fe4e78139029b036a53b03",
      "commit_date": "2024-08-11T13:16:42Z",
      "author": {
        "login": "marcransome",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Harden action with escaping and intermediate env var",
        "length": 52,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 38,
        "additions": 24,
        "deletions": 14
      },
      "files": [
        {
          "filename": "action.yml",
          "status": "modified",
          "additions": 24,
          "deletions": 14,
          "patch": "@@ -11,26 +11,36 @@ inputs:\n runs:\n   using: \"composite\"\n   steps:\n-    - run: |\n+    - name: Syntax check fish shell files\n+      env:\n+        PATTERN: ${{ inputs.pattern }}\n+      run: |\n         set -gx TERM xterm-256color\n \n         set -l passes 0\n         set -l failures 0\n \n-        for file in ${{ inputs.pattern }}\n-            echo -n \"  \"\n-            set output (fish --no-execute $file 2>&1)\n-            if test $status -ne 0\n-                set_color red; and echo -n \"\u2716\"; and set_color normal\n-                echo \" $file\"\n-                for line in (string split $output)\n-                    echo \"      $line\"\n+        for pattern in (string split --no-empty -- \" \" $PATTERN)\n+            set -l escaped (string escape --style=script --no-quoted -- $pattern)\n+            set -l escaped (string replace -r -a -- '\\\\\\([?*{}])' '$1' $escaped)\n+\n+            eval set -l files $escaped\n+\n+            for file in $files\n+                echo -n \"  \"\n+                set output (fish --no-execute $file 2>&1)\n+                if test $status -ne 0\n+                    set_color red; and echo -n \"\u2716\"; and set_color normal\n+                    echo \" $file\"\n+                    for line in (string split -- $output)\n+                        echo \"      $line\"\n+                    end\n+                    set failures (math $failures + 1)\n+                else\n+                    set_color green; and echo -n \"\u2714\"; and set_color normal\n+                    echo \" $file\"\n+                    set passes (math $passes + 1)\n                 end\n-                set failures (math $failures + 1)\n-            else\n-                set_color green; and echo -n \"\u2714\"; and set_color normal\n-                echo \" $file\"\n-                set passes (math $passes + 1)\n             end\n         end\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "448ac599bc8b5fc2867b35a32c7d8eb355cf04fa",
            "date": "2025-01-10T22:08:55Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "af3726892a909342f6a0d161ed2d7d33edeff93f",
            "date": "2025-01-10T22:07:08Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "d538ed7c432930ebebe243bd30201d6fc6cb4978",
            "date": "2025-01-06T23:55:41Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "fe988886ffdeda3453e46653cb810f70669ec0ef",
            "date": "2025-01-06T23:49:31Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "b039521a39cf91d06de552a65d82128581ca7150",
            "date": "2024-12-21T11:34:55Z",
            "author_login": "marcransome"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-140",
    "description": "fish-shop/syntax-check is a GitHub action for syntax checking fish shell files. Improper neutralization of delimiters in the `pattern` input (specifically the command separator `;` and command substitution characters `(` and `)`) mean that arbitrary command injection is possible by modification of the input value used in a workflow. This has the potential for exposure or exfiltration of sensitive information from the workflow runner, such as might be achieved by sending environment variables to an external entity. It is recommended that users update to the patched version `v1.6.12` or the latest release version `v2.0.0`, however remediation may be possible through careful control of workflows and the `pattern` input value used by this action.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-08-12T16:15:16.213",
    "last_modified": "2024-09-17T12:20:58.323",
    "fix_date": "2024-08-11T13:16:42Z"
  },
  "references": [
    {
      "url": "https://github.com/fish-shop/syntax-check/commit/91e6817c48ad475542fe4e78139029b036a53b03",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fish-shop/syntax-check/commit/c2cb11395e21119ff8d6e7ea050430ee7d6f49ca",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/fish-shop/syntax-check/security/advisories/GHSA-xj87-mqvh-88w2",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.557962",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "syntax-check",
    "owner": "fish-shop",
    "created_at": "2021-05-22T21:06:10Z",
    "updated_at": "2025-01-10T22:09:01Z",
    "pushed_at": "2025-01-10T22:09:47Z",
    "size": 1073,
    "stars": 5,
    "forks": 0,
    "open_issues": 0,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {},
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:21:32.050857"
  }
}