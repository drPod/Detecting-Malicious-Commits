{
  "cve_id": "CVE-2024-43369",
  "github_data": {
    "repository": "ibexa/fieldtype-richtext",
    "fix_commit": "0a3b830e8806d5169f697351fdc48ffd95a25c67",
    "related_commits": [
      "0a3b830e8806d5169f697351fdc48ffd95a25c67",
      "59e9c1a9da60597f60cf7338bf289dccaa7e27ca"
    ],
    "patch_url": "https://github.com/ibexa/fieldtype-richtext/commit/0a3b830e8806d5169f697351fdc48ffd95a25c67.patch",
    "fix_commit_details": {
      "sha": "0a3b830e8806d5169f697351fdc48ffd95a25c67",
      "commit_date": "2024-08-14T10:53:01Z",
      "author": {
        "login": "Steveb-p",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge branch '2.3' into 4.6",
        "length": 27,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 6,
        "deletions": 5
      },
      "files": [
        {
          "filename": "src/bundle/Resources/richtext/schemas/docbook/docbook.iso.sch",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -260,8 +260,9 @@\n                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezlocation://') or\n                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezremote://') or\n                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezurl://') or\n+                      starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '/') or\n                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '#')\"\n-                mode=\"schematron-get-full-path-2\">links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, #</s:assert>\n+                mode=\"schematron-get-full-path-2\">links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, /, #</s:assert>\n       <s:assert test=\"not(contains(@*[name()='xlink:href'], '&lt;') or\n                           contains(@*[name()='xlink:href'], '&gt;') or\n                           contains(@*[name()='xlink:href'], '&quot;'))\""
        },
        {
          "filename": "src/bundle/Resources/richtext/schemas/docbook/docbook.iso.sch.xsl",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -79,7 +79,7 @@\n <axsl:template match=\"db:link\" priority=\"1000\" mode=\"M3\"><svrl:fired-rule xmlns:svrl=\"http://purl.oclc.org/dsdl/svrl\" context=\"db:link\"/>\n \n \t\t<!--ASSERT -->\n-<axsl:choose><axsl:when test=\"starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'http://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'https://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'mailto:') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezcontent://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezlocation://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezremote://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezurl://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '#')\"/><axsl:otherwise><svrl:failed-assert xmlns:svrl=\"http://purl.oclc.org/dsdl/svrl\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:schold=\"http://www.ascc.net/xml/schematron\" test=\"starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'http://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'https://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'mailto:') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezcontent://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezlocation://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezremote://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezurl://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '#')\"><axsl:attribute name=\"location\"><axsl:apply-templates select=\".\" mode=\"schematron-get-full-path-2\"/></axsl:attribute><svrl:text>links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, #</svrl:text></svrl:failed-assert></axsl:otherwise></axsl:choose>\n+<axsl:choose><axsl:when test=\"starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'http://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'https://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'mailto:') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezcontent://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezlocation://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezremote://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezurl://') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '/') or                       starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '#')\"/><axsl:otherwise><svrl:failed-assert xmlns:svrl=\"http://purl.oclc.org/dsdl/svrl\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:schold=\"http://www.ascc.net/xml/schematron\" test=\"starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'http://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'https://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'mailto:') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezcontent://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezlocation://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezremote://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), 'ezurl://') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '/') or starts-with(translate(@*[name()='xlink:href'], $upperCase, $lowerCase), '#')\"><axsl:attribute name=\"location\"><axsl:apply-templates select=\".\" mode=\"schematron-get-full-path-2\"/></axsl:attribute><svrl:text>links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, /, #</svrl:text></svrl:failed-assert></axsl:otherwise></axsl:choose>\n \n \t\t<!--ASSERT -->\n <axsl:choose><axsl:when test=\"not(contains(@*[name()='xlink:href'], '&lt;') or                           contains(@*[name()='xlink:href'], '&gt;') or                           contains(@*[name()='xlink:href'], '&quot;'))\"/><axsl:otherwise><svrl:failed-assert xmlns:svrl=\"http://purl.oclc.org/dsdl/svrl\" xmlns:xs=\"http://www.w3.org/2001/XMLSchema\" xmlns:schold=\"http://www.ascc.net/xml/schematron\" test=\"not(contains(@*[name()='xlink:href'], '&lt;') or contains(@*[name()='xlink:href'], '&gt;') or contains(@*[name()='xlink:href'], '&quot;'))\"><axsl:attribute name=\"location\"><axsl:apply-templates select=\".\" mode=\"schematron-get-full-path-2\"/></axsl:attribute><svrl:text>using characters [&lt; &gt; \"] in links is not allowed</svrl:text></svrl:failed-assert></axsl:otherwise></axsl:choose><axsl:apply-templates select=\"*|comment()|processing-instruction()\" mode=\"M3\"/></axsl:template><axsl:template match=\"text()\" priority=\"-1\" mode=\"M3\"/><axsl:template match=\"@*|node()\" priority=\"-2\" mode=\"M3\"><axsl:apply-templates select=\"*|comment()|processing-instruction()\" mode=\"M3\"/></axsl:template></axsl:stylesheet>"
        },
        {
          "filename": "tests/lib/FieldType/RichTextTest.php",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -229,7 +229,7 @@ public function providerForTestValidate()\n                 [\n                     new ValidationError(\n                         \"Validation of XML content failed:\\n\" .\n-                        '/section/para/link: links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, #',\n+                        '/section/para/link: links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, /, #',\n                         null,\n                         [],\n                         'xml'\n@@ -244,7 +244,7 @@ public function providerForTestValidate()\n                 [\n                     new ValidationError(\n                         \"Validation of XML content failed:\\n\" .\n-                        '/section/para/link: links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, #',\n+                        '/section/para/link: links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, /, #',\n                         null,\n                         [],\n                         'xml'\n@@ -274,7 +274,7 @@ public function providerForTestValidate()\n                 [\n                     new ValidationError(\n                         \"Validation of XML content failed:\\n\" .\n-                        '/section/para/link: links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, #',\n+                        '/section/para/link: links must start with one of: http://, https://, mailto:, ezcontent://, ezlocation://, ezremote://, ezurl://, /, #',\n                         null,\n                         [],\n                         'xml'"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "236dec2236c9a80b3011c3482b95efc553ffae7d",
            "date": "2025-01-13T08:26:20Z",
            "author_login": "GrabowskiM"
          },
          {
            "sha": "ef64b0ac77cdddc52bbb09d11e44d1e4237b99b1",
            "date": "2025-01-09T09:10:03Z",
            "author_login": "GrabowskiM"
          },
          {
            "sha": "fe4db77d6838d6f7883bbbc1bf2477a6ab9895b0",
            "date": "2024-12-18T13:51:27Z",
            "author_login": "lucasOsti"
          },
          {
            "sha": "f93246cdd1d1e862b7f6eebd62356083dfd0e015",
            "date": "2024-12-12T07:55:23Z",
            "author_login": "GrabowskiM"
          },
          {
            "sha": "640419c510f2a37c3e3fc03fd83d089d2472476e",
            "date": "2024-12-12T07:53:59Z",
            "author_login": "GrabowskiM"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Ibexa RichText Field Type is a Field Type for supporting rich formatted text stored in a structured XML format. In versions on the 4.6 branch prior to 4.6.10, the validator for the RichText fieldtype blocklists `javascript:` and `vbscript:` in links to prevent XSS. This can leave other options open, and the check can be circumvented using upper case. Content editing permissions for RichText content is required to exploit this vulnerability, which typically means Editor role or higher. The fix implements an allowlist instead, which allows only approved link protocols. The new check is case insensitive. Version 4.6.10 contains a patch for this issue. No known workarounds are available.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-16T02:15:16.600",
    "last_modified": "2024-08-19T13:00:23.117",
    "fix_date": "2024-08-14T10:53:01Z"
  },
  "references": [
    {
      "url": "https://developers.ibexa.co/security-advisories/ibexa-sa-2024-005-persistent-xss-in-richtext",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ezsystems/ezplatform-richtext/security/advisories/GHSA-rhm7-7469-rcpw",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ibexa/fieldtype-richtext/commit/0a3b830e8806d5169f697351fdc48ffd95a25c67",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ibexa/fieldtype-richtext/commit/59e9c1a9da60597f60cf7338bf289dccaa7e27ca",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ibexa/fieldtype-richtext/security/advisories/GHSA-hvcf-6324-cjh7",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.358182",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "fieldtype-richtext",
    "owner": "ibexa",
    "created_at": "2021-03-31T07:25:00Z",
    "updated_at": "2025-01-13T08:26:30Z",
    "pushed_at": "2025-01-13T15:05:38Z",
    "size": 1837,
    "stars": 5,
    "forks": 6,
    "open_issues": 7,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "PHP": 631524,
      "XSLT": 269961,
      "JavaScript": 210827,
      "SCSS": 19265,
      "Twig": 9872,
      "Shell": 2308
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:27:50.851913"
  }
}