{
  "cve_id": "CVE-2024-43399",
  "github_data": {
    "repository": "MobSF/Mobile-Security-Framework-MobSF",
    "fix_commit": "cc625fe8430f3437a473e82aa2966d100a4dc883",
    "related_commits": [
      "cc625fe8430f3437a473e82aa2966d100a4dc883"
    ],
    "patch_url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/cc625fe8430f3437a473e82aa2966d100a4dc883.patch",
    "fix_commit_details": {
      "sha": "cc625fe8430f3437a473e82aa2966d100a4dc883",
      "commit_date": "2024-08-18T09:07:14Z",
      "author": {
        "login": "ajinabraham",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[SECURITY][HOTFIX] Fixes GHSA-4hh3-vj32-gr6j (#2421)",
        "length": 126,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 762,
        "additions": 398,
        "deletions": 364
      },
      "files": [
        {
          "filename": ".github/SECURITY.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -18,6 +18,7 @@ Please report all security issues [here](https://github.com/MobSF/Mobile-Securit\n \n | Vulnerability | Affected Versions |\n | ------- | ------------------ |\n+| [Zip Slip Vulnerability in .a extraction](https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-4hh3-vj32-gr6j) | `<=4.0.6` |\n | [Open Redirect in Login redirect](https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-8m9j-2f32-2vx4) | `<=4.0.4` |\n | [SSRF in firebase database check](https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-wpff-wm84-x5cx) | `<=3.9.7` |\n | [SSRF in AppLink check via abusing url redirect](https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-m435-9v6r-v5f6) | `<=3.9.6` |"
        },
        {
          "filename": "mobsf/MobSF/init.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -10,7 +10,7 @@\n \n logger = logging.getLogger(__name__)\n \n-VERSION = '4.0.6'\n+VERSION = '4.0.7'\n BANNER = \"\"\"\n   __  __       _    ____  _____       _  _    ___  \n  |  \\/  | ___ | |__/ ___||  ___|_   _| || |  / _ \\ "
        },
        {
          "filename": "mobsf/StaticAnalyzer/views/common/shared_func.py",
          "status": "modified",
          "additions": 7,
          "deletions": 3,
          "patch": "@@ -30,6 +30,7 @@\n     URL_REGEX,\n     append_scan_status,\n     is_md5,\n+    is_path_traversal,\n     is_safe_path,\n     print_n_send_error_response,\n     upstream_proxy,\n@@ -185,9 +186,12 @@ def ar_extract(checksum, src, dst):\n         ar.read_all_headers()\n         for a, val in ar.archived_files.items():\n             # Handle archive slip attacks\n-            filtered = a.decode(\n-                'utf-8', 'ignore').replace(\n-                '../', '').replace('..\\\\', '')\n+            filtered = a.decode('utf-8', 'ignore')\n+            if is_path_traversal(filtered):\n+                msg = f'Zip slip detected. skipped extracting {filtered}'\n+                logger.warning(msg)\n+                append_scan_status(checksum, msg)\n+                continue\n             out = Path(dst) / filtered\n             out.write_bytes(val.read())\n     except Exception:"
        },
        {
          "filename": "poetry.lock",
          "status": "modified",
          "additions": 388,
          "deletions": 359,
          "patch": null
        },
        {
          "filename": "pyproject.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n [tool.poetry]\n name = \"mobsf\"\n-version = \"4.0.6\"\n+version = \"4.0.7\"\n description = \"Mobile Security Framework (MobSF) is an automated, all-in-one mobile application (Android/iOS/Windows) pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis.\"\n keywords = [\"mobsf\", \"mobile security framework\", \"mobile security\", \"security tool\", \"static analysis\", \"dynamic analysis\", \"malware analysis\"]\n authors = [\"Ajin Abraham <ajin@opensecurity.in>\"]"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "79b2d28c3b45dd176b0e63bd3deef2608960339a",
            "date": "2024-12-19T02:35:11Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "180de6b6110c9deba5284ae65ffaa46b660516ad",
            "date": "2024-12-18T01:56:54Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "17332e88c0f6c264c689af4eeedd515327c2713c",
            "date": "2024-12-18T01:56:25Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "fbf567446bfe818b179aed074ec5f2c4de3915d3",
            "date": "2024-12-18T01:03:03Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "3223736d93b2c7e4b55e739e135f5d728d0b66dd",
            "date": "2024-12-12T02:08:06Z",
            "author_login": "ajinabraham"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-23",
    "description": "Mobile Security Framework (MobSF) is a pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis. Before 4.0.7, there is a flaw in the Static Libraries analysis section. Specifically, during the extraction of .a extension files, the measure intended to prevent Zip Slip attacks is improperly implemented. Since the implemented measure can be bypassed, the vulnerability allows an attacker to extract files to any desired location within the server running MobSF. This vulnerability is fixed in 4.0.7.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-19T15:15:09.073",
    "last_modified": "2024-08-20T16:21:22.747",
    "fix_date": "2024-08-18T09:07:14Z"
  },
  "references": [
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/cc625fe8430f3437a473e82aa2966d100a4dc883",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-4hh3-vj32-gr6j",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.365173",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Mobile-Security-Framework-MobSF",
    "owner": "MobSF",
    "created_at": "2015-01-31T04:36:01Z",
    "updated_at": "2025-01-14T12:25:42Z",
    "pushed_at": "2024-12-19T02:35:13Z",
    "size": 1525379,
    "stars": 17868,
    "forks": 3277,
    "open_issues": 13,
    "watchers": 17868,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 1582153,
      "Python": 1354876,
      "HTML": 1073775,
      "CSS": 148866,
      "Shell": 11552,
      "Batchfile": 4318,
      "PowerShell": 3089,
      "Dockerfile": 2892
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:25:15.645730"
  }
}