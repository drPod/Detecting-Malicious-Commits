{
  "cve_id": "CVE-2024-43411",
  "github_data": {
    "repository": "ckeditor/ckeditor4",
    "fix_commit": "b5069c9cb769ea22eae1cbd7200f22b1cf2e3a7f",
    "related_commits": [
      "b5069c9cb769ea22eae1cbd7200f22b1cf2e3a7f"
    ],
    "patch_url": "https://github.com/ckeditor/ckeditor4/commit/b5069c9cb769ea22eae1cbd7200f22b1cf2e3a7f.patch",
    "fix_commit_details": {
      "sha": "b5069c9cb769ea22eae1cbd7200f22b1cf2e3a7f",
      "commit_date": "2024-08-14T13:30:37Z",
      "author": {
        "login": "jacekbogdanski",
        "type": "User",
        "stats": {
          "total_commits": 1559,
          "average_weekly_commits": 2.1592797783933517,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 191
        }
      },
      "commit_message": {
        "title": "Merge pull request #36 from cksource/update-version-check",
        "length": 80,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 41,
        "additions": 24,
        "deletions": 17
      },
      "files": [
        {
          "filename": "core/ckeditor_version-check.js",
          "status": "modified",
          "additions": 24,
          "deletions": 17,
          "patch": "@@ -52,18 +52,20 @@\n \n \t\ttry {\n \t\t\tvar request = new XMLHttpRequest(),\n-\t\t\t\trequestUrl = apiUrl + '?v=' + encodeURIComponent( versionInfo.current.original );\n+\t\t\t\trequestUrl = apiUrl + '?v=' + encodeURIComponent( versionInfo.current.name );\n \n \t\t\trequest.onreadystatechange = function() {\n \t\t\t\tif ( request.readyState === 4 && request.status === 200 ) {\n-\t\t\t\t\tvar response = JSON.parse( request.responseText );\n+\t\t\t\t\ttry {\n+\t\t\t\t\t\tvar response = JSON.parse( request.responseText );\n \n-\t\t\t\t\tversionInfo.latest = parseVersion( response.latestVersion );\n-\t\t\t\t\tversionInfo.secure = parseVersion( response.secureVersion );\n-\t\t\t\t\tversionInfo.isLatest = isLatestVersion();\n-\t\t\t\t\tversionInfo.isSecure = isSecureVersion();\n+\t\t\t\t\t\tversionInfo.latest = parseVersion( response.latestVersion );\n+\t\t\t\t\t\tversionInfo.secure = parseVersion( response.secureVersion );\n+\t\t\t\t\t\tversionInfo.isLatest = isLatestVersion();\n+\t\t\t\t\t\tversionInfo.isSecure = isSecureVersion();\n \n-\t\t\t\t\tcallback();\n+\t\t\t\t\t\tcallback();\n+\t\t\t\t\t} catch ( e ) {}\n \t\t\t\t}\n \t\t\t};\n \n@@ -79,8 +81,8 @@\n \t\t\treturn;\n \t\t}\n \n-\t\tvar notificationMessage =  editor.lang.versionCheck.notificationMessage.replace( '%current', versionInfo.current.original ).\n-\t\t\t\treplace( '%latest', versionInfo.latest.original ).\n+\t\tvar notificationMessage =  editor.lang.versionCheck.notificationMessage.replace( '%current', versionInfo.current.name ).\n+\t\t\t\treplace( '%latest', versionInfo.latest.name ).\n \t\t\t\treplace( /%link/g, upgradeLink ),\n \t\t\tisNotificationAvailable = 'notification' in editor.plugins;\n \n@@ -102,8 +104,8 @@\n \n \t\tconsoleErrorDisplayed = true;\n \n-\t\tvar consoleMessage =  editor.lang.versionCheck.consoleMessage.replace( '%current', versionInfo.current.original ).\n-\t\t\treplace( '%latest', versionInfo.latest.original ).\n+\t\tvar consoleMessage =  editor.lang.versionCheck.consoleMessage.replace( '%current', versionInfo.current.name ).\n+\t\t\treplace( '%latest', versionInfo.latest.name ).\n \t\t\treplace( /%link/g, upgradeLink );\n \n \t\tconsole.error( consoleMessage );\n@@ -133,8 +135,8 @@\n \t\t\tmsg = lang.aboutDialogInsecureMessage;\n \t\t}\n \n-\t\treturn msg.replace( '%current', versionInfo.current.original ).\n-\t\t\t\treplace( '%latest', versionInfo.latest.original ).\n+\t\treturn msg.replace( '%current', versionInfo.current.name ).\n+\t\t\t\treplace( '%latest', versionInfo.latest.name ).\n \t\t\t\treplace( /%link/g, upgradeLink );\n \t}\n \n@@ -166,12 +168,17 @@\n \t\t\treturn null;\n \t\t}\n \n+\t\tvar minor = parseInt( parts[ 1 ] ),\n+\t\t\tpatch = parseInt( parts[ 2 ] ),\n+\t\t\tisIts = !!parts[ 3 ],\n+\t\t\tname = '4.' + minor + '.' + patch + ( isIts ? '-lts' : '' );\n+\n \t\treturn {\n-\t\t\toriginal: version,\n+\t\t\tname: name,\n \t\t\tmajor: 4,\n-\t\t\tminor: Number( parts[ 1 ] ),\n-\t\t\tpatch: Number( parts[ 2 ] ),\n-\t\t\tisLts: !!parts[ 3 ]\n+\t\t\tminor: minor,\n+\t\t\tpatch: patch,\n+\t\t\tisLts: isIts\n \t\t};\n \t}\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "82796d03d0ebbe34d48f3b65c6dde27107812a51",
            "date": "2024-08-21T07:39:31Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "c40e7a3193309108d5ef90b7dac92066cfd52aa0",
            "date": "2024-08-21T07:12:23Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "aa9e5e1780101aebff48de0427d8c6547d71dab1",
            "date": "2024-08-21T07:11:35Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "3215349022971fb8dddaf46f183152e0ce5d4d99",
            "date": "2024-08-21T07:05:13Z",
            "author_login": "jacekbogdanski"
          },
          {
            "sha": "ac2d36d1acd9447fa3fdcc871bccef95e632d6f9",
            "date": "2024-08-20T09:39:22Z",
            "author_login": "jacekbogdanski"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "CKEditor4 is an open source what-you-see-is-what-you-get HTML editor. A theoretical vulnerability has been identified in CKEditor 4.22 (and above). In a highly unlikely scenario where an attacker gains control over the https://cke4.ckeditor.com domain, they could potentially execute an attack on CKEditor 4 instances. The issue impacts only editor instances with enabled version notifications. Please note that this feature is disabled by default in all CKEditor 4 LTS versions. Therefore, if you use CKEditor 4 LTS, it is highly unlikely that you are affected by this vulnerability. If you are unsure, please contact us. The fix is available in version 4.25.0-lts.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-08-21T16:15:08.570",
    "last_modified": "2024-08-21T17:25:08.560",
    "fix_date": "2024-08-14T13:30:37Z"
  },
  "references": [
    {
      "url": "https://github.com/ckeditor/ckeditor4/commit/b5069c9cb769ea22eae1cbd7200f22b1cf2e3a7f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/ckeditor/ckeditor4/security/advisories/GHSA-6v96-m24v-f58j",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.381218",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ckeditor4",
    "owner": "ckeditor",
    "created_at": "2012-08-20T14:21:13Z",
    "updated_at": "2025-01-13T09:13:45Z",
    "pushed_at": "2024-08-21T07:42:32Z",
    "size": 138229,
    "stars": 5795,
    "forks": 2478,
    "open_issues": 1184,
    "watchers": 5795,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Rich Text Format": 179759729,
      "HTML": 25244344,
      "JavaScript": 11653753,
      "CSS": 291415,
      "Shell": 9678,
      "Python": 2436
    },
    "commit_activity": {
      "total_commits_last_year": 42,
      "avg_commits_per_week": 0.8076923076923077,
      "days_active_last_year": 15
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T12:55:32.768773"
  }
}