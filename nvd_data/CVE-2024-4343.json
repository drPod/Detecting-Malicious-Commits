{
  "cve_id": "CVE-2024-4343",
  "github_data": {
    "repository": "imartinez/privategpt",
    "fix_commit": "86368c61760c9cee5d977131d23ad2a3e063cbe9",
    "related_commits": [
      "86368c61760c9cee5d977131d23ad2a3e063cbe9"
    ],
    "patch_url": "https://github.com/imartinez/privategpt/commit/86368c61760c9cee5d977131d23ad2a3e063cbe9.patch",
    "fix_commit_details": {
      "sha": "86368c61760c9cee5d977131d23ad2a3e063cbe9",
      "commit_date": "2024-04-26T17:07:57Z",
      "author": {
        "login": "retr0reg",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Replacing unsafe `eval()` with `json.loads()`",
        "length": 45,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "private_gpt/components/llm/custom/sagemaker.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -218,7 +218,7 @@ def complete(self, prompt: str, **kwargs: Any) -> CompletionResponse:\n \n         response_body = resp[\"Body\"]\n         response_str = response_body.read().decode(\"utf-8\")\n-        response_dict = eval(response_str)\n+        response_dict = json.loads(response_str)\n \n         return CompletionResponse(\n             text=response_dict[0][\"generated_text\"][len(prompt) :], raw=resp"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b7ee43788d1ffcc53ff0117541c7292cf2a127c5",
            "date": "2024-11-13T19:29:56Z",
            "author_login": "imartinez"
          },
          {
            "sha": "940bdd49af14d9c1e7fd4af54f12648b5fc1f9c0",
            "date": "2024-10-17T10:44:28Z",
            "author_login": "meng-hui"
          },
          {
            "sha": "5851b02378313f3dba315e0251cfd421af79dae6",
            "date": "2024-09-26T14:29:52Z",
            "author_login": "jaluma"
          },
          {
            "sha": "5fbb402477c41e09f56a3e5adc32f316341772bf",
            "date": "2024-09-25T10:00:03Z",
            "author_login": "laoqiu233"
          },
          {
            "sha": "fa3c30661d2ab04634361e20e7819365e3dd351a",
            "date": "2024-09-24T06:33:02Z",
            "author_login": "basicbloke"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-78",
    "description": "A Python command injection vulnerability exists in the `SagemakerLLM` class's `complete()` method within `./private_gpt/components/llm/custom/sagemaker.py` of the imartinez/privategpt application, versions up to and including 0.3.0. The vulnerability arises due to the use of the `eval()` function to parse a string received from a remote AWS SageMaker LLM endpoint into a dictionary. This method of parsing is unsafe as it can execute arbitrary Python code contained within the response. An attacker can exploit this vulnerability by manipulating the response from the AWS SageMaker LLM endpoint to include malicious Python code, leading to potential execution of arbitrary commands on the system hosting the application. The issue is fixed in version 0.6.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-14T18:15:19.687",
    "last_modified": "2024-11-18T21:35:08.590",
    "fix_date": "2024-04-26T17:07:57Z"
  },
  "references": [
    {
      "url": "https://github.com/imartinez/privategpt/commit/86368c61760c9cee5d977131d23ad2a3e063cbe9",
      "source": "security@huntr.dev",
      "tags": []
    },
    {
      "url": "https://huntr.com/bounties/1d1e8f06-ec45-4b17-ae24-b83a41304c15",
      "source": "security@huntr.dev",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.298938",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "private-gpt",
    "owner": "imartinez",
    "created_at": "2023-05-02T09:15:31Z",
    "updated_at": "2025-01-14T11:11:05Z",
    "pushed_at": "2024-11-13T19:30:32Z",
    "size": 2778,
    "stars": 54885,
    "forks": 7374,
    "open_issues": 254,
    "watchers": 54885,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 239830,
      "MDX": 73879,
      "Makefile": 2800
    },
    "commit_activity": {
      "total_commits_last_year": 102,
      "avg_commits_per_week": 1.9615384615384615,
      "days_active_last_year": 48
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:09:24.605579"
  }
}