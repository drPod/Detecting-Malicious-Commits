{
  "cve_id": "CVE-2024-43782",
  "github_data": {
    "repository": "openedx/openedx-translations",
    "fix_commit": "3c4093705dec99590577c4d8270ce263f7fffc5a",
    "related_commits": [
      "3c4093705dec99590577c4d8270ce263f7fffc5a",
      "b2444340e8702c7955310331c1db5fd85b25b92b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "3c4093705dec99590577c4d8270ce263f7fffc5a",
      "commit_date": "2024-08-23T13:57:01Z",
      "author": {
        "login": "brian-smith-tcril",
        "type": "User",
        "stats": {
          "total_commits": 29,
          "average_weekly_commits": 0.22137404580152673,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 14
        }
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 69,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 38,
        "additions": 33,
        "deletions": 5
      },
      "files": [
        {
          "filename": "scripts/tests/mock_translations_dir/demo-xblock/conf/locale/hi/LC_MESSAGES/django.po",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -13,6 +13,7 @@ msgstr \"\"\n \"Plural-Forms: nplurals=2; plural=(n != 1);\\n\"\n \"Generated-By: Babel 2.8.0\\n\"\n \n+# Translation has invalid brace-format with encoding errors\n #, python-brace-format\n msgid \"{action} is not a valid action.\"\n-msgstr \"{\u0915\u093e\u0930\u094d\u0930\u0935\u093e\u0908} \u090f\u0915 \u0935\u0948\u0927 \u0915\u093e\u0930\u094d\u0930\u0935\u093e\u0908 \u0928\u0939\u0940\u0902 \u0939\u0948\u0964\"  # Invalid brace-format with encoding errors\n+msgstr \"{\u0915\u093e\u0930\u094d\u0930\u0935\u093e\u0908} \u090f\u0915 \u0935\u0948\u0927 \u0915\u093e\u0930\u094d\u0930\u0935\u093e\u0908 \u0928\u0939\u0940\u0902 \u0939\u0948\u0964\""
        },
        {
          "filename": "scripts/validate_translation_files.py",
          "status": "modified",
          "additions": 31,
          "deletions": 4,
          "patch": "@@ -7,7 +7,9 @@\n import os.path\n import subprocess\n import sys\n+import textwrap\n \n+import i18n.validate\n \n def get_translation_files(translation_directory):\n     \"\"\"\n@@ -29,18 +31,43 @@ def validate_translation_file(po_file):\n     This function combines both stderr and stdout output of the `msgfmt` in a\n     single variable.\n     \"\"\"\n+    valid = True\n+    output = \"\"\n+\n     completed_process = subprocess.run(\n         ['msgfmt', '-v', '--strict', '--check', po_file],\n         stdout=subprocess.PIPE,\n         stderr=subprocess.PIPE,\n     )\n \n-    stdout = completed_process.stdout.decode(encoding='utf-8', errors='replace')\n-    stderr = completed_process.stderr.decode(encoding='utf-8', errors='replace')\n+    if completed_process.returncode != 0:\n+        valid = False\n+\n+    msgfmt_stdout = completed_process.stdout.decode(encoding='utf-8', errors='replace')\n+    msgfmt_stderr = completed_process.stderr.decode(encoding='utf-8', errors='replace')\n+    output += f'{msgfmt_stdout}\\n{msgfmt_stderr}\\n'\n+\n+    try:\n+      problems = i18n.validate.check_messages(po_file)\n+    except Exception as e:\n+      output += f'{e} {traceback.format_exc()}'\n+      valid = False\n+      problems = []\n+    if problems:\n+        valid = False\n+\n+    id_filler = textwrap.TextWrapper(width=79, initial_indent=\"  msgid: \", subsequent_indent=\" \" * 9)\n+    tx_filler = textwrap.TextWrapper(width=79, initial_indent=\"  -----> \", subsequent_indent=\" \" * 9)\n+    for problem in problems:\n+        desc, msgid = problem[:2]\n+        output += f\"{desc}\\n{id_filler.fill(msgid)}\\n\"\n+        for translation in problem[2:]:\n+            output += f\"{tx_filler.fill(translation)}\\n\"\n+        output += \"\\n\"\n \n     return {\n-        'valid': completed_process.returncode == 0,\n-        'output': f'{stdout}\\n{stderr}',\n+        'valid': valid,\n+        'output': output,\n     }\n \n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "6e44aaf4c93c86950646531ae08540e0cab59c80",
            "date": "2025-01-26T01:19:30Z",
            "author_login": "openedx-transifex-bot"
          },
          {
            "sha": "9eec8d88b183dc51ac174b5e214e8916dec3c5fa",
            "date": "2025-01-26T00:35:42Z",
            "author_login": "openedx-transifex-bot"
          },
          {
            "sha": "cbe30061258084f48689e292558547d9ff18f017",
            "date": "2025-01-26T00:33:27Z",
            "author_login": "openedx-transifex-bot"
          },
          {
            "sha": "4918e465e544e8e61f6949e24362878be77b14cf",
            "date": "2025-01-26T00:32:56Z",
            "author_login": "openedx-transifex-bot"
          },
          {
            "sha": "a500ff1f4c5da4a505cf9cedc413ae35eb7c6e00",
            "date": "2025-01-26T00:30:57Z",
            "author_login": "openedx-transifex-bot"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-74",
    "description": "This openedx-translations repository contains translation files from Open edX repositories to be kept in sync with Transifex. Before moving to pulling translations from the openedx-translations repository via openedx-atlas, translations in the edx-platform repository were validated using edx-i18n-tools. This validation included protection against malformed translations and translations-based script injections. Prior to this patch, the validation implemented in the openedx-translations repository did not include the same protections. The maintainer inspected the translations in the edx-platform directory of both the main and open-release/redwood.master branches of the openedx-translations repository and found no evidence of exploited translation strings.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-08-23T15:15:16.600",
    "last_modified": "2024-09-12T18:29:50.943",
    "fix_date": "2024-08-23T13:57:01Z"
  },
  "references": [
    {
      "url": "https://github.com/openedx/openedx-translations/commit/3c4093705dec99590577c4d8270ce263f7fffc5a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openedx/openedx-translations/commit/b2444340e8702c7955310331c1db5fd85b25b92b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/openedx/openedx-translations/security/advisories/GHSA-fg8c-2pvj-wx3j",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.389219",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "openedx-translations",
    "owner": "openedx",
    "created_at": "2022-08-03T20:53:06Z",
    "updated_at": "2025-01-26T01:19:35Z",
    "pushed_at": "2025-01-26T01:19:31Z",
    "size": 73575,
    "stars": 4,
    "forks": 56,
    "open_issues": 103,
    "watchers": 4,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Python": 35016,
      "Makefile": 2019,
      "Shell": 1375
    },
    "commit_activity": {
      "total_commits_last_year": 6636,
      "avg_commits_per_week": 127.61538461538461,
      "days_active_last_year": 307
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "cc-by-sa-4.0"
    },
    "collected_at": "2025-01-26T08:06:20.716109"
  }
}