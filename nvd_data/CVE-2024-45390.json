{
  "cve_id": "CVE-2024-45390",
  "github_data": {
    "repository": "blakeembrey/js-template",
    "fix_commit": "b8d9aa999e464816c6cfb14acd1ad0f5d1e335aa",
    "related_commits": [
      "b8d9aa999e464816c6cfb14acd1ad0f5d1e335aa"
    ],
    "patch_url": "https://github.com/blakeembrey/js-template/commit/b8d9aa999e464816c6cfb14acd1ad0f5d1e335aa.patch",
    "fix_commit_details": {
      "sha": "b8d9aa999e464816c6cfb14acd1ad0f5d1e335aa",
      "commit_date": "2024-09-02T23:43:41Z",
      "author": {
        "login": "blakeembrey",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Remove template display name",
        "length": 28,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 11,
        "additions": 4,
        "deletions": 7
      },
      "files": [
        {
          "filename": "src/index.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 7,
          "patch": "@@ -7,7 +7,7 @@ export type Template<T extends object> = (data: T) => string;\n /**\n  * Stringify a template into a function.\n  */\n-export function compile(value: string, displayName = \"template\") {\n+export function compile(value: string) {\n   let result = QUOTE_CHAR;\n   for (let i = 0; i < value.length; i++) {\n     const char = value[i];\n@@ -50,16 +50,13 @@ export function compile(value: string, displayName = \"template\") {\n   }\n   result += QUOTE_CHAR;\n \n-  return `function ${displayName}(${INPUT_VAR_NAME}) { return ${result}; }`;\n+  return `function (${INPUT_VAR_NAME}) { return ${result}; }`;\n }\n \n /**\n  * Fast and simple string templates.\n  */\n-export function template<T extends object = object>(\n-  value: string,\n-  displayName?: string\n-) {\n-  const body = compile(value, displayName);\n+export function template<T extends object = object>(value: string) {\n+  const body = compile(value);\n   return new Function(`return (${body});`)() as Template<T>;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "22f70c7c3efd00424d861f390c02672b72d37f9b",
            "date": "2024-09-03T03:30:18Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "6bacc205f0b25b8d06a5dfe74f6f513db8e2f4a9",
            "date": "2024-09-03T02:28:54Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "98a3e1dc8a332d46e35b916c9bd4dde80c803baf",
            "date": "2024-09-03T02:26:21Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "9b7922c80cecbd18d33dc94af4984f30371f161b",
            "date": "2024-09-03T02:22:38Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "460d3ec9b8b63cc6a6cf82ad2436b216afefeff5",
            "date": "2024-09-02T23:48:01Z",
            "author_login": "blakeembrey"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-94",
    "description": "@blakeembrey/template is a string template library. Prior to version 1.2.0, it is possible to inject and run code within the template if the attacker has access to write the template name. Version 1.2.0 contains a patch. As a workaround, don't pass untrusted input as the template display name, or don't use the display name feature.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-03T20:15:08.423",
    "last_modified": "2024-09-12T20:15:15.673",
    "fix_date": "2024-09-02T23:43:41Z"
  },
  "references": [
    {
      "url": "https://github.com/blakeembrey/js-template/commit/b8d9aa999e464816c6cfb14acd1ad0f5d1e335aa",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/blakeembrey/js-template/security/advisories/GHSA-q765-wm9j-66qj",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.453499",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "js-template",
    "owner": "blakeembrey",
    "created_at": "2019-02-17T02:43:48Z",
    "updated_at": "2024-09-03T19:49:56Z",
    "pushed_at": "2024-09-03T03:30:31Z",
    "size": 384,
    "stars": 5,
    "forks": 0,
    "open_issues": 0,
    "watchers": 5,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 4635
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T21:30:11.009843"
  }
}