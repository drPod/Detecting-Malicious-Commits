{
  "cve_id": "CVE-2024-45592",
  "github_data": {
    "repository": "DamienHarper/auditor-bundle",
    "fix_commit": "42ba2940d8b99467de0c806ea5655cc1c6882cd1",
    "related_commits": [
      "42ba2940d8b99467de0c806ea5655cc1c6882cd1",
      "e7deb377fa89677d44973b486d26d6a7374233ae"
    ],
    "patch_url": "https://github.com/DamienHarper/auditor-bundle/commit/42ba2940d8b99467de0c806ea5655cc1c6882cd1.patch",
    "fix_commit_details": {
      "sha": "42ba2940d8b99467de0c806ea5655cc1c6882cd1",
      "commit_date": "2024-09-10T08:15:00Z",
      "author": {
        "login": "fkropfhamer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 12,
        "additions": 6,
        "deletions": 6
      },
      "files": [
        {
          "filename": "src/Resources/views/Audit/helpers/helper.html.twig",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -65,12 +65,12 @@\n \n     {{ ('audit.audit_details.summary.' ~ action)|trans({\n         '%source_link%': path('dh_auditor_show_entity_history', { 'entity': helper.namespaceToParam(entity), 'id': entry.getObjectId() }),\n-        '%source%': source_subject,\n-        '%source_label%': source_label,\n-        '%target_link%': target_link,\n-        '%target%': target_subject,\n-        '%target_label%': target_label,\n-        '%user%': entry.getUsername() is null ? 'audit.audit_details.summary.unkown_user'|trans(domain='auditor') : entry.getUsername(),\n+        '%source%': source_subject|escape,\n+        '%source_label%': source_label|escape,\n+        '%target_link%': target_link|escape,\n+        '%target%': target_subject|escape,\n+        '%target_label%': target_label|escape,\n+        '%user%': entry.getUsername() is null ? 'audit.audit_details.summary.unkown_user'|trans(domain='auditor') : entry.getUsername()|escape,\n         '%ip%': entry.getIp() is not empty ? ', IP: ' ~ entry.getIp() : '',\n     }, domain='auditor')|raw }}\n {% endmacro %}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "96c8bfac231b03530886c05bcca95743c1f615f9",
            "date": "2024-12-28T09:32:33Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "5e4befe43225108ec0cf042336ebd3e7135fe771",
            "date": "2024-12-10T08:07:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "4aba70c3981fc816ca9eae5cef667752239a5a1d",
            "date": "2024-12-10T07:57:39Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "95bbcfccc5c27edb677d39722228ba447ea4932a",
            "date": "2024-12-10T07:54:09Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "1019e4760a6c8629c9e2bb9a5497fcad0c93be34",
            "date": "2024-11-18T11:12:00Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.2,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "auditor-bundle, formerly known as DoctrineAuditBundle, integrates auditor library into any Symfony 3.4+ application. Prior to version 5.2.6, there is an unescaped entity property enabling Javascript injection. This is possible because `%source_label%` in twig macro is not escaped. Therefore script tags can be inserted and are executed. The vulnerability is fixed in versions 6.0.0 and 5.2.6.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-10T16:15:21.550",
    "last_modified": "2024-09-20T19:57:05.323",
    "fix_date": "2024-09-10T08:15:00Z"
  },
  "references": [
    {
      "url": "https://github.com/DamienHarper/auditor-bundle/commit/42ba2940d8b99467de0c806ea5655cc1c6882cd1",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/DamienHarper/auditor-bundle/commit/e7deb377fa89677d44973b486d26d6a7374233ae",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/DamienHarper/auditor-bundle/security/advisories/GHSA-78vg-7v27-hj67",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:00.111460",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "auditor-bundle",
    "owner": "DamienHarper",
    "created_at": "2018-01-12T14:29:02Z",
    "updated_at": "2025-01-13T12:06:13Z",
    "pushed_at": "2024-12-28T09:32:35Z",
    "size": 1696,
    "stars": 408,
    "forks": 122,
    "open_issues": 35,
    "watchers": 408,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.x",
      "2.x",
      "3.x",
      "4.x",
      "5.x",
      "master"
    ],
    "languages": {
      "PHP": 83049,
      "Twig": 82297,
      "Makefile": 4189,
      "JavaScript": 1843,
      "CSS": 487,
      "Dockerfile": 474
    },
    "commit_activity": {
      "total_commits_last_year": 49,
      "avg_commits_per_week": 0.9423076923076923,
      "days_active_last_year": 21
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:00:27.806654"
  }
}