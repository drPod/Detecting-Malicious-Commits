{
  "cve_id": "CVE-2024-45596",
  "github_data": {
    "repository": "directus/directus",
    "fix_commit": "4aace0bbe57232e38cd6a287ee475293e46dc91b",
    "related_commits": [
      "4aace0bbe57232e38cd6a287ee475293e46dc91b",
      "769fa22797bff5a9231599883b391e013f122e52"
    ],
    "patch_url": "https://github.com/directus/directus/commit/4aace0bbe57232e38cd6a287ee475293e46dc91b.patch",
    "fix_commit_details": {
      "sha": "4aace0bbe57232e38cd6a287ee475293e46dc91b",
      "commit_date": "2024-08-30T15:06:00Z",
      "author": {
        "login": "rijkvanzanten",
        "type": "User",
        "stats": {
          "total_commits": 6880,
          "average_weekly_commits": 26.563706563706564,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 246
        }
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 81,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 6,
        "deletions": 0
      },
      "files": [
        {
          "filename": ".changeset/orange-suns-fry.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+'@directus/api': patch\n+---\n+\n+Fixed an issue that could cause the response cache to misbehave"
        },
        {
          "filename": "api/src/middleware/respond.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -27,6 +27,7 @@ export const respond: RequestHandler = asyncHandler(async (req, res) => {\n \n \tif (\n \t\t(req.method.toLowerCase() === 'get' || req.originalUrl?.startsWith('/graphql')) &&\n+\t\treq.originalUrl?.startsWith('/auth') === false &&\n \t\tenv['CACHE_ENABLED'] === true &&\n \t\tcache &&\n \t\t!req.sanitizedQuery.export &&"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3d6f6b5a84cddcfff8bc77fd17b66622732f6847",
            "date": "2025-01-14T14:24:03Z",
            "author_login": "ComfortablyCoding"
          },
          {
            "sha": "95687907fe6abdc2102fece5c9a0c4f637a48cda",
            "date": "2025-01-13T18:35:02Z",
            "author_login": "Dominic-Marcelino"
          },
          {
            "sha": "f6e54ecfc937f519d8cdf44cf10d110c5bbb14d1",
            "date": "2025-01-13T15:24:41Z",
            "author_login": "joselcvarela"
          },
          {
            "sha": "c2b35c42341ec304a83d7175360141e654a50912",
            "date": "2025-01-13T14:33:43Z",
            "author_login": "connorwinston"
          },
          {
            "sha": "2560b86e5fb76e11a645f0b1bf70803a5ead56a7",
            "date": "2025-01-13T12:07:30Z",
            "author_login": "paescuj"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-524",
    "description": "Directus is a real-time API and App dashboard for managing SQL database content. An unauthenticated user can access credentials of last authenticated user via OpenID or OAuth2 where the authentication URL did not include redirect query string. This happens because on that endpoint for both OpenId and Oauth2 Directus is using the respond middleware, which by default will try to cache GET requests that met some conditions. Although, those conditions do not include this scenario, when an unauthenticated request returns user credentials. This vulnerability is fixed in 10.13.3 and 11.1.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-10T19:15:22.303",
    "last_modified": "2024-09-11T16:26:11.920",
    "fix_date": "2024-08-30T15:06:00Z"
  },
  "references": [
    {
      "url": "https://github.com/directus/directus/commit/4aace0bbe57232e38cd6a287ee475293e46dc91b",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/directus/directus/commit/769fa22797bff5a9231599883b391e013f122e52",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/directus/directus/security/advisories/GHSA-cff8-x7jv-4fm8",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:00.113063",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "directus",
    "owner": "directus",
    "created_at": "2012-12-12T01:35:36Z",
    "updated_at": "2025-01-14T12:22:36Z",
    "pushed_at": "2025-01-14T01:57:44Z",
    "size": 402534,
    "stars": 28706,
    "forks": 4004,
    "open_issues": 560,
    "watchers": 28706,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 5077921,
      "Vue": 1872125,
      "SCSS": 55791,
      "Liquid": 28677,
      "CSS": 28575,
      "JavaScript": 26426,
      "Dockerfile": 1905,
      "HTML": 1189
    },
    "commit_activity": {
      "total_commits_last_year": 1775,
      "avg_commits_per_week": 34.13461538461539,
      "days_active_last_year": 258
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T14:01:10.212039"
  }
}