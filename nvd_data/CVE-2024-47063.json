{
  "cve_id": "CVE-2024-47063",
  "github_data": {
    "repository": "cvat-ai/cvat",
    "fix_commit": "75c3d573bc9468b718f53b442c2ef69ad1d5de12",
    "related_commits": [
      "75c3d573bc9468b718f53b442c2ef69ad1d5de12"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "75c3d573bc9468b718f53b442c2ef69ad1d5de12",
      "commit_date": "2024-09-20T12:57:15Z",
      "author": {
        "login": "SpecLad",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 304,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 6,
        "additions": 5,
        "deletions": 1
      },
      "files": [
        {
          "filename": "changelog.d/20240916_144227_roman_xss_quality_report.md",
          "status": "added",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -0,0 +1,4 @@\n+### Security\n+\n+- Fixed an XSS vulnerability in the quality report data endpoint\n+  (<https://github.com/cvat-ai/cvat/security/advisories/GHSA-2c85-39cc-2px9>)"
        },
        {
          "filename": "cvat/apps/quality_control/views.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -329,7 +329,7 @@ def create(self, request, *args, **kwargs):\n     def data(self, request, pk):\n         report = self.get_object()  # check permissions\n         json_report = qc.prepare_report_for_downloading(report, host=get_server_url(request))\n-        return HttpResponse(json_report.encode())\n+        return HttpResponse(json_report.encode(), content_type=\"application/json\")\n \n \n @extend_schema(tags=[\"quality\"])"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "d9e9860a2377ef7b40b43dee4ac515ad113098b0",
            "date": "2025-01-24T11:45:19Z",
            "author_login": "klakhov"
          },
          {
            "sha": "eb2fe0498ad8ca8ead93ddff1fb895683e705a76",
            "date": "2025-01-24T08:09:11Z",
            "author_login": "bsekachev"
          },
          {
            "sha": "d8ce29d410c0934b855cbc73d38e929a7cb4911b",
            "date": "2025-01-24T08:08:49Z",
            "author_login": "bsekachev"
          },
          {
            "sha": "4191be33f76f60cbebe09b6b484c95c1528339be",
            "date": "2025-01-23T16:32:01Z",
            "author_login": "archibald1418"
          },
          {
            "sha": "9b0efb113add85d042b1592548d5de25c64ab620",
            "date": "2025-01-23T16:17:06Z",
            "author_login": "sei-jmattson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Computer Vision Annotation Tool (CVAT) is an interactive video and image annotation tool for computer vision. If a malicious CVAT user with permissions to either create a task, or edit an existing task can trick another logged-in user into visiting a maliciously-constructed URL, they can initiate any API calls on that user's behalf. This gives the attacker temporary access to all data that the victim user has access to. Upgrade to CVAT 2.19.0 or a later version to fix this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-30T15:15:06.293",
    "last_modified": "2024-10-30T18:24:21.000",
    "fix_date": "2024-09-20T12:57:15Z"
  },
  "references": [
    {
      "url": "https://github.com/cvat-ai/cvat/commit/75c3d573bc9468b718f53b442c2ef69ad1d5de12",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cvat-ai/cvat/security/advisories/GHSA-2c85-39cc-2px9",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.096022",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "cvat",
    "owner": "cvat-ai",
    "created_at": "2018-06-29T14:02:45Z",
    "updated_at": "2025-01-26T07:50:50Z",
    "pushed_at": "2025-01-24T18:19:54Z",
    "size": 329360,
    "stars": 13064,
    "forks": 3104,
    "open_issues": 566,
    "watchers": 13064,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "hotfix-2.4.1",
      "hotfix-2.4.7",
      "master"
    ],
    "languages": {
      "Python": 3871987,
      "TypeScript": 3671604,
      "JavaScript": 975093,
      "Mustache": 205368,
      "SCSS": 144615,
      "Open Policy Agent": 75701,
      "HTML": 39207,
      "Dockerfile": 11104,
      "Shell": 8293,
      "Smarty": 4858,
      "Jinja": 138
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-26T08:00:17.492234"
  }
}