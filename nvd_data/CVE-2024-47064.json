{
  "cve_id": "CVE-2024-47064",
  "github_data": {
    "repository": "cvat-ai/cvat",
    "fix_commit": "0bf45fd5de08a652dffbfb517318a64c2fdbc5cf",
    "related_commits": [
      "0bf45fd5de08a652dffbfb517318a64c2fdbc5cf"
    ],
    "patch_url": "https://github.com/cvat-ai/cvat/commit/0bf45fd5de08a652dffbfb517318a64c2fdbc5cf.patch",
    "fix_commit_details": {
      "sha": "0bf45fd5de08a652dffbfb517318a64c2fdbc5cf",
      "commit_date": "2024-09-20T12:56:18Z",
      "author": {
        "login": "SpecLad",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 771,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "changelog.d/20240912_201524_roman_xss_requests.md",
          "status": "added",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -0,0 +1,4 @@\n+### Security\n+\n+- Fixed an XSS vulnerability in request-related endpoints\n+  (<https://github.com/cvat-ai/cvat/security/advisories/GHSA-hp6c-f34j-qjj7>)"
        },
        {
          "filename": "cvat/apps/engine/views.py",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -3391,7 +3391,7 @@ def retrieve(self, request: HttpRequest, pk: str):\n         job = self._get_rq_job_by_id(pk)\n \n         if not job:\n-            return HttpResponseNotFound(f\"There is no request with specified id: {pk}\")\n+            return HttpResponseNotFound(\"There is no request with specified id\")\n \n         self.check_object_permissions(request, job)\n \n@@ -3428,7 +3428,7 @@ def cancel(self, request: HttpRequest, pk: str):\n         rq_job = self._get_rq_job_by_id(pk)\n \n         if not rq_job:\n-            return HttpResponseNotFound(f\"There is no request with specified id: {pk!r}\")\n+            return HttpResponseNotFound(\"There is no request with specified id\")\n \n         self.check_object_permissions(request, rq_job)\n "
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e276295dec449ad965e34808e4bad9ce5ba249d9",
            "date": "2025-01-14T16:47:01Z",
            "author_login": "Marishka17"
          },
          {
            "sha": "a7018633fff9468c2e1823d41c02f3f37053023f",
            "date": "2025-01-14T16:12:08Z",
            "author_login": "SpecLad"
          },
          {
            "sha": "b63f68a88647963b3be460f14c196e901ea1c13e",
            "date": "2025-01-14T13:32:05Z",
            "author_login": "Eldies"
          },
          {
            "sha": "13fd5a7c590dfac1bf7b0e5c3ec291940ebc6380",
            "date": "2025-01-13T18:23:02Z",
            "author_login": "klakhov"
          },
          {
            "sha": "42bc3452bb6b77008f49d306efd8d32cfa2b5b2a",
            "date": "2025-01-13T15:55:58Z",
            "author_login": "SpecLad"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "Computer Vision Annotation Tool (CVAT) is an interactive video and image annotation tool for computer vision. If an attacker can trick a logged-in CVAT user into visiting a maliciously-constructed URL, they can initiate any API calls on that user's behalf. This gives the attacker temporary access to all data that the victim user has access to. Upgrade to CVAT 2.19.0 or a later version to fix this issue.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-30T15:15:06.413",
    "last_modified": "2024-10-30T18:23:17.020",
    "fix_date": "2024-09-20T12:56:18Z"
  },
  "references": [
    {
      "url": "https://github.com/cvat-ai/cvat/commit/0bf45fd5de08a652dffbfb517318a64c2fdbc5cf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/cvat-ai/cvat/security/advisories/GHSA-hp6c-f34j-qjj7",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.096230",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cvat",
    "owner": "cvat-ai",
    "created_at": "2018-06-29T14:02:45Z",
    "updated_at": "2025-01-14T13:32:13Z",
    "pushed_at": "2025-01-14T15:11:25Z",
    "size": 328727,
    "stars": 12953,
    "forks": 3081,
    "open_issues": 570,
    "watchers": 12953,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop",
      "hotfix-2.4.1",
      "hotfix-2.4.7"
    ],
    "languages": {
      "Python": 3863013,
      "TypeScript": 3665803,
      "JavaScript": 1195931,
      "Mustache": 205368,
      "SCSS": 144217,
      "Open Policy Agent": 75701,
      "HTML": 39212,
      "Dockerfile": 11104,
      "Shell": 8504,
      "Smarty": 4858,
      "Jinja": 138
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:26:05.726176"
  }
}