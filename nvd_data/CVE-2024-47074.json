{
  "cve_id": "CVE-2024-47074",
  "github_data": {
    "repository": "dataease/dataease",
    "fix_commit": "86eafc4d77f0bbc0eaa7fc58e5076a085257f259",
    "related_commits": [
      "86eafc4d77f0bbc0eaa7fc58e5076a085257f259"
    ],
    "patch_url": "https://github.com/dataease/dataease/commit/86eafc4d77f0bbc0eaa7fc58e5076a085257f259.patch",
    "fix_commit_details": {
      "sha": "86eafc4d77f0bbc0eaa7fc58e5076a085257f259",
      "commit_date": "2024-10-08T10:47:57Z",
      "author": {
        "login": "jinlong-T",
        "type": "User",
        "stats": {
          "total_commits": 1988,
          "average_weekly_commits": 2.5784695201037615,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 166
        }
      },
      "commit_message": {
        "title": "fix:  pg jdbc \u6821\u9a8c\u975e\u6cd5\u5b57\u7b26",
        "length": 20,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 11,
        "deletions": 0
      },
      "files": [
        {
          "filename": "core/backend/src/main/java/io/dataease/dto/datasource/PgConfiguration.java",
          "status": "modified",
          "additions": 11,
          "deletions": 0,
          "patch": "@@ -5,12 +5,18 @@\n import lombok.Setter;\n import org.apache.commons.lang3.StringUtils;\n \n+import java.net.URLDecoder;\n+import java.util.Arrays;\n+import java.util.List;\n+\n @Getter\n @Setter\n public class PgConfiguration extends JdbcConfiguration {\n \n     private String driver = \"org.postgresql.Driver\";\n     private String extraParams = \"\";\n+    private List<String> illegalParameters = Arrays.asList(\"socketFactory\", \"socketFactoryArg\", \"sslfactory\", \"sslfactoryarg\", \"loggerLevel\", \"loggerFile\", \"allowUrlInLocalInfile\", \"allowLoadLocalInfileInPath\");\n+\n \n     public String getJdbc() {\n         if (StringUtils.isEmpty(extraParams.trim())) {\n@@ -27,6 +33,11 @@ public String getJdbc() {\n                         .replace(\"SCHEMA\", getSchema().trim());\n             }\n         } else {\n+            for (String illegalParameter : illegalParameters) {\n+                if (getExtraParams().toLowerCase().contains(illegalParameter.toLowerCase()) || URLDecoder.decode(getExtraParams()).contains(illegalParameter.toLowerCase())) {\n+                    throw new RuntimeException(\"Illegal parameter: \" + illegalParameter);\n+                }\n+            }\n             return \"jdbc:postgresql://HOSTNAME:PORT/DATABASE?EXTRA_PARAMS\"\n                     .replace(\"HOSTNAME\", getHost().trim())\n                     .replace(\"PORT\", getPort().toString().trim())"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 9
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3d7dcc9e7523ab298dc57ba412989f659794c3e4",
            "date": "2025-01-14T10:19:36Z",
            "author_login": "dataeaseShu"
          },
          {
            "sha": "e6c5f45bb7e044fedbe2aa03daf01f3c330e73f5",
            "date": "2025-01-14T09:55:57Z",
            "author_login": "ulleo"
          },
          {
            "sha": "8a25535ecafdbca3d1d966ebffbee228a495d2cd",
            "date": "2025-01-14T09:50:53Z",
            "author_login": "dataeaseShu"
          },
          {
            "sha": "bb7be5c912c59408fcbc4c675d9db42e20d9e355",
            "date": "2025-01-14T09:50:29Z",
            "author_login": "dataeaseShu"
          },
          {
            "sha": "60b0f9c124f9d2fe13e2457f38dff16e7b4525b4",
            "date": "2025-01-14T09:18:10Z",
            "author_login": "ulleo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-502",
    "description": "DataEase is an open source data visualization analysis tool. In Dataease, the PostgreSQL data source in the data source function can customize the JDBC connection parameters and the PG server target to be connected. In backend/src/main/java/io/dataease/provider/datasource/JdbcProvider.java, PgConfiguration class don't filter any parameters, directly concat user input. So, if the attacker adds some parameters in JDBC url, and connect to evil PG server, the attacker can trigger the PG jdbc deserialization vulnerability, and eventually the attacker can execute through the deserialization vulnerability system commands and obtain server privileges. The vulnerability has been fixed in v1.18.25.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-11T15:15:05.353",
    "last_modified": "2024-11-12T19:52:38.023",
    "fix_date": "2024-10-08T10:47:57Z"
  },
  "references": [
    {
      "url": "https://github.com/dataease/dataease/commit/86eafc4d77f0bbc0eaa7fc58e5076a085257f259",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/dataease/dataease/security/advisories/GHSA-jgg7-w629-wcpc",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.133339",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "dataease",
    "owner": "dataease",
    "created_at": "2021-02-02T04:10:21Z",
    "updated_at": "2025-01-14T14:38:02Z",
    "pushed_at": "2025-01-14T11:00:19Z",
    "size": 298499,
    "stars": 18879,
    "forks": 3405,
    "open_issues": 388,
    "watchers": 18879,
    "has_security_policy": false,
    "default_branch": "dev-v2",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "Java": 15120013,
      "Vue": 3999652,
      "Shell": 26817,
      "Lua": 22086,
      "Less": 12316,
      "Dockerfile": 952
    },
    "commit_activity": {
      "total_commits_last_year": 7385,
      "avg_commits_per_week": 142.01923076923077,
      "days_active_last_year": 278
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:09:59.807295"
  }
}