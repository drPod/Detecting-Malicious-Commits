{
  "cve_id": "CVE-2024-47171",
  "github_data": {
    "repository": "agnaistic/agnai",
    "fix_commit": null,
    "related_commits": [],
    "patch_url": null
  },
  "vulnerability_details": {
    "cvss_score": 4.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-35",
    "description": "Agnai is an artificial-intelligence-agnostic multi-user, mult-bot roleplaying chat system. A vulnerability in versions prior to 1.0.330 permits attackers to upload image files at attacker-chosen location on the server. This issue can lead to image file uploads to unauthorized or unintended directories, including overwriting of existing images which may be used for defacement. This does not affect `agnai.chat`, installations using S3-compatible storage, or self-hosting that is not publicly exposed. Version 1.0.330 fixes this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-26T18:15:10.590",
    "last_modified": "2024-10-30T20:46:24.610",
    "fix_date": null
  },
  "references": [
    {
      "url": "https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/character.ts#L140:",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/agnaistic/agnai/blob/75abbd5b0f5e48ddecc805365cf1574d05ee1ce5/srv/api/upload.ts#L55",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/agnaistic/agnai/security/advisories/GHSA-g54f-66mw-hv66",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:00.157341",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "agnai",
    "owner": "agnaistic",
    "created_at": "2023-03-05T03:26:17Z",
    "updated_at": "2025-01-13T08:07:51Z",
    "pushed_at": "2025-01-07T04:14:32Z",
    "size": 36566,
    "stars": 556,
    "forks": 106,
    "open_issues": 103,
    "watchers": 556,
    "has_security_policy": false,
    "default_branch": "dev",
    "protected_branches": [
      "dev"
    ],
    "languages": {
      "TypeScript": 2407355,
      "CSS": 54755,
      "JavaScript": 44679,
      "Python": 6326,
      "HTML": 2221,
      "SCSS": 1698,
      "Dockerfile": 1079
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T17:34:52.927764"
  }
}