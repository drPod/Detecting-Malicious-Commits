{
  "cve_id": "CVE-2024-47180",
  "github_data": {
    "repository": "badges/shields",
    "fix_commit": "ec1b6c8daccda075403c1688ac02603f7aaa50b2",
    "related_commits": [
      "ec1b6c8daccda075403c1688ac02603f7aaa50b2"
    ],
    "patch_url": "https://github.com/badges/shields/commit/ec1b6c8daccda075403c1688ac02603f7aaa50b2.patch",
    "fix_commit_details": {
      "sha": "ec1b6c8daccda075403c1688ac02603f7aaa50b2",
      "commit_date": "2024-09-25T16:16:04Z",
      "author": {
        "login": "chris48s",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "[dynamicjson dynamicyaml dynamictoml] switch to jsonpath-plus (#10551)",
        "length": 70,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 241,
        "additions": 81,
        "deletions": 160
      },
      "files": [
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 51,
          "deletions": 132,
          "patch": "@@ -35,7 +35,7 @@\n         \"joi\": \"17.13.3\",\n         \"joi-extension-semver\": \"5.0.0\",\n         \"js-yaml\": \"^4.1.0\",\n-        \"jsonpath\": \"~1.1.1\",\n+        \"jsonpath-plus\": \"^9.0.0\",\n         \"lodash.countby\": \"^4.6.0\",\n         \"lodash.groupby\": \"^4.6.0\",\n         \"lodash.times\": \"^4.3.2\",\n@@ -3957,6 +3957,28 @@\n         \"node\": \">=v12.0.0\"\n       }\n     },\n+    \"node_modules/@jsep-plugin/assignment\": {\n+      \"version\": \"1.2.1\",\n+      \"resolved\": \"https://registry.npmjs.org/@jsep-plugin/assignment/-/assignment-1.2.1.tgz\",\n+      \"integrity\": \"sha512-gaHqbubTi29aZpVbBlECRpmdia+L5/lh2BwtIJTmtxdbecEyyX/ejAOg7eQDGNvGOUmPY7Z2Yxdy9ioyH/VJeA==\",\n+      \"engines\": {\n+        \"node\": \">= 10.16.0\"\n+      },\n+      \"peerDependencies\": {\n+        \"jsep\": \"^0.4.0||^1.0.0\"\n+      }\n+    },\n+    \"node_modules/@jsep-plugin/regex\": {\n+      \"version\": \"1.0.3\",\n+      \"resolved\": \"https://registry.npmjs.org/@jsep-plugin/regex/-/regex-1.0.3.tgz\",\n+      \"integrity\": \"sha512-XfZgry4DwEZvSFtS/6Y+R48D7qJYJK6R9/yJFyUFHCIUMEEHuJ4X95TDgJp5QkmzfLYvapMPzskV5HpIDrREug==\",\n+      \"engines\": {\n+        \"node\": \">= 10.16.0\"\n+      },\n+      \"peerDependencies\": {\n+        \"jsep\": \"^0.4.0||^1.0.0\"\n+      }\n+    },\n     \"node_modules/@leichtgewicht/ip-codec\": {\n       \"version\": \"2.0.4\",\n       \"resolved\": \"https://registry.npmjs.org/@leichtgewicht/ip-codec/-/ip-codec-2.0.4.tgz\",\n@@ -10233,7 +10255,8 @@\n     \"node_modules/deep-is\": {\n       \"version\": \"0.1.4\",\n       \"resolved\": \"https://registry.npmjs.org/deep-is/-/deep-is-0.1.4.tgz\",\n-      \"integrity\": \"sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==\"\n+      \"integrity\": \"sha512-oIPzksmTg4/MriiaYGO+okXDT7ztn/w3Eptv/+gSIdMdKsJo0u4CfYNFJPy+4SKMuCqGw2wxnA+URMg3t8a/bQ==\",\n+      \"dev\": true\n     },\n     \"node_modules/deepmerge\": {\n       \"version\": \"4.3.1\",\n@@ -11501,94 +11524,6 @@\n         \"url\": \"https://github.com/sponsors/sindresorhus\"\n       }\n     },\n-    \"node_modules/escodegen\": {\n-      \"version\": \"1.14.3\",\n-      \"resolved\": \"https://registry.npmjs.org/escodegen/-/escodegen-1.14.3.tgz\",\n-      \"integrity\": \"sha512-qFcX0XJkdg+PB3xjZZG/wKSuT1PnQWx57+TVSjIMmILd2yC/6ByYElPwJnslDsuWuSAp4AwJGumarAAmJch5Kw==\",\n-      \"dependencies\": {\n-        \"esprima\": \"^4.0.1\",\n-        \"estraverse\": \"^4.2.0\",\n-        \"esutils\": \"^2.0.2\",\n-        \"optionator\": \"^0.8.1\"\n-      },\n-      \"bin\": {\n-        \"escodegen\": \"bin/escodegen.js\",\n-        \"esgenerate\": \"bin/esgenerate.js\"\n-      },\n-      \"engines\": {\n-        \"node\": \">=4.0\"\n-      },\n-      \"optionalDependencies\": {\n-        \"source-map\": \"~0.6.1\"\n-      }\n-    },\n-    \"node_modules/escodegen/node_modules/esprima\": {\n-      \"version\": \"4.0.1\",\n-      \"resolved\": \"https://registry.npmjs.org/esprima/-/esprima-4.0.1.tgz\",\n-      \"integrity\": \"sha512-eGuFFw7Upda+g4p+QHvnW0RyTX/SVeJBDM/gCtMARO0cLuT2HcEKnTPvhjV6aGeqrCB/sbNop0Kszm0jsaWU4A==\",\n-      \"bin\": {\n-        \"esparse\": \"bin/esparse.js\",\n-        \"esvalidate\": \"bin/esvalidate.js\"\n-      },\n-      \"engines\": {\n-        \"node\": \">=4\"\n-      }\n-    },\n-    \"node_modules/escodegen/node_modules/estraverse\": {\n-      \"version\": \"4.3.0\",\n-      \"resolved\": \"https://registry.npmjs.org/estraverse/-/estraverse-4.3.0.tgz\",\n-      \"integrity\": \"sha512-39nnKffWz8xN1BU/2c79n9nB9HDzo0niYUqx6xyqUnyoAnQyyWpOTdZEeiCch8BBu515t4wp9ZmgVfVhn9EBpw==\",\n-      \"engines\": {\n-        \"node\": \">=4.0\"\n-      }\n-    },\n-    \"node_modules/escodegen/node_modules/levn\": {\n-      \"version\": \"0.3.0\",\n-      \"resolved\": \"https://registry.npmjs.org/levn/-/levn-0.3.0.tgz\",\n-      \"integrity\": \"sha512-0OO4y2iOHix2W6ujICbKIaEQXvFQHue65vUG3pb5EUomzPI90z9hsA1VsO/dbIIpC53J8gxM9Q4Oho0jrCM/yA==\",\n-      \"dependencies\": {\n-        \"prelude-ls\": \"~1.1.2\",\n-        \"type-check\": \"~0.3.2\"\n-      },\n-      \"engines\": {\n-        \"node\": \">= 0.8.0\"\n-      }\n-    },\n-    \"node_modules/escodegen/node_modules/optionator\": {\n-      \"version\": \"0.8.3\",\n-      \"resolved\": \"https://registry.npmjs.org/optionator/-/optionator-0.8.3.tgz\",\n-      \"integrity\": \"sha512-+IW9pACdk3XWmmTXG8m3upGUJst5XRGzxMRjXzAuJ1XnIFNvfhjjIuYkDvysnPQ7qzqVzLt78BCruntqRhWQbA==\",\n-      \"dependencies\": {\n-        \"deep-is\": \"~0.1.3\",\n-        \"fast-levenshtein\": \"~2.0.6\",\n-        \"levn\": \"~0.3.0\",\n-        \"prelude-ls\": \"~1.1.2\",\n-        \"type-check\": \"~0.3.2\",\n-        \"word-wrap\": \"~1.2.3\"\n-      },\n-      \"engines\": {\n-        \"node\": \">= 0.8.0\"\n-      }\n-    },\n-    \"node_modules/escodegen/node_modules/prelude-ls\": {\n-      \"version\": \"1.1.2\",\n-      \"resolved\": \"https://registry.npmjs.org/prelude-ls/-/prelude-ls-1.1.2.tgz\",\n-      \"integrity\": \"sha512-ESF23V4SKG6lVSGZgYNpbsiaAkdab6ZgOxe52p7+Kid3W3u3bxR4Vfd/o21dmN7jSt0IwgZ4v5MUd26FEtXE9w==\",\n-      \"engines\": {\n-        \"node\": \">= 0.8.0\"\n-      }\n-    },\n-    \"node_modules/escodegen/node_modules/type-check\": {\n-      \"version\": \"0.3.2\",\n-      \"resolved\": \"https://registry.npmjs.org/type-check/-/type-check-0.3.2.tgz\",\n-      \"integrity\": \"sha512-ZCmOJdvOWDBYJlzAoFkC+Q0+bUyEOS1ltgp1MGU03fqHG+dbi9tBFU2Rd9QKiDZFAYrhPh2JUf7rZRIuHRKtOg==\",\n-      \"dependencies\": {\n-        \"prelude-ls\": \"~1.1.2\"\n-      },\n-      \"engines\": {\n-        \"node\": \">= 0.8.0\"\n-      }\n-    },\n     \"node_modules/eslint\": {\n       \"version\": \"8.57.1\",\n       \"resolved\": \"https://registry.npmjs.org/eslint/-/eslint-8.57.1.tgz\",\n@@ -12623,18 +12558,6 @@\n         \"url\": \"https://opencollective.com/eslint\"\n       }\n     },\n-    \"node_modules/esprima\": {\n-      \"version\": \"1.2.2\",\n-      \"resolved\": \"https://registry.npmjs.org/esprima/-/esprima-1.2.2.tgz\",\n-      \"integrity\": \"sha512-+JpPZam9w5DuJ3Q67SqsMGtiHKENSMRVoxvArfJZK01/BfLEObtZ6orJa/MtoGNR/rfMgp5837T41PAmTwAv/A==\",\n-      \"bin\": {\n-        \"esparse\": \"bin/esparse.js\",\n-        \"esvalidate\": \"bin/esvalidate.js\"\n-      },\n-      \"engines\": {\n-        \"node\": \">=0.4.0\"\n-      }\n-    },\n     \"node_modules/esquery\": {\n       \"version\": \"1.6.0\",\n       \"resolved\": \"https://registry.npmjs.org/esquery/-/esquery-1.6.0.tgz\",\n@@ -12786,6 +12709,7 @@\n       \"version\": \"2.0.3\",\n       \"resolved\": \"https://registry.npmjs.org/esutils/-/esutils-2.0.3.tgz\",\n       \"integrity\": \"sha512-kVscqXk4OCp68SZ0dkgEKVi6/8ij300KBWTJq32P/dYeWTSwK41WyTxalN1eRmA5Z9UU/LX9D7FWSmV9SAYx6g==\",\n+      \"dev\": true,\n       \"engines\": {\n         \"node\": \">=0.10.0\"\n       }\n@@ -13107,7 +13031,8 @@\n     \"node_modules/fast-levenshtein\": {\n       \"version\": \"2.0.6\",\n       \"resolved\": \"https://registry.npmjs.org/fast-levenshtein/-/fast-levenshtein-2.0.6.tgz\",\n-      \"integrity\": \"sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==\"\n+      \"integrity\": \"sha512-DCXu6Ifhqcks7TZKY3Hxp3y6qphY5SJZmrWMDrKcERSOXWQdMhU9Ig/PYrzyw/ul9jOIyh0N4M0tbC5hodg8dw==\",\n+      \"dev\": true\n     },\n     \"node_modules/fast-safe-stringify\": {\n       \"version\": \"2.1.1\",\n@@ -16680,6 +16605,14 @@\n         \"node\": \">=8\"\n       }\n     },\n+    \"node_modules/jsep\": {\n+      \"version\": \"1.3.9\",\n+      \"resolved\": \"https://registry.npmjs.org/jsep/-/jsep-1.3.9.tgz\",\n+      \"integrity\": \"sha512-i1rBX5N7VPl0eYb6+mHNp52sEuaS2Wi8CDYx1X5sn9naevL78+265XJqy1qENEk7mRKwS06NHpUqiBwR7qeodw==\",\n+      \"engines\": {\n+        \"node\": \">= 10.16.0\"\n+      }\n+    },\n     \"node_modules/jsesc\": {\n       \"version\": \"2.5.2\",\n       \"resolved\": \"https://registry.npmjs.org/jsesc/-/jsesc-2.5.2.tgz\",\n@@ -16849,21 +16782,23 @@\n         \"graceful-fs\": \"^4.1.6\"\n       }\n     },\n-    \"node_modules/jsonpath\": {\n-      \"version\": \"1.1.1\",\n-      \"resolved\": \"https://registry.npmjs.org/jsonpath/-/jsonpath-1.1.1.tgz\",\n-      \"integrity\": \"sha512-l6Cg7jRpixfbgoWgkrl77dgEj8RPvND0wMH6TwQmi9Qs4TFfS9u5cUFnbeKTwj5ga5Y3BTGGNI28k117LJ009w==\",\n+    \"node_modules/jsonpath-plus\": {\n+      \"version\": \"9.0.0\",\n+      \"resolved\": \"https://registry.npmjs.org/jsonpath-plus/-/jsonpath-plus-9.0.0.tgz\",\n+      \"integrity\": \"sha512-bqE77VIDStrOTV/czspZhTn+o27Xx9ZJRGVkdVShEtPoqsIx5yALv3lWVU6y+PqYvWPJNWE7ORCQheQkEe0DDA==\",\n       \"dependencies\": {\n-        \"esprima\": \"1.2.2\",\n-        \"static-eval\": \"2.0.2\",\n-        \"underscore\": \"1.12.1\"\n+        \"@jsep-plugin/assignment\": \"^1.2.1\",\n+        \"@jsep-plugin/regex\": \"^1.0.3\",\n+        \"jsep\": \"^1.3.8\"\n+      },\n+      \"bin\": {\n+        \"jsonpath\": \"bin/jsonpath-cli.js\",\n+        \"jsonpath-plus\": \"bin/jsonpath-cli.js\"\n+      },\n+      \"engines\": {\n+        \"node\": \">=14.0.0\"\n       }\n     },\n-    \"node_modules/jsonpath/node_modules/underscore\": {\n-      \"version\": \"1.12.1\",\n-      \"resolved\": \"https://registry.npmjs.org/underscore/-/underscore-1.12.1.tgz\",\n-      \"integrity\": \"sha512-hEQt0+ZLDVUMhebKxL4x1BTtDY7bavVofhZ9KZ4aI26X9SRaE+Y3m83XUL1UP2jn8ynjndwCCpEHdUG+9pP1Tw==\"\n-    },\n     \"node_modules/jsonpointer\": {\n       \"version\": \"5.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/jsonpointer/-/jsonpointer-5.0.1.tgz\",\n@@ -27365,7 +27300,7 @@\n       \"version\": \"0.6.1\",\n       \"resolved\": \"https://registry.npmjs.org/source-map/-/source-map-0.6.1.tgz\",\n       \"integrity\": \"sha512-UjgapumWlbMhkBgzT7Ykc5YXUT46F0iKu8SGXq0bcwP5dz/h0Plj6enJqjz1Zbq2l5WaqYnrVbwWOWMyF3F47g==\",\n-      \"devOptional\": true,\n+      \"dev\": true,\n       \"engines\": {\n         \"node\": \">=0.10.0\"\n       }\n@@ -27658,14 +27593,6 @@\n       \"integrity\": \"sha512-HTEHMNieakEnoe33shBYcZ7NX83ACUjCu8c40iOGEZsngj9zRnkqS9j1pqQPXwobB0ZcVTk27REb7COQ0UR59w==\",\n       \"dev\": true\n     },\n-    \"node_modules/static-eval\": {\n-      \"version\": \"2.0.2\",\n-      \"resolved\": \"https://registry.npmjs.org/static-eval/-/static-eval-2.0.2.tgz\",\n-      \"integrity\": \"sha512-N/D219Hcr2bPjLxPiV+TQE++Tsmrady7TqAJugLy7Xk1EumfDWS/f5dtBbkRCGE7wKKXuYockQoj8Rm2/pVKyg==\",\n-      \"dependencies\": {\n-        \"escodegen\": \"^1.8.1\"\n-      }\n-    },\n     \"node_modules/statuses\": {\n       \"version\": \"2.0.1\",\n       \"resolved\": \"https://registry.npmjs.org/statuses/-/statuses-2.0.1.tgz\",\n@@ -30532,14 +30459,6 @@\n       \"integrity\": \"sha512-CC1bOL87PIWSBhDcTrdeLo6eGT7mCFtrg0uIJtqJUFyK+eJnzl8A1niH56uu7KMa5XFrtiV+AQuHO3n7DsHnLQ==\",\n       \"dev\": true\n     },\n-    \"node_modules/word-wrap\": {\n-      \"version\": \"1.2.5\",\n-      \"resolved\": \"https://registry.npmjs.org/word-wrap/-/word-wrap-1.2.5.tgz\",\n-      \"integrity\": \"sha512-BN22B5eaMMI9UMtjrGd5g5eCYPpCPDUy0FJXbYsaT5zYxjFOckS53SQDE3pWkVoWpHXVb3BrYcEN4Twa55B5cA==\",\n-      \"engines\": {\n-        \"node\": \">=0.10.0\"\n-      }\n-    },\n     \"node_modules/workerpool\": {\n       \"version\": \"6.5.1\",\n       \"resolved\": \"https://registry.npmjs.org/workerpool/-/workerpool-6.5.1.tgz\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -47,7 +47,7 @@\n     \"joi\": \"17.13.3\",\n     \"joi-extension-semver\": \"5.0.0\",\n     \"js-yaml\": \"^4.1.0\",\n-    \"jsonpath\": \"~1.1.1\",\n+    \"jsonpath-plus\": \"^9.0.0\",\n     \"lodash.countby\": \"^4.6.0\",\n     \"lodash.groupby\": \"^4.6.0\",\n     \"lodash.times\": \"^4.3.2\","
        },
        {
          "filename": "services/dynamic/dynamic-json.tester.js",
          "status": "modified",
          "additions": 23,
          "deletions": 8,
          "patch": "@@ -145,8 +145,8 @@ t.create('query with lexical error')\n   )\n   .expectBadge({\n     label: 'custom badge',\n-    message: 'unparseable jsonpath query',\n-    color: 'red',\n+    message: 'no result',\n+    color: 'lightgrey',\n   })\n \n t.create('query with parse error')\n@@ -155,8 +155,8 @@ t.create('query with parse error')\n   )\n   .expectBadge({\n     label: 'custom badge',\n-    message: 'unparseable jsonpath query',\n-    color: 'red',\n+    message: 'no result',\n+    color: 'lightgrey',\n   })\n \n // Example from https://stackoverflow.com/q/11670384/893113\n@@ -170,7 +170,23 @@ t.create('query with invalid token')\n   )\n   .expectBadge({\n     label: 'custom badge',\n-    message: 'unparseable jsonpath query',\n+    message: 'query not supported',\n+    color: 'red',\n+  })\n+\n+/*\n+Based on https://github.com/JSONPath-Plus/JSONPath/blob/v9.0.0/test/test.errors.js#L53-L68\n+This functionality is disabled for security reasons.\n+*/\n+t.create('query with eval filtering expression')\n+  .get(\n+    `.json?url=https://github.com/badges/shields/raw/master/package.json&query=${encodeURIComponent(\n+      '$..keywords[(@.length-1)]',\n+    )}`,\n+  )\n+  .expectBadge({\n+    label: 'custom badge',\n+    message: 'query not supported',\n     color: 'red',\n   })\n \n@@ -185,12 +201,11 @@ t.create('JSON contains an array')\n   })\n \n t.create('JSON contains a string')\n-  .get('.json?url=https://example.test/json&query=$.foo,')\n+  .get('.json?url=https://example.test/json&query=$')\n   .intercept(nock =>\n     nock('https://example.test').get('/json').reply(200, '\"foo\"'),\n   )\n   .expectBadge({\n     label: 'custom badge',\n-    message: 'resource must contain an object or array',\n-    color: 'lightgrey',\n+    message: 'foo',\n   })"
        },
        {
          "filename": "services/dynamic/dynamic-yaml.tester.js",
          "status": "modified",
          "additions": 2,
          "deletions": 3,
          "patch": "@@ -102,12 +102,11 @@ t.create('YAML from url | error color overrides user specified')\n   })\n \n t.create('YAML contains a string')\n-  .get('.json?url=https://example.test/yaml&query=$.foo,')\n+  .get('.json?url=https://example.test/yaml&query=$,')\n   .intercept(nock =>\n     nock('https://example.test').get('/yaml').reply(200, '\"foo\"'),\n   )\n   .expectBadge({\n     label: 'custom badge',\n-    message: 'resource must contain an object or array',\n-    color: 'lightgrey',\n+    message: 'foo',\n   })"
        },
        {
          "filename": "services/dynamic/json-path.js",
          "status": "modified",
          "additions": 4,
          "deletions": 16,
          "patch": "@@ -3,7 +3,7 @@\n  */\n \n import Joi from 'joi'\n-import jp from 'jsonpath'\n+import { JSONPath as jp } from 'jsonpath-plus'\n import { renderDynamicBadge, httpErrors } from '../dynamic-common.js'\n import { InvalidParameter, InvalidResponse } from '../index.js'\n \n@@ -43,26 +43,14 @@ export default superclass =>\n         httpErrors,\n       })\n \n-      // JSONPath only works on objects and arrays.\n-      // https://github.com/badges/shields/issues/4018\n-      if (typeof data !== 'object') {\n-        throw new InvalidResponse({\n-          prettyMessage: 'resource must contain an object or array',\n-        })\n-      }\n-\n       let values\n       try {\n-        values = jp.query(data, pathExpression)\n+        values = jp({ json: data, path: pathExpression, eval: false })\n       } catch (e) {\n         const { message } = e\n-        if (\n-          message.startsWith('Lexical error') ||\n-          message.startsWith('Parse error') ||\n-          message.includes('Unexpected token')\n-        ) {\n+        if (message.includes('prevented in JSONPath expression')) {\n           throw new InvalidParameter({\n-            prettyMessage: 'unparseable jsonpath query',\n+            prettyMessage: 'query not supported',\n           })\n         } else {\n           throw e"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 2,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4ba06c0ec70913d74ec966f47b192d9c027ef836",
            "date": "2025-01-13T18:30:53Z",
            "author_login": "arnaud-dezandee"
          },
          {
            "sha": "8cd1480e5fae1579826de40a88fc02a72ae1a2e0",
            "date": "2025-01-12T10:11:12Z",
            "author_login": "chris48s"
          },
          {
            "sha": "fb16e56c3f02c77e6132479d426c1b30f1ce25dd",
            "date": "2025-01-10T20:24:10Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "0d436c92d8dcb7209a47785fc6326988b3a6ca3e",
            "date": "2025-01-10T20:13:21Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "6d320eff488ecbf0e5b5a88cfd3382e153a578da",
            "date": "2025-01-10T20:01:52Z",
            "author_login": "dependabot[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-74",
    "description": "Shields.io is a service for concise, consistent, and legible badges in SVG and raster format. Shields.io and users self-hosting their own instance of shields using version < `server-2024-09-25` are vulnerable to a remote execution vulnerability via the JSONPath library used by the Dynamic JSON/Toml/Yaml badges. This vulnerability would allow any user with access to make a request to a URL on the instance to the ability to execute code by crafting a malicious JSONPath expression. All users who self-host an instance are vulnerable. This problem was fixed in server-2024-09-25. Those who follow the tagged releases should update to `server-2024-09-25` or later. Those who follow the rolling tag on DockerHub, `docker pull shieldsio/shields:next` to update to the latest version. As a workaround, blocking access to the endpoints `/badge/dynamic/json`, `/badge/dynamic/toml`, and `/badge/dynamic/yaml` (e.g: via a firewall or reverse proxy in front of your instance) would prevent the exploitable endpoints from being accessed.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-26T20:15:07.310",
    "last_modified": "2024-09-30T12:46:20.237",
    "fix_date": "2024-09-25T16:16:04Z"
  },
  "references": [
    {
      "url": "https://github.com/badges/shields/commit/ec1b6c8daccda075403c1688ac02603f7aaa50b2",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/badges/shields/issues/10553",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/badges/shields/pull/10551",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/badges/shields/security/advisories/GHSA-rxvx-x284-4445",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:00.157890",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "shields",
    "owner": "badges",
    "created_at": "2013-01-30T07:41:54Z",
    "updated_at": "2025-01-14T17:42:15Z",
    "pushed_at": "2025-01-13T18:36:41Z",
    "size": 384826,
    "stars": 24141,
    "forks": 5516,
    "open_issues": 363,
    "watchers": 24141,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "historical",
      "master"
    ],
    "languages": {
      "JavaScript": 2650242,
      "CSS": 1569,
      "Dockerfile": 891,
      "HTML": 866,
      "TypeScript": 635,
      "Procfile": 31
    },
    "commit_activity": {
      "total_commits_last_year": 640,
      "avg_commits_per_week": 12.307692307692308,
      "days_active_last_year": 144
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "cc0-1.0"
    },
    "collected_at": "2025-01-14T19:09:58.767223"
  }
}