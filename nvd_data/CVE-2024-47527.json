{
  "cve_id": "CVE-2024-47527",
  "github_data": {
    "repository": "librenms/librenms",
    "fix_commit": "36b38a50cc10d4ed16caab92bdc18ed6abac9685",
    "related_commits": [
      "36b38a50cc10d4ed16caab92bdc18ed6abac9685"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "36b38a50cc10d4ed16caab92bdc18ed6abac9685",
      "commit_date": "2024-09-29T13:06:52Z",
      "author": {
        "login": "murrant",
        "type": "User",
        "stats": {
          "total_commits": 3307,
          "average_weekly_commits": 3.8860164512338424,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 420
        }
      },
      "commit_message": {
        "title": "Fix device dependencies xss (#16447)",
        "length": 182,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 84,
        "additions": 63,
        "deletions": 21
      },
      "files": [
        {
          "filename": "includes/html/pages/device-dependencies.inc.php",
          "status": "modified",
          "additions": 63,
          "deletions": 21,
          "patch": "@@ -70,48 +70,90 @@\n     },\n     formatters: {\n         \"actions\": function(column, row) {\n-            var buttonDisabled = '';\n-            var response =  \"<button type='button' class='btn btn-primary btn-sm command-edit' aria-label='Edit' data-toggle='modal' data-target='#edit-dependency' data-device_id='\"+row.deviceid+\"' data-host_name='\"+row.hostname+\"' data-parent_id='\"+row.parentid+\"' name='edit-host-dependency'><i class='fa fa-pencil' aria-hidden='true'></i></button> \";\n-            if (row.parent == 'None') {\n-                buttonDisabled = ' disabled';\n-            }\n-            response += \"<button type='button' class='command-delete btn btn-danger btn-sm\"+buttonDisabled+\"' aria-label='Delete' data-toggle='modal' data-target='#confirm-delete' data-device_id='\"+row.deviceid+\"' data-device_parent ='\"+row.parentid+\"' data-host_name='\"+row.hostname+\"' name='delete-host-dependency'\"+buttonDisabled+\"><i class='fa fa-trash' aria-hidden='true'></i></button>\";\n-            return response;\n+            var content = document.createElement('div');\n+            content.style.whiteSpace = \"nowrap\";\n+\n+            var edit_button = document.createElement('button');\n+            edit_button.setAttribute('type', 'button');\n+            edit_button.setAttribute('class', 'btn btn-primary btn-sm command-edit');\n+            edit_button.setAttribute('aria-label', 'Edit');\n+            edit_button.setAttribute('data-toggle', 'modal');\n+            edit_button.setAttribute('data-target', '#edit-dependency');\n+            edit_button.setAttribute('name', 'edit-host-dependency');\n+            edit_button.setAttribute('data-device_id', row.deviceid);\n+            edit_button.setAttribute('data-host_name', row.hostname);\n+            edit_button.setAttribute('data-parent_id', row.parentid);\n+            var edit_button_label = document.createElement('i');\n+            edit_button_label.setAttribute('class', 'fa fa-pencil');\n+            edit_button_label.setAttribute('aria-hidden', 'true');\n+            edit_button.appendChild(edit_button_label);\n+            content.appendChild(edit_button);\n+\n+            content.appendChild(document.createTextNode(' '))\n+\n+            var delete_button = document.createElement('button');\n+            delete_button.setAttribute('type', 'button');\n+            delete_button.setAttribute('class', 'btn btn-danger btn-sm command-delete');\n+            delete_button.setAttribute('aria-label', 'Delete');\n+            delete_button.setAttribute('data-toggle', 'modal');\n+            delete_button.setAttribute('data-target', '#confirm-delete');\n+            delete_button.setAttribute('name', 'delete-host-dependency');\n+            delete_button.setAttribute('data-device_id', row.deviceid);\n+            delete_button.setAttribute('data-host_name', row.hostname);\n+            delete_button.setAttribute('data-device_parent', row.parentid);\n+            delete_button.disabled = row.parent == 'None';\n+            var delete_button_label = document.createElement('i');\n+            delete_button_label.setAttribute('class', 'fa fa-trash');\n+            delete_button_label.setAttribute('aria-hidden', 'true');\n+            delete_button.appendChild(delete_button_label);\n+            content.appendChild(delete_button)\n+\n+            return content.outerHTML;\n         },\n         \"id\": function(column, row) {\n             return row.deviceid;\n         },\n         \"hostname\": function(column, row) {\n-            return '<a href=\"device/device='+row.deviceid+'/\" class=\"list-device\">'+row.hostname+'</a><br />'+row.sysname;\n+            var content = document.createElement('div');\n+            var link = document.createElement('a');\n+            link.setAttribute('href', '<?php echo route('device', ['device' => ':device_id']) ?>'.replace(':device_id', row.deviceid));\n+            link.setAttribute('class', 'list-device');\n+            link.appendChild(document.createTextNode(row.hostname));\n+            content.appendChild(link);\n+            content.appendChild(document.createElement('br'));\n+            content.appendChild(document.createTextNode(row.sysname));\n+\n+            return content.innerHTML;\n         },\n         \"parent\": function(column, row) {\n             if (row.parent == 'None') {\n                 return 'None';\n-            } else {\n-                var temp = Array();\n-                var tempids = Array();\n-                var counter = 0;\n-                temp = row.parent.split(',');\n-                tempids = row.parentid.split(',');\n-                var retstr = '';\n-                for (i=0; i < temp.length; i++) {\n-                    retstr = retstr + '<a href=\"device/device='+tempids[i]+'/\" class=\"list-device\">'+temp[i]+'</a>, ';\n-                }\n-                return retstr.slice(0, -2);\n             }\n+\n+            var temp = row.parent.split(',');\n+            var tempids = row.parentid.split(',');\n+            var retstr = '';\n+            for (i=0; i < temp.length; i++) {\n+                var link = document.createElement('a');\n+                link.setAttribute('href', '<?php echo route('device', ['device' => ':device_id']) ?>'.replace(':device_id', tempids[i]));\n+                link.setAttribute('class', 'list-device');\n+                link.appendChild(document.createTextNode(temp[i]));\n+                retstr = retstr + link.outerHTML + ', ';\n+            }\n+            return retstr.slice(0, -2);\n         }\n     },\n }).on(\"loaded.rs.jquery.bootgrid\", function(e) {\n     e.preventDefault();\n         /* Executes after data is loaded and rendered */\n     grid.find(\".command-edit\").on(\"click\", function(e) {\n-        $('#edit-row_id').val($(this).parent().parent().data('row-id'));\n+        $('#edit-row_id').val($(this).parent().parent().parent().data('row-id'));\n         $(\"#edit-device_id\").val($(this).data(\"device_id\"));\n         $(\"#edit-parent_id\").val($(this).data(\"parent_id\"));\n         $('#edit-dependency').modal('show');\n         $('.modalhostname').text($(this).data(\"host_name\"));\n     }).end().find(\".command-delete\").on(\"click\", function(e) {\n-        $('#delete-row_id').val($(this).parent().parent().data('row-id'));\n+        $('#delete-row_id').val($(this).parent().parent().parent().data('row-id'));\n         $(\"#delete-device_id\").val($(this).data(\"device_id\"));\n         $(\"#delete-parent_id\").val($(this).data(\"device_parent\"));\n         $('#confirm-delete').modal('show');"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "19d075a8363a4ca9cc355a96884a7f475d1bb550",
            "date": "2025-01-25T21:53:50Z",
            "author_login": "murrant"
          },
          {
            "sha": "50e486fdbd1a233b42195369c3572c928ca5edef",
            "date": "2025-01-25T18:38:59Z",
            "author_login": "murrant"
          },
          {
            "sha": "4ff5d4910c10803b025a392b6366379a36736e25",
            "date": "2025-01-25T18:36:50Z",
            "author_login": "murrant"
          },
          {
            "sha": "a16669d157e09531879a08a3ecc9ae2d503703ec",
            "date": "2025-01-25T16:34:24Z",
            "author_login": "murrant"
          },
          {
            "sha": "cf00665ebeab15254b32f43411c3e2ca34f875f9",
            "date": "2025-01-24T20:37:14Z",
            "author_login": "murrant"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:L/A:L",
    "cwe_id": "CWE-79",
    "description": "LibreNMS is an open-source, PHP/MySQL/SNMP-based network monitoring system. A Stored Cross-Site Scripting (XSS) vulnerability in the \"Device Dependencies\" feature allows authenticated users to inject arbitrary JavaScript through the device name (\"hostname\" parameter). This vulnerability can lead to the execution of malicious code in the context of other users' sessions, potentially compromising their accounts and allowing unauthorized actions. This vulnerability is fixed in 24.9.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-01T21:15:07.967",
    "last_modified": "2024-10-07T19:08:41.467",
    "fix_date": "2024-09-29T13:06:52Z"
  },
  "references": [
    {
      "url": "https://github.com/librenms/librenms/commit/36b38a50cc10d4ed16caab92bdc18ed6abac9685",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/librenms/librenms/security/advisories/GHSA-rwwc-2v8q-gc9v",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.102392",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "librenms",
    "owner": "librenms",
    "created_at": "2013-10-28T01:37:13Z",
    "updated_at": "2025-01-25T21:53:54Z",
    "pushed_at": "2025-01-25T21:53:50Z",
    "size": 311237,
    "stars": 4037,
    "forks": 2353,
    "open_issues": 244,
    "watchers": 4037,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 12373196,
      "Blade": 700903,
      "CSS": 252584,
      "Python": 163497,
      "JavaScript": 94468,
      "Vue": 91466,
      "Shell": 35894,
      "Perl": 11761,
      "HTML": 5133,
      "Hack": 1491,
      "SCSS": 707
    },
    "commit_activity": {
      "total_commits_last_year": 1011,
      "avg_commits_per_week": 19.442307692307693,
      "days_active_last_year": 259
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T07:39:46.998576"
  }
}