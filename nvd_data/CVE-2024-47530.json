{
  "cve_id": "CVE-2024-47530",
  "github_data": {
    "repository": "Clinical-Genomics/scout",
    "fix_commit": "50055edfca9a7183b248019af97e1fb0b0065a02",
    "related_commits": [
      "50055edfca9a7183b248019af97e1fb0b0065a02"
    ],
    "patch_url": "https://github.com/Clinical-Genomics/scout/commit/50055edfca9a7183b248019af97e1fb0b0065a02.patch",
    "fix_commit_details": {
      "sha": "50055edfca9a7183b248019af97e1fb0b0065a02",
      "commit_date": "2024-09-12T07:01:04Z",
      "author": {
        "login": "northwestwitch",
        "type": "User",
        "stats": {
          "total_commits": 3573,
          "average_weekly_commits": 6.653631284916201,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 299
        }
      },
      "commit_message": {
        "title": "Avoid open login redirect attacks via next (#4841)",
        "length": 217,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 3,
        "deletions": 8
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -12,6 +12,7 @@ About changelog [here](https://keepachangelog.com/en/1.0.0/)\n - Documentation for OMICS variants and updating a case\n ### Fixed\n - Broken heading anchors in the documentation (`admin-guide/login-system.md` and `admin-guide/setup-scout.md` files)\n+- Avoid open login redirect attacks by always redirecting to cases page upon user login\n \n ## [4.88.1]\n ### Fixed"
        },
        {
          "filename": "scout/server/app.py",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -83,10 +83,7 @@ def check_user():\n             relevant_endpoint = not (static_endpoint or public_endpoint)\n             # if endpoint requires auth, check if user is authenticated\n             if relevant_endpoint and not current_user.is_authenticated:\n-                # combine visited URL (convert byte string query string to unicode!)\n-                next_url = \"{}?{}\".format(request.path, request.query_string.decode())\n-                login_url = url_for(\"public.index\", next=next_url)\n-                return redirect(login_url)\n+                return redirect(url_for(\"public.index\"))\n \n     return app\n "
        },
        {
          "filename": "scout/server/blueprints/login/views.py",
          "status": "modified",
          "additions": 1,
          "deletions": 4,
          "patch": "@@ -47,8 +47,6 @@ def load_user(user_id):\n @public_endpoint\n def login():\n     \"\"\"Login a user if they have access.\"\"\"\n-    if \"next\" in request.args:\n-        session[\"next_url\"] = request.args[\"next\"]\n \n     user_id = None\n     user_mail = None\n@@ -130,7 +128,6 @@ def users():\n def perform_login(user_dict):\n     if login_user(user_dict, remember=True):\n         flash(\"you logged in as: {}\".format(user_dict.name), \"success\")\n-        next_url = session.pop(\"next_url\", None)\n-        return redirect(request.args.get(\"next\") or next_url or url_for(\"cases.index\"))\n+        return redirect(url_for(\"cases.index\"))\n     flash(\"sorry, you could not log in\", \"warning\")\n     return redirect(url_for(\"public.index\"))"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f963bc4a1b2db588f85c9100c636d38cbdc9ec08",
            "date": "2025-01-14T12:35:33Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "15f4a5cb4fc7bd5f322571477261add39b1a0254",
            "date": "2025-01-14T10:29:49Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "aa4d4fba245ac9d31dee85b13fe54df27c798233",
            "date": "2025-01-14T09:17:34Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "4b29689420606be0bc10da89a64ced323d1b5808",
            "date": "2025-01-13T09:02:36Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "26cac0cfc9f06a17093ca5583993ca46319767f7",
            "date": "2025-01-13T07:37:22Z",
            "author_login": "northwestwitch"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.4,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-601",
    "description": "Scout is a web-based visualizer for VCF-files. Open redirect vulnerability allows performing phishing attacks on users by redirecting them to malicious page. /login API endpoint is vulnerable to open redirect attack via next parameter due to absence of sanitization logic. Additionally, due to lack of scheme validation, HTTPS Downgrade Attack can be performed on the users. This vulnerability is fixed in 4.89.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-30T16:15:09.540",
    "last_modified": "2024-11-15T18:03:06.497",
    "fix_date": "2024-09-12T07:01:04Z"
  },
  "references": [
    {
      "url": "https://github.com/Clinical-Genomics/scout/commit/50055edfca9a7183b248019af97e1fb0b0065a02",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Clinical-Genomics/scout/security/advisories/GHSA-3x45-2m34-x95v",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.096814",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "scout",
    "owner": "Clinical-Genomics",
    "created_at": "2014-10-10T08:44:01Z",
    "updated_at": "2025-01-14T12:35:38Z",
    "pushed_at": "2025-01-14T12:36:06Z",
    "size": 93082,
    "stars": 154,
    "forks": 47,
    "open_issues": 211,
    "watchers": 154,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "HTML": 4382817,
      "Python": 2779535,
      "JavaScript": 39470,
      "CSS": 14975,
      "Dockerfile": 1766,
      "Makefile": 1067
    },
    "commit_activity": {
      "total_commits_last_year": 1008,
      "avg_commits_per_week": 19.384615384615383,
      "days_active_last_year": 170
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:16:56.684352"
  }
}