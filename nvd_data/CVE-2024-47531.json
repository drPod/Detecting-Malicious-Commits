{
  "cve_id": "CVE-2024-47531",
  "github_data": {
    "repository": "Clinical-Genomics/scout",
    "fix_commit": "f59e50f8ea596e641da8a0e9c7a33c0696bcbea5",
    "related_commits": [
      "f59e50f8ea596e641da8a0e9c7a33c0696bcbea5"
    ],
    "patch_url": "https://github.com/Clinical-Genomics/scout/commit/f59e50f8ea596e641da8a0e9c7a33c0696bcbea5.patch",
    "fix_commit_details": {
      "sha": "f59e50f8ea596e641da8a0e9c7a33c0696bcbea5",
      "commit_date": "2024-09-12T13:24:24Z",
      "author": {
        "login": "northwestwitch",
        "type": "User",
        "stats": {
          "total_commits": 3573,
          "average_weekly_commits": 6.653631284916201,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 299
        }
      },
      "commit_message": {
        "title": "Fix regular expression check in new panel form (#4843)",
        "length": 395,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 6,
        "deletions": 2
      },
      "files": [
        {
          "filename": "CHANGELOG.md",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -14,6 +14,7 @@ About changelog [here](https://keepachangelog.com/en/1.0.0/)\n ### Fixed\n - Broken heading anchors in the documentation (`admin-guide/login-system.md` and `admin-guide/setup-scout.md` files)\n - Avoid open login redirect attacks by always redirecting to cases page upon user login\n+- Stricter check of ID of gene panels to prevent file downloading vulnerability\n \n ## [4.88.1]\n ### Fixed"
        },
        {
          "filename": "scout/server/blueprints/panels/controllers.py",
          "status": "modified",
          "additions": 4,
          "deletions": 1,
          "patch": "@@ -1,6 +1,7 @@\n # -*- coding: utf-8 -*-\n import datetime as dt\n import logging\n+import re\n \n from flask import flash, redirect\n from flask_login import current_user\n@@ -309,9 +310,11 @@ def downloaded_panel_name(panel_obj, format) -> str:\n     Returns:\n         a string describing the panel\n     \"\"\"\n+    sanitized_panel_id = re.sub(r\"[^a-zA-Z_\\-]+\", \"\", panel_obj[\"panel_name\"])\n+\n     return \"_\".join(\n         [\n-            panel_obj[\"panel_name\"],\n+            sanitized_panel_id,\n             str(panel_obj[\"version\"]),\n             dt.datetime.now().strftime(DATE_DAY_FORMATTER),\n             f\"scout.{format}\","
        },
        {
          "filename": "scout/server/blueprints/panels/templates/panels/panels.html",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -109,7 +109,7 @@\n           </div>\n           <div class=\"col-sm-3 text-center\">\n               <input type=\"text\" name=\"new_panel_name\" class=\"form-control\" placeholder=\"Panel ID\" required\n-                pattern=\"^[a-zA-Z0-9_-]*$\" title=\"Only alphanumeric characters (A-Z+a-z+0-9), hyphens, and underscores allowed.\">\n+                pattern=\"[A-Za-z0-9_\\-]+\" title=\"Only alphanumeric characters (A-Z+a-z+0-9), hyphens, and underscores allowed.\">\n             </div>\n             <div class=\"col-sm-4 text-center\">\n               <input type=\"text\" name=\"display_name\" class=\"form-control\" placeholder=\"Full name\">"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f963bc4a1b2db588f85c9100c636d38cbdc9ec08",
            "date": "2025-01-14T12:35:33Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "15f4a5cb4fc7bd5f322571477261add39b1a0254",
            "date": "2025-01-14T10:29:49Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "aa4d4fba245ac9d31dee85b13fe54df27c798233",
            "date": "2025-01-14T09:17:34Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "4b29689420606be0bc10da89a64ced323d1b5808",
            "date": "2025-01-13T09:02:36Z",
            "author_login": "northwestwitch"
          },
          {
            "sha": "26cac0cfc9f06a17093ca5583993ca46319767f7",
            "date": "2025-01-13T07:37:22Z",
            "author_login": "northwestwitch"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:L/I:L/A:N",
    "cwe_id": "CWE-116",
    "description": "Scout is a web-based visualizer for VCF-files. Due to the lack of sanitization in the filename, it is possible bypass intended file extension and make users download malicious files with any extension. With malicious content injected inside the file data and users unknowingly downloading it and opening may lead to the compromise of users' devices or data. This vulnerability is fixed in 4.89.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-30T16:15:09.750",
    "last_modified": "2024-11-15T18:02:14.250",
    "fix_date": "2024-09-12T13:24:24Z"
  },
  "references": [
    {
      "url": "https://github.com/Clinical-Genomics/scout/commit/f59e50f8ea596e641da8a0e9c7a33c0696bcbea5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Clinical-Genomics/scout/security/advisories/GHSA-24xv-q29v-3h6r",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.096944",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "scout",
    "owner": "Clinical-Genomics",
    "created_at": "2014-10-10T08:44:01Z",
    "updated_at": "2025-01-14T12:35:38Z",
    "pushed_at": "2025-01-14T12:36:06Z",
    "size": 93082,
    "stars": 154,
    "forks": 47,
    "open_issues": 211,
    "watchers": 154,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "HTML": 4382817,
      "Python": 2779535,
      "JavaScript": 39470,
      "CSS": 14975,
      "Dockerfile": 1766,
      "Makefile": 1067
    },
    "commit_activity": {
      "total_commits_last_year": 1008,
      "avg_commits_per_week": 19.384615384615383,
      "days_active_last_year": 170
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "bsd-3-clause"
    },
    "collected_at": "2025-01-14T15:16:56.684352"
  }
}