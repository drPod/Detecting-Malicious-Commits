{
  "cve_id": "CVE-2024-47532",
  "github_data": {
    "repository": "zopefoundation/RestrictedPython",
    "fix_commit": "d701cc36cccac36b21fa200f1f2d1945a9a215e6",
    "related_commits": [
      "d701cc36cccac36b21fa200f1f2d1945a9a215e6"
    ],
    "patch_url": "https://github.com/zopefoundation/RestrictedPython/commit/d701cc36cccac36b21fa200f1f2d1945a9a215e6.patch",
    "fix_commit_details": {
      "sha": "d701cc36cccac36b21fa200f1f2d1945a9a215e6",
      "commit_date": "2024-09-30T06:58:30Z",
      "author": {
        "login": "d-maurer",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 18,
        "deletions": 3
      },
      "files": [
        {
          "filename": "CHANGES.rst",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -10,6 +10,8 @@ Changes\n   it as ``getattr`` implementation. Such use should now follow the same policy\n   and give the same level of protection as direct attribute access in an\n   environment based on ``RestrictedPython``'s ``safe_builtints``.\n+- Prevent information leakage via ``AttributeError.obj``\n+  and the ``string`` module.\n \n \n 7.2 (2024-08-02)"
        },
        {
          "filename": "src/RestrictedPython/Utilities.py",
          "status": "modified",
          "additions": 5,
          "deletions": 1,
          "patch": "@@ -29,7 +29,11 @@ def __getattr__(self, attr):\n         if attr in self.__excludes:\n             raise NotImplementedError(\n                 f\"{self.__mod.__name__}.{attr} is not safe\")\n-        return getattr(self.__mod, attr)\n+        try:\n+            return getattr(self.__mod, attr)\n+        except AttributeError as e:\n+            e.obj = self\n+            raise\n \n \n utility_builtins['string'] = _AttributeDelegator(string, \"Formatter\")"
        },
        {
          "filename": "tests/builtins/test_utilities.py",
          "status": "modified",
          "additions": 11,
          "deletions": 2,
          "patch": "@@ -7,8 +7,17 @@ def test_string_in_utility_builtins():\n     from RestrictedPython.Utilities import utility_builtins\n \n     # we no longer provide access to ``string`` itself, only to\n-    # a restricted view of it\n-    assert utility_builtins['string'].__name__ == string.__name__\n+    # a restricted view of it (``rstring``)\n+    rstring = utility_builtins['string']\n+    assert rstring.__name__ == string.__name__\n+\n+    # ensure it does not provide access to ``string`` via\n+    # ``AttributeError.obj``\n+    try:\n+        rstring.unexisting_attribute\n+    except AttributeError as e:\n+        assert e.obj is rstring\n+        \n \n \n def test_math_in_utility_builtins():"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "f4c1c1b5d31866de61c09143f3b009bfe8b2a0a0",
            "date": "2025-01-06T09:10:52Z",
            "author_login": "dataflake"
          },
          {
            "sha": "07950f933194c0bb96fb6c48b023a4ba195eb60d",
            "date": "2024-11-18T00:53:50Z",
            "author_login": "loechel"
          },
          {
            "sha": "642202897b419a74b1cb1756315936b45fb75e78",
            "date": "2024-10-09T16:44:07Z",
            "author_login": "dataflake"
          },
          {
            "sha": "7e5234545d9efcc02dd47b74ae14610fb516bc9a",
            "date": "2024-10-09T16:39:28Z",
            "author_login": "dataflake"
          },
          {
            "sha": "7b8a6b45545f6e9cf141c87b43b61b19667a0fee",
            "date": "2024-10-09T16:36:13Z",
            "author_login": "dataflake"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-200",
    "description": "RestrictedPython is a restricted execution environment for Python to run untrusted code. A user can gain access to protected (and potentially sensible) information indirectly via AttributeError.obj and the string module. The problem will be fixed in version 7.3. As a workaround, If the application does not require access to the module string, it can remove it from RestrictedPython.Utilities.utility_builtins or otherwise do not make it available in the restricted execution environment.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-30T16:15:09.960",
    "last_modified": "2024-11-15T17:59:51.307",
    "fix_date": "2024-09-30T06:58:30Z"
  },
  "references": [
    {
      "url": "https://github.com/zopefoundation/RestrictedPython/commit/d701cc36cccac36b21fa200f1f2d1945a9a215e6",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/zopefoundation/RestrictedPython/security/advisories/GHSA-5rfv-66g4-jr8h",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.097072",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "RestrictedPython",
    "owner": "zopefoundation",
    "created_at": "2013-02-28T14:29:45Z",
    "updated_at": "2025-01-14T07:43:55Z",
    "pushed_at": "2025-01-08T07:37:30Z",
    "size": 1752,
    "stars": 501,
    "forks": 38,
    "open_issues": 21,
    "watchers": 501,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "3.x",
      "before-delete-of-old-implementation",
      "master"
    ],
    "languages": {
      "Python": 179666
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:47:41.649588"
  }
}