{
  "cve_id": "CVE-2024-47536",
  "github_data": {
    "repository": "StarCitizenTools/mediawiki-skins-Citizen",
    "fix_commit": "717d16af35b10dab04d434aefddbf991fc8c168c",
    "related_commits": [
      "717d16af35b10dab04d434aefddbf991fc8c168c",
      "86da3e07718c8d8da6f4310386fef85599606f9b"
    ],
    "patch_url": "https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/717d16af35b10dab04d434aefddbf991fc8c168c.patch",
    "fix_commit_details": {
      "sha": "717d16af35b10dab04d434aefddbf991fc8c168c",
      "commit_date": "2023-06-10T01:34:55Z",
      "author": {
        "login": "alistair3149",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "feat(core): \u2728 display real name in user menu when exists",
        "length": 119,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 27,
        "additions": 26,
        "deletions": 1
      },
      "files": [
        {
          "filename": "includes/Partials/Header.php",
          "status": "modified",
          "additions": 16,
          "deletions": 1,
          "patch": "@@ -82,7 +82,22 @@ public function getUserInfoData( $userPageData ): array {\n \t */\n \tprivate function getUserPageHTML( $isRegistered, $userPageData ): ?string {\n \t\tif ( $isRegistered ) {\n-\t\t\t$html = $userPageData['html-items'];\n+\t\t\t$realname = $this->user->getRealName();\n+\t\t\tif ( !empty( $realname ) ) {\n+\t\t\t\t$username = $this->user->getName();\n+\t\t\t\t$innerHtml = <<<HTML\n+\t\t\t\t\t<div id=\"pt-userpage-realname\">$realname</div>\n+\t\t\t\t\t<div id=\"pt-userpage-username\">$username</div>\n+\t\t\t\tHTML;\n+\t\t\t\t// Dirty but it works\n+\t\t\t\t$html = str_replace(\n+\t\t\t\t\t\">\" . $username . \"<\",\n+\t\t\t\t\t\">\" . $innerHtml . \"<\",\n+\t\t\t\t\t$userPageData['html-items']\n+\t\t\t\t);\n+\t\t\t} else {\n+\t\t\t\t$html = $userPageData['html-items'];\n+\t\t\t}\n \t\t} else {\n \t\t\t// There must be a cleaner way to do this\n \t\t\t$msg = $this->skin->msg( 'notloggedin' )->text();"
        },
        {
          "filename": "resources/skins.citizen.styles/components/Usermenu.less",
          "status": "modified",
          "additions": 10,
          "deletions": 0,
          "patch": "@@ -98,6 +98,16 @@\n \t\t\t}\n \t\t}\n \n+\t\t&page {\n+\t\t\t&-username {\n+\t\t\t\tmargin-top: var( --space-xxs );\n+\t\t\t\tmargin-bottom: var( --space-sm );\n+\t\t\t\tcolor: var( --color-base--subtle );\n+\t\t\t\tfont-size: 0.8125rem;\n+\t\t\t\tfont-weight: var( --font-weight-normal );\n+\t\t\t}\n+\t\t}\n+\n \t\t&contris {\n \t\t\tfont-weight: var( --font-weight-medium );\n \t\t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "531a4b9c271e0a57f6d6476372329a30a2d45c51",
            "date": "2025-01-14T01:07:17Z",
            "author_login": "alistair3149"
          },
          {
            "sha": "367d60983e1268551232b5aef28038f2229899b8",
            "date": "2025-01-14T00:44:15Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "af4b485c3b8b881dec4be8598cae030c5ce2d361",
            "date": "2025-01-13T12:10:44Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "9fb16c69d148a41f8825093f278e94da063a50d9",
            "date": "2025-01-12T00:29:33Z",
            "author_login": "alistair3149"
          },
          {
            "sha": "6ea13ffd8a2a31edd665a380b91dc0db29b89756",
            "date": "2025-01-12T00:02:09Z",
            "author_login": "alistair3149"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Citizen is a MediaWiki skin that makes extensions part of the cohesive experience. A user with the editmyprivateinfo right or who can otherwise change their name can XSS themselves by setting their \"real name\" to an XSS payload. This vulnerability is fixed in 2.31.0.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-09-30T17:15:04.780",
    "last_modified": "2024-10-04T13:51:25.567",
    "fix_date": "2023-06-10T01:34:55Z"
  },
  "references": [
    {
      "url": "https://github.com/StarCitizenTools/mediawiki-skins-Citizen/blob/d45c3d69f30863f622f16eb40dd41d3ca943454a/includes/Components/CitizenComponentUserInfo.php#L137",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/717d16af35b10dab04d434aefddbf991fc8c168c",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/StarCitizenTools/mediawiki-skins-Citizen/commit/86da3e07718c8d8da6f4310386fef85599606f9b",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/StarCitizenTools/mediawiki-skins-Citizen/security/advisories/GHSA-62r2-gcxr-426x",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.097585",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "mediawiki-skins-Citizen",
    "owner": "StarCitizenTools",
    "created_at": "2019-12-25T20:32:29Z",
    "updated_at": "2025-01-14T01:07:24Z",
    "pushed_at": "2025-01-14T01:07:20Z",
    "size": 61003,
    "stars": 245,
    "forks": 59,
    "open_issues": 30,
    "watchers": 245,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Less": 1090821,
      "JavaScript": 141112,
      "PHP": 97043,
      "Mustache": 19146,
      "Shell": 177
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T14:19:37.012951"
  }
}