{
  "cve_id": "CVE-2024-47769",
  "github_data": {
    "repository": "idurar/idurar-erp-crm",
    "fix_commit": "949bc6fe31f3175c9e1864d30cf6c8110179ac14",
    "related_commits": [
      "949bc6fe31f3175c9e1864d30cf6c8110179ac14"
    ],
    "patch_url": "https://github.com/idurar/idurar-erp-crm/commit/949bc6fe31f3175c9e1864d30cf6c8110179ac14.patch",
    "fix_commit_details": {
      "sha": "949bc6fe31f3175c9e1864d30cf6c8110179ac14",
      "commit_date": "2024-10-04T09:12:50Z",
      "author": {
        "login": "salahlalami",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 68,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 5,
        "additions": 3,
        "deletions": 2
      },
      "files": [
        {
          "filename": "backend/src/routes/coreRoutes/corePublicRouter.js",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -8,9 +8,10 @@ const path = require('path');\n router.route('/:subPath/:directory/:file').get(function (req, res) {\n   try {\n     const { subPath, directory, file } = req.params;\n-\n+    //subPath sanitization check\n+    sanitizedPath = path.normalize(subPath).replace(/^(\\.\\.[\\/\\\\])+/, '');\n     const options = {\n-      root: path.join(__dirname, `../../public/${subPath}/${directory}`),\n+      root: path.join(__dirname, `../../public/${sanitizedPath}/${directory}`),\n     };\n     const fileName = file;\n     return res.sendFile(fileName, options, function (error) {"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "949bc6fe31f3175c9e1864d30cf6c8110179ac14",
            "date": "2024-10-04T09:12:50Z",
            "author_login": "salahlalami"
          },
          {
            "sha": "5860bc53261e8dd69087b456bd6ae92f9d20728b",
            "date": "2024-10-04T07:03:43Z",
            "author_login": "DoMINAToR98"
          },
          {
            "sha": "0d623e1753a40442571954053de9fbb5072a8417",
            "date": "2024-10-04T07:01:32Z",
            "author_login": "DoMINAToR98"
          },
          {
            "sha": "100525d1d3ad4003da2afdf3987b4eab87f3d725",
            "date": "2024-10-02T20:16:11Z",
            "author_login": "salahlalami"
          },
          {
            "sha": "36b1d5e99bae046f4940c313555eb4d572ad80c1",
            "date": "2024-10-02T18:43:26Z",
            "author_login": "salahlalami"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "IDURAR is open source ERP CRM accounting invoicing software. The vulnerability exists in the corePublicRouter.js file. Using the reference usage here, it is identified that the public endpoint is accessible to an unauthenticated user. The user's input is directly appended to the join statement without additional checks. This allows an attacker to send URL encoded malicious payload. The directory structure can be escaped to read system files by adding an encoded string (payload) at subpath location.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-04T15:15:13.427",
    "last_modified": "2024-11-13T15:12:54.033",
    "fix_date": "2024-10-04T09:12:50Z"
  },
  "references": [
    {
      "url": "https://github.com/idurar/idurar-erp-crm/commit/949bc6fe31f3175c9e1864d30cf6c8110179ac14",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/idurar/idurar-erp-crm/security/advisories/GHSA-948g-2vm7-mfv7",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.108743",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "idurar-erp-crm",
    "owner": "idurar",
    "created_at": "2020-10-17T22:38:36Z",
    "updated_at": "2025-01-14T18:41:32Z",
    "pushed_at": "2024-10-04T09:12:51Z",
    "size": 23141,
    "stars": 6792,
    "forks": 2117,
    "open_issues": 284,
    "watchers": 6792,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "demo",
      "dev",
      "master"
    ],
    "languages": {
      "JavaScript": 594100,
      "Pug": 28874,
      "CSS": 8545,
      "HTML": 583
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T19:12:36.767871"
  }
}