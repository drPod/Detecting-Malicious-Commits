{
  "cve_id": "CVE-2024-47781",
  "github_data": {
    "repository": "miraheze/CreateWiki",
    "fix_commit": "693a220f399ee7eb4d00e77c3c667e864b1bd306",
    "related_commits": [
      "693a220f399ee7eb4d00e77c3c667e864b1bd306"
    ],
    "patch_url": "https://github.com/miraheze/CreateWiki/commit/693a220f399ee7eb4d00e77c3c667e864b1bd306.patch",
    "fix_commit_details": {
      "sha": "693a220f399ee7eb4d00e77c3c667e864b1bd306",
      "commit_date": "2024-10-07T05:17:19Z",
      "author": {
        "login": "BlankEclair",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 127,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 21,
        "additions": 14,
        "deletions": 7
      },
      "files": [
        {
          "filename": "includes/RequestWiki/RequestWikiQueuePager.php",
          "status": "modified",
          "additions": 14,
          "deletions": 7,
          "patch": "@@ -68,19 +68,19 @@ public function formatValue( $name, $value ): string {\n \t\tswitch ( $name ) {\n \t\t\tcase 'cw_timestamp':\n \t\t\t\t$language = $this->getLanguage();\n-\t\t\t\t$formatted = $language->timeanddate( $row->cw_timestamp, true );\n+\t\t\t\t$formatted = $this->escape( $language->timeanddate( $row->cw_timestamp, true ) );\n \t\t\t\tbreak;\n \t\t\tcase 'cw_dbname':\n-\t\t\t\t$formatted = $row->cw_dbname;\n+\t\t\t\t$formatted = $this->escape( $row->cw_dbname );\n \t\t\t\tbreak;\n \t\t\tcase 'cw_sitename':\n-\t\t\t\t$formatted = $row->cw_sitename;\n+\t\t\t\t$formatted = $this->escape( $row->cw_sitename );\n \t\t\t\tbreak;\n \t\t\tcase 'cw_user':\n-\t\t\t\t$formatted = $this->userFactory->newFromId( $row->cw_user )->getName();\n+\t\t\t\t$formatted = $this->escape( $this->userFactory->newFromId( $row->cw_user )->getName() );\n \t\t\t\tbreak;\n \t\t\tcase 'cw_url':\n-\t\t\t\t$formatted = $row->cw_url;\n+\t\t\t\t$formatted = $this->escape( $row->cw_url );\n \t\t\t\tbreak;\n \t\t\tcase 'cw_status':\n \t\t\t\t$formatted = $this->linkRenderer->makeLink(\n@@ -89,15 +89,22 @@ public function formatValue( $name, $value ): string {\n \t\t\t\t);\n \t\t\t\tbreak;\n \t\t\tcase 'cw_language':\n-\t\t\t\t$formatted = $row->cw_language;\n+\t\t\t\t$formatted = $this->escape( $row->cw_language );\n \t\t\t\tbreak;\n \t\t\tdefault:\n-\t\t\t\t$formatted = \"Unable to format $name\";\n+\t\t\t\t$formatted = $this->escape( \"Unable to format {$name}\" );\n \t\t}\n \n \t\treturn $formatted;\n \t}\n \n+\t/**\n+\t * Safely HTML-escapes $value\n+\t */\n+\tprivate function escape( string $value ): string {\n+\t\treturn htmlspecialchars( $value, ENT_QUOTES, 'UTF-8', false );\n+\t}\n+\n \t/** @inheritDoc */\n \tpublic function getQueryInfo(): array {\n \t\t$user = $this->getUser();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "15caffe1fb39fc3edfdc9faf69463260a32e4fc8",
            "date": "2025-01-13T12:10:40Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "67da178cd8bd739028c194ddbab1d4c53b0f3b94",
            "date": "2025-01-12T01:41:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "ab3eee6449249222d95b5828a5ed3d3617e2666f",
            "date": "2025-01-12T01:41:06Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "aa7769d581541b983041e828267a993cc1641160",
            "date": "2025-01-09T12:10:32Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "9b6b5d083dc90fdee7be5117da6a97091220fb31",
            "date": "2025-01-06T12:10:46Z",
            "author_login": "translatewiki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "CreateWiki is an extension used at Miraheze for requesting & creating wikis. The name of requested wikis is not escaped on Special:RequestWikiQueue, so a user can insert arbitrary HTML that is displayed in the request wiki queue when requesting a wiki. If a wiki creator comes across the XSS payload, their user session can be abused to retrieve deleted wiki requests, which typically contains private information. Likewise, this can also be abused on those with the ability to suppress requests to view sensitive information. This issue has been patched with commit `693a220` and all users are advised to apply the patch. Users unable to upgrade should disable Javascript and/or prevent access to the vulnerable page (Special:RequestWikiQueue).",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-07T22:15:03.133",
    "last_modified": "2024-11-14T18:19:28.180",
    "fix_date": "2024-10-07T05:17:19Z"
  },
  "references": [
    {
      "url": "https://github.com/miraheze/CreateWiki/commit/693a220f399ee7eb4d00e77c3c667e864b1bd306",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/miraheze/CreateWiki/security/advisories/GHSA-h527-jh77-5g7j",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12693",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.118635",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "CreateWiki",
    "owner": "miraheze",
    "created_at": "2015-07-31T21:49:08Z",
    "updated_at": "2025-01-13T12:10:44Z",
    "pushed_at": "2025-01-13T12:10:41Z",
    "size": 3382,
    "stars": 25,
    "forks": 39,
    "open_issues": 6,
    "watchers": 25,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 272869,
      "Less": 3339,
      "JavaScript": 3280,
      "PLpgSQL": 517
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:13:49.328240"
  }
}