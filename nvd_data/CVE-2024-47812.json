{
  "cve_id": "CVE-2024-47812",
  "github_data": {
    "repository": "miraheze/ImportDump",
    "fix_commit": "d054b9529129af79d4426df24faa80014cb16602",
    "related_commits": [
      "d054b9529129af79d4426df24faa80014cb16602"
    ],
    "patch_url": "https://github.com/miraheze/ImportDump/commit/d054b9529129af79d4426df24faa80014cb16602.patch",
    "fix_commit_details": {
      "sha": "d054b9529129af79d4426df24faa80014cb16602",
      "commit_date": "2024-10-09T02:03:21Z",
      "author": {
        "login": "BlankEclair",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 19,
        "additions": 15,
        "deletions": 4
      },
      "files": [
        {
          "filename": "includes/ImportDumpRequestQueuePager.php",
          "status": "modified",
          "additions": 15,
          "deletions": 4,
          "patch": "@@ -69,6 +69,16 @@ protected function getFieldNames() {\n \t\t];\n \t}\n \n+\t/**\n+\t * Safely HTML-escape $value\n+\t *\n+\t * @param string $value\n+\t * @return string\n+\t */\n+\tprivate static function escape( $value ) {\n+\t\treturn htmlspecialchars( $value, ENT_QUOTES );\n+\t}\n+\n \t/**\n \t * @param string $name\n \t * @param string $value\n@@ -80,11 +90,12 @@ public function formatValue( $name, $value ) {\n \t\tswitch ( $name ) {\n \t\t\tcase 'request_timestamp':\n \t\t\t\t$language = $this->getLanguage();\n-\t\t\t\t$formatted = $language->timeanddate( $row->request_timestamp );\n+\t\t\t\t$formatted = $this->escape( $language->timeanddate( $row->request_timestamp ) );\n \n \t\t\t\tbreak;\n \t\t\tcase 'request_target':\n-\t\t\t\t$formatted = $row->request_target;\n+\t\t\t\t// @phan-suppress-next-line SecurityCheck-LikelyFalsePositive Phan will only shut up if I put it here\n+\t\t\t\t$formatted = $this->escape( $row->request_target );\n \n \t\t\t\tbreak;\n \t\t\tcase 'request_status':\n@@ -96,11 +107,11 @@ public function formatValue( $name, $value ) {\n \t\t\t\tbreak;\n \t\t\tcase 'request_actor':\n \t\t\t\t$user = $this->userFactory->newFromActorId( $row->request_actor );\n-\t\t\t\t$formatted = $user->getName();\n+\t\t\t\t$formatted = $this->escape( $user->getName() );\n \n \t\t\t\tbreak;\n \t\t\tdefault:\n-\t\t\t\t$formatted = \"Unable to format $name\";\n+\t\t\t\t$formatted = $this->escape( \"Unable to format $name\" );\n \t\t}\n \n \t\treturn $formatted;"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "bc57f588458704060be924ed9e063e8aa60a656f",
            "date": "2025-01-10T13:55:34Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "3ca3ef7a2aa799fb147c55395ccb238a2c5aa59d",
            "date": "2024-11-21T12:10:27Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "d2327e7cc01a4e6806f380fe71cfbba61c7ce5dc",
            "date": "2024-11-20T18:59:11Z",
            "author_login": "Universal-Omega"
          },
          {
            "sha": "62c7de4d83e42949c80a60e814e7449c9a639e3e",
            "date": "2024-11-20T17:59:11Z",
            "author_login": "Universal-Omega"
          },
          {
            "sha": "08c6fb19a8e1abc2be88d5ac68482f8268fa103b",
            "date": "2024-11-18T12:10:33Z",
            "author_login": "translatewiki"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:L",
    "cwe_id": "CWE-79",
    "description": "ImportDump is an extension for mediawiki designed to automate user import requests. Anyone who can edit the interface strings of a wiki (typically administrators and interface admins) can embed XSS payloads in the messages for dates, and thus XSS anyone who views Special:RequestImportQueue. This issue has been patched in commit `d054b95` and all users are advised to apply this commit to their branch. Users unable to upgrade may either Prevent access to Special:RequestImportQueue on all wikis, except for the global wiki; and If an interface administrator (or equivalent) level protection is available (which is not provided by default) on the global wiki, protect the affected messages up to that level. This causes the XSS to be virtually useless as users with those rights can already edit Javascript pages. Or Prevent access to Special:RequestImportQueue altogether.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-09T19:15:13.803",
    "last_modified": "2024-10-10T12:51:56.987",
    "fix_date": "2024-10-09T02:03:21Z"
  },
  "references": [
    {
      "url": "https://github.com/miraheze/ImportDump/commit/d054b9529129af79d4426df24faa80014cb16602",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/miraheze/ImportDump/security/advisories/GHSA-465h-45v4-6fx9",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12698",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.124251",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "ImportDump",
    "owner": "miraheze",
    "created_at": "2022-04-18T05:38:52Z",
    "updated_at": "2025-01-10T13:55:38Z",
    "pushed_at": "2025-01-10T13:55:36Z",
    "size": 894,
    "stars": 3,
    "forks": 6,
    "open_issues": 1,
    "watchers": 3,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 101696,
      "JavaScript": 3310,
      "Less": 2650
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T19:08:15.087552"
  }
}