{
  "cve_id": "CVE-2024-47815",
  "github_data": {
    "repository": "miraheze/IncidentReporting",
    "fix_commit": "43896a47de4e05ac94ec0472c220da944da16c5c",
    "related_commits": [
      "43896a47de4e05ac94ec0472c220da944da16c5c"
    ],
    "patch_url": "https://github.com/miraheze/IncidentReporting/commit/43896a47de4e05ac94ec0472c220da944da16c5c.patch",
    "fix_commit_details": {
      "sha": "43896a47de4e05ac94ec0472c220da944da16c5c",
      "commit_date": "2024-10-09T02:08:13Z",
      "author": {
        "login": "BlankEclair",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 253,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 117,
        "additions": 55,
        "deletions": 62
      },
      "files": [
        {
          "filename": "includes/IncidentReportingFormFactory.php",
          "status": "modified",
          "additions": 38,
          "deletions": 45,
          "patch": "@@ -1,13 +1,10 @@\n <?php\n \n+use MediaWiki\\Html\\Html;\n use MediaWiki\\MediaWikiServices;\n use MediaWiki\\Permissions\\PermissionManager;\n use Wikimedia\\Rdbms\\DBConnRef;\n \n-/**\n- * @phan-file-suppress SecurityCheck-XSS\n- * @phan-file-suppress SecurityCheck-DoubleEscaped\n- */\n class IncidentReportingFormFactory {\n \t/** @var Config */\n \tprivate $config;\n@@ -128,9 +125,9 @@ public function getFormDescriptor(\n \t\t\t\t'type' => 'select',\n \t\t\t\t'label-message' => 'incidentreporting-label-cause',\n \t\t\t\t'options' => [\n-\t\t\t\t\twfMessage( 'incidentreporting-label-human' )->parse() => 'human',\n-\t\t\t\t\twfMessage( 'incidentreporting-label-technical' )->parse() => 'technical',\n-\t\t\t\t\twfMessage( 'incidentreporting-label-upstream' )->parse() => 'upstream'\n+\t\t\t\t\twfMessage( 'incidentreporting-label-human' )->text() => 'human',\n+\t\t\t\t\twfMessage( 'incidentreporting-label-technical' )->text() => 'technical',\n+\t\t\t\t\twfMessage( 'incidentreporting-label-upstream' )->text() => 'upstream'\n \t\t\t\t],\n \t\t\t\t'section' => 'main',\n \t\t\t\t'default' => ( $data !== null ) ? $data->i_cause : 'human'\n@@ -209,55 +206,51 @@ public function getFormDescriptor(\n \t\t\t'service' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-service',\n-\t\t\t\t'default' => ( isset( $irServicesUrl[$data->i_service] ) ) ? Linker::makeExternalLink( $irServicesUrl[$data->i_service], $revServices[$data->i_service] ) : $revServices[$data->i_service],\n+\t\t\t\t'default' => ( isset( $irServicesUrl[$data->i_service] ) ) ? Linker::makeExternalLink( $irServicesUrl[$data->i_service], $revServices[$data->i_service] ) : htmlspecialchars( $revServices[$data->i_service], ENT_QUOTES ),\n \t\t\t\t'raw' => true,\n \t\t\t\t'section' => 'main'\n \t\t\t],\n \t\t\t'outage-visible' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-outage-visible',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'default' => wfMessage( 'incidentreporting-label-outage-formatted', $data->i_outage_visible )->parse()\n+\t\t\t\t'default' => wfMessage( 'incidentreporting-label-outage-formatted', $data->i_outage_visible )->text()\n \t\t\t],\n \t\t\t'outage-total' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-outage-total',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'default' => wfMessage( 'incidentreporting-label-outage-formatted', $data->i_outage_total )->parse()\n+\t\t\t\t'default' => wfMessage( 'incidentreporting-label-outage-formatted', $data->i_outage_total )->text()\n \t\t\t],\n \t\t\t'cause' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-cause',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'default' => wfMessage( \"incidentreporting-label-{$data->i_cause}\" )->parse(),\n+\t\t\t\t'default' => wfMessage( \"incidentreporting-label-{$data->i_cause}\" )->text(),\n \t\t\t],\n \t\t\t'aggravation' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-aggravation',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'raw' => true,\n-\t\t\t\t'default' => $data->i_aggravation ?? wfMessage( 'incidentreporting-label-na' )->parse()\n+\t\t\t\t'default' => $data->i_aggravation ?? wfMessage( 'incidentreporting-label-na' )->text()\n \t\t\t],\n \t\t\t'known' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-known',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'raw' => true,\n-\t\t\t\t'default' => $data->i_known ?? wfMessage( 'incidentreporting-label-na' )->parse()\n+\t\t\t\t'default' => $data->i_known ?? wfMessage( 'incidentreporting-label-na' )->text()\n \t\t\t],\n \t\t\t'preventable' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-preventable',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'raw' => true,\n-\t\t\t\t'default' => $data->i_preventable ?? wfMessage( 'incidentreporting-label-na' )->parse()\n+\t\t\t\t'default' => $data->i_preventable ?? wfMessage( 'incidentreporting-label-na' )->text()\n \t\t\t],\n \t\t\t'other' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-other',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'raw' => true,\n-\t\t\t\t'default' => $data->i_other ?? wfMessage( 'incidentreporting-label-na' )->parse()\n+\t\t\t\t'default' => $data->i_other ?? wfMessage( 'incidentreporting-label-na' )->text()\n \t\t\t],\n \t\t\t'responders' => [\n \t\t\t\t'type' => 'info',\n@@ -270,14 +263,14 @@ public function getFormDescriptor(\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-reviewers',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'default' => wfMessage( 'incidentreporting-label-reviewers-info', $reviewers['reviewed'], $reviewers['unreviewed'] )->parse(),\n+\t\t\t\t'default' => wfMessage( 'incidentreporting-label-reviewers-info' )->rawParams( $reviewers['reviewed'], $reviewers['unreviewed'] )->parse(),\n \t\t\t\t'raw' => true\n \t\t\t],\n \t\t\t'published' => [\n \t\t\t\t'type' => 'info',\n \t\t\t\t'label-message' => 'incidentreporting-label-published',\n \t\t\t\t'section' => 'main',\n-\t\t\t\t'default' => ( $data->i_published !== null ) ? wfTimestamp( TS_RFC2822, (int)$data->i_published ) : wfMessage( 'incidentreporting-label-notpublished' )->parse()\n+\t\t\t\t'default' => ( $data->i_published !== null ) ? wfTimestamp( TS_RFC2822, (int)$data->i_published ) : wfMessage( 'incidentreporting-label-notpublished' )->text()\n \t\t\t]\n \t\t];\n \n@@ -310,7 +303,7 @@ public function getFormDescriptor(\n \t\t\t\tforeach ( $logData as $ldata ) {\n \t\t\t\t\t$buildLog[$ldata->log_id] = [\n \t\t\t\t\t\t'type' => 'info',\n-\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-header', $ldata->log_actor, wfTimestamp( TS_RFC2822, (int)$ldata->log_timestamp ), $ldata->log_state ),\n+\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-header', $ldata->log_actor, wfTimestamp( TS_RFC2822, (int)$ldata->log_timestamp ), $ldata->log_state )->text(),\n \t\t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t\t'subsection' => (string)$ldata->log_id,\n \t\t\t\t\t\t'raw' => true,\n@@ -332,18 +325,18 @@ public function getFormDescriptor(\n \n \t\t\t\t\t$buildLog[\"{$logId}-timestamp\"] = [\n \t\t\t\t\t\t'type' => 'datetime',\n-\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-timestamp', $logId )->parse(),\n+\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-timestamp', $logId )->text(),\n \t\t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t\t'subsection' => (string)$logId,\n \t\t\t\t\t\t'default' => wfTimestamp( TS_ISO_8601, (int)$ldata->log_timestamp )\n \t\t\t\t\t];\n \n \t\t\t\t\t$buildLog[\"{$logId}-actor\"] = [\n \t\t\t\t\t\t'type' => 'select',\n-\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-actor', $logId )->parse(),\n+\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-actor', $logId )->text(),\n \t\t\t\t\t\t'options' => [\n-\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-information' )->parse() => 'information',\n-\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-user' )->parse() => 'user'\n+\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-information' )->text() => 'information',\n+\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-user' )->text() => 'user'\n \t\t\t\t\t\t],\n \t\t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t\t'subsection' => (string)$logId,\n@@ -352,7 +345,7 @@ public function getFormDescriptor(\n \n \t\t\t\t\t$buildLog[\"{$logId}-user\"] = [\n \t\t\t\t\t\t'type' => 'user',\n-\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-user', $logId )->parse(),\n+\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-user', $logId )->text(),\n \t\t\t\t\t\t'exists' => true,\n \t\t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t\t'subsection' => (string)$logId,\n@@ -361,19 +354,19 @@ public function getFormDescriptor(\n \t\t\t\t\t];\n \t\t\t\t\t$buildLog[\"{$logId}-action\"] = [\n \t\t\t\t\t\t'type' => 'text',\n-\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-action', $logId )->parse(),\n+\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-action', $logId )->text(),\n \t\t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t\t'subsection' => (string)$logId,\n \t\t\t\t\t\t'default' => $ldata->log_action,\n \t\t\t\t\t];\n \n \t\t\t\t\t$buildLog[\"{$logId}-state\"] = [\n \t\t\t\t\t\t'type' => 'select',\n-\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-state', $logId )->parse(),\n+\t\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-state', $logId )->text(),\n \t\t\t\t\t\t'options' => [\n-\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-up' )->parse() => 'up',\n-\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-partial' )->parse() => 'partial',\n-\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-down' )->parse() => 'down'\n+\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-up' )->text() => 'up',\n+\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-partial' )->text() => 'partial',\n+\t\t\t\t\t\t\twfMessage( 'incidentreporting-log-down' )->text() => 'down'\n \t\t\t\t\t\t],\n \t\t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t\t'subsection' => (string)$logId,\n@@ -385,25 +378,25 @@ public function getFormDescriptor(\n \t\t\tfor ( $newId = $logId + 1; $newId <= $logId + 10; $newId++ ) {\n \t\t\t\t$buildLog[\"{$newId}-timestamp\"] = [\n \t\t\t\t\t'type' => 'datetime',\n-\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-timestamp', $newId )->parse(),\n+\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-timestamp', $newId )->text(),\n \t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t'subsection' => (string)$newId\n \t\t\t\t];\n \n \t\t\t\t$buildLog[\"{$newId}-actor\"] = [\n \t\t\t\t\t'type' => 'select',\n-\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-actor', $newId )->parse(),\n+\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-actor', $newId )->text(),\n \t\t\t\t\t'options' => [\n-\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-information' )->parse() => 'information',\n-\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-user' )->parse() => 'user'\n+\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-information' )->text() => 'information',\n+\t\t\t\t\t\twfMessage( 'incidentreporting-log-actor-user' )->text() => 'user'\n \t\t\t\t\t],\n \t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t'subsection' => (string)$newId\n \t\t\t\t];\n \n \t\t\t\t$buildLog[\"{$newId}-user\"] = [\n \t\t\t\t\t'type' => 'user',\n-\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-user', $newId )->parse(),\n+\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-user', $newId )->text(),\n \t\t\t\t\t'exists' => true,\n \t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t'subsection' => (string)$newId,\n@@ -412,17 +405,17 @@ public function getFormDescriptor(\n \n \t\t\t\t$buildLog[\"{$newId}-action\"] = [\n \t\t\t\t\t'type' => 'text',\n-\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-action', $newId )->parse(),\n+\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-action', $newId )->text(),\n \t\t\t\t\t'section' => 'logs'\n \t\t\t\t];\n \n \t\t\t\t$buildLog[\"{$newId}-state\"] = [\n \t\t\t\t\t'type' => 'select',\n-\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-state', $newId )->parse(),\n+\t\t\t\t\t'label' => wfMessage( 'incidentreporting-log-state', $newId )->text(),\n \t\t\t\t\t'options' => [\n-\t\t\t\t\t\twfMessage( 'incidentreporting-log-up' )->parse() => 'up',\n-\t\t\t\t\t\twfMessage( 'incidentreporting-log-partial' )->parse() => 'partial',\n-\t\t\t\t\t\twfMessage( 'incidentreporting-log-down' )->parse() => 'down'\n+\t\t\t\t\t\twfMessage( 'incidentreporting-log-up' )->text() => 'up',\n+\t\t\t\t\t\twfMessage( 'incidentreporting-log-partial' )->text() => 'partial',\n+\t\t\t\t\t\twfMessage( 'incidentreporting-log-down' )->text() => 'down'\n \t\t\t\t\t],\n \t\t\t\t\t'section' => 'logs',\n \t\t\t\t\t'subsection' => (string)$newId\n@@ -442,7 +435,7 @@ public function getFormDescriptor(\n \t\t\t$tasks = [];\n \n \t\t\tforeach ( $aArray as $task ) {\n-\t\t\t\t$tasks[] = '<a href=\"' . $this->config->get( 'IncidentReportingTaskUrl' ) . $task . '\">' . $task . '</a>';\n+\t\t\t\t$tasks[] = Html::element( 'a', [ 'href' => $this->config->get( 'IncidentReportingTaskUrl' ) . $task ], $task );\n \t\t\t}\n \n \t\t\t$viewDescriptor['actionables'] = [\n@@ -463,14 +456,14 @@ public function getFormDescriptor(\n \n \t\t$buildDescriptor[$action] = [\n \t\t\t'type' => 'submit',\n-\t\t\t'default' => wfMessage( \"incidentreporting-{$action}\" )->parse(),\n+\t\t\t'default' => wfMessage( \"incidentreporting-{$action}\" )->text(),\n \t\t\t'section' => 'main'\n \t\t];\n \n \t\tif ( $this->permissionManager->userHasRight( $context->getUser(), 'editincidents' ) ) {\n \t\t\t$viewDescriptor['view'] = [\n \t\t\t\t'type' => 'submit',\n-\t\t\t\t'default' => wfMessage( 'incidentreporting-view' )->parse(),\n+\t\t\t\t'default' => wfMessage( 'incidentreporting-view' )->text(),\n \t\t\t\t'section' => 'main'\n \t\t\t];\n \t\t}"
        },
        {
          "filename": "includes/IncidentReportingPager.php",
          "status": "modified",
          "additions": 5,
          "deletions": 5,
          "patch": "@@ -38,9 +38,9 @@ public function __construct( $type, $component, $services ) {\n \t\tstatic::$services = $irServices;\n \n \t\tstatic::$causes = [\n-\t\t\t'human' => $this->msg( 'incidentreporting-label-human' )->parse(),\n-\t\t\t'technical' => $this->msg( 'incidentreporting-label-technical' )->parse(),\n-\t\t\t'upstream' => $this->msg( 'incidentreporting-label-upstream' )->parse()\n+\t\t\t'human' => $this->msg( 'incidentreporting-label-human' )->escaped(),\n+\t\t\t'technical' => $this->msg( 'incidentreporting-label-technical' )->escaped(),\n+\t\t\t'upstream' => $this->msg( 'incidentreporting-label-upstream' )->escaped()\n \t\t];\n \t}\n \n@@ -56,7 +56,7 @@ public function getFieldNames() {\n \t\t];\n \n \t\tforeach ( $headers as &$msg ) {\n-\t\t\t$msg = $this->msg( $msg )->parse();\n+\t\t\t$msg = $this->msg( $msg )->text();\n \t\t}\n \n \t\treturn $headers;\n@@ -71,7 +71,7 @@ public function formatValue( $name, $value ) {\n \t\t\t\tbreak;\n \t\t\tcase 'i_service':\n \t\t\t\t$service = $row->i_service;\n-\t\t\t\t$formatted = ( static::$services[$service]['url'] ) ? Linker::makeExternalLink( static::$services[$service]['url'], static::$services[$service]['name'] ) : static::$services[$service]['name'];\n+\t\t\t\t$formatted = ( static::$services[$service]['url'] ) ? Linker::makeExternalLink( static::$services[$service]['url'], static::$services[$service]['name'] ) : htmlspecialchars( static::$services[$service]['name'], ENT_QUOTES );\n \t\t\t\tbreak;\n \t\t\tcase 'i_cause':\n \t\t\t\t$formatted = static::$causes[$row->i_cause];"
        },
        {
          "filename": "includes/SpecialIncidentReports.php",
          "status": "modified",
          "additions": 12,
          "deletions": 12,
          "patch": "@@ -81,9 +81,9 @@ public function showLanding( DBConnRef $dbw ) {\n \t\t$quantity = $this->getRequest()->getText( 'quantity' );\n \n \t\t$types = [\n-\t\t\t$this->msg( 'incidentreporting-label-human' )->parse() => 'human',\n-\t\t\t$this->msg( 'incidentreporting-label-technical' )->parse() => 'technical',\n-\t\t\t$this->msg( 'incidentreporting-label-upstream' )->parse() => 'upstream',\n+\t\t\t$this->msg( 'incidentreporting-label-human' )->text() => 'human',\n+\t\t\t$this->msg( 'incidentreporting-label-technical' )->text() => 'technical',\n+\t\t\t$this->msg( 'incidentreporting-label-upstream' )->text() => 'upstream',\n \t\t];\n \n \t\t$irServices = [];\n@@ -100,12 +100,12 @@ public function showLanding( DBConnRef $dbw ) {\n \t\t\t$irServices[$service] = $niceName;\n \t\t}\n \n-\t\t$showAll = [ $this->msg( 'incidentreporting-table-all' )->parse() => '' ];\n+\t\t$showAll = [ $this->msg( 'incidentreporting-table-all' )->text() => '' ];\n \n \t\t$formDescriptor = [\n \t\t\t'info' => [\n \t\t\t\t'type' => 'info',\n-\t\t\t\t'default' => $this->msg( 'incidentreporting-header-info' )->parse(),\n+\t\t\t\t'default' => $this->msg( 'incidentreporting-header-info' )->text(),\n \t\t\t],\n \t\t\t'type' => [\n \t\t\t\t'type' => 'select',\n@@ -130,8 +130,8 @@ public function showLanding( DBConnRef $dbw ) {\n \t\t\t'statistics-selector' => [\n \t\t\t\t'type' => 'select',\n \t\t\t\t'options' => [\n-\t\t\t\t\t$this->msg( 'incidentreporting-stats-type' )->parse() => 'type',\n-\t\t\t\t\t$this->msg( 'incidentreporting-stats-component' )->parse() => 'component',\n+\t\t\t\t\t$this->msg( 'incidentreporting-stats-type' )->text() => 'type',\n+\t\t\t\t\t$this->msg( 'incidentreporting-stats-component' )->text() => 'component',\n \t\t\t\t],\n \t\t\t\t'hide-if' => [ '!==', 'statistics', '1' ],\n \t\t\t\t'default' => $selector,\n@@ -140,9 +140,9 @@ public function showLanding( DBConnRef $dbw ) {\n \t\t\t'statistics-quantity' => [\n \t\t\t\t'type' => 'select',\n \t\t\t\t'options' => [\n-\t\t\t\t\t$this->msg( 'incidentreporting-stats-number' )->parse() => 'num',\n-\t\t\t\t\t$this->msg( 'incidentreporting-stats-visible' )->parse() => 'visible',\n-\t\t\t\t\t$this->msg( 'incidentreporting-stats-total' )->parse() => 'total'\n+\t\t\t\t\t$this->msg( 'incidentreporting-stats-number' )->text() => 'num',\n+\t\t\t\t\t$this->msg( 'incidentreporting-stats-visible' )->text() => 'visible',\n+\t\t\t\t\t$this->msg( 'incidentreporting-stats-total' )->text() => 'total'\n \t\t\t\t],\n \t\t\t\t'hide-if' => [ '!==', 'statistics', '1' ],\n \t\t\t\t'default' => $quantity,\n@@ -199,7 +199,7 @@ public function showLanding( DBConnRef $dbw ) {\n \t\t\t\t\t\t\t]\n \t\t\t\t\t\t);\n \n-\t\t\t\t\t\t$minutes = $this->msg( 'incidentreporting-label-outage-formatted', array_sum( $statsData ) )->parse();\n+\t\t\t\t\t\t$minutes = $this->msg( 'incidentreporting-label-outage-formatted', array_sum( $statsData ) )->text();\n \n \t\t\t\t\t\t$formDescriptor += [\n \t\t\t\t\t\t\t\"statistics-out-quantity-{$key}\" => [\n@@ -227,7 +227,7 @@ public function showLanding( DBConnRef $dbw ) {\n \t\t\t\t\t);\n \n \t\t\t\t\t$label = array_flip( $foreach )[$key];\n-\t\t\t\t\t$minutes = $this->msg( 'incidentreporting-label-outage-formatted', array_sum( $statsData ) )->parse();\n+\t\t\t\t\t$minutes = $this->msg( 'incidentreporting-label-outage-formatted', array_sum( $statsData ) )->text();\n \n \t\t\t\t\t$formDescriptor += [\n \t\t\t\t\t\t\"statistics-out-quantity-{$key}\" => ["
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b35056bad884b97865dffac66d2673d61a7387d0",
            "date": "2024-11-25T12:10:46Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "cb84173ba79ebc31329b55cdb8939b53e31d572b",
            "date": "2024-11-19T20:38:58Z",
            "author_login": "Universal-Omega"
          },
          {
            "sha": "092074e5e17901ed0ee7cf965b67b4973955e226",
            "date": "2024-11-05T14:27:03Z",
            "author_login": "translatewiki"
          },
          {
            "sha": "bc3f9f8a84fb9e480d3c3a60568cb75e33516290",
            "date": "2024-10-29T23:48:16Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "fd711fe4d1d1300e8e703217112912e52ba1ab2f",
            "date": "2024-10-24T16:53:55Z",
            "author_login": "Universal-Omega"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:H/A:L",
    "cwe_id": "CWE-79",
    "description": "IncidentReporting is a MediaWiki extension for moving incident reports from wikitext to database tables. There are a variety of Cross-site Scripting issues, though all of them require elevated permissions. Some are available to anyone who has the `editincidents` right, some are available to those who can edit interface messages (typically administrators and interface admins), and one is available to those who can edit LocalSettings.php. These issues have been addressed in commit `43896a4` and all users are advised to upgrade. Users unable to upgrade should prevent access to the Special:IncidentReports page.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-09T19:15:14.023",
    "last_modified": "2024-10-10T12:51:56.987",
    "fix_date": "2024-10-09T02:08:13Z"
  },
  "references": [
    {
      "url": "https://github.com/miraheze/IncidentReporting/commit/43896a47de4e05ac94ec0472c220da944da16c5c",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/miraheze/IncidentReporting/security/advisories/GHSA-9p36-hrmr-98r9",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://issue-tracker.miraheze.org/T12702",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.124386",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "IncidentReporting",
    "owner": "miraheze",
    "created_at": "2019-02-16T02:20:56Z",
    "updated_at": "2024-11-25T12:10:51Z",
    "pushed_at": "2025-01-09T22:19:01Z",
    "size": 729,
    "stars": 1,
    "forks": 5,
    "open_issues": 2,
    "watchers": 1,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 33787,
      "JavaScript": 3415,
      "Less": 2504
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:10:02.688826"
  }
}