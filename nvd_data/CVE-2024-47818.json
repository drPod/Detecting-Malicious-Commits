{
  "cve_id": "CVE-2024-47818",
  "github_data": {
    "repository": "saltcorn/saltcorn",
    "fix_commit": "3c551261d0e230635774798009951fa83a07cc3a",
    "related_commits": [
      "3c551261d0e230635774798009951fa83a07cc3a"
    ],
    "patch_url": "https://github.com/saltcorn/saltcorn/commit/3c551261d0e230635774798009951fa83a07cc3a.patch",
    "fix_commit_details": {
      "sha": "3c551261d0e230635774798009951fa83a07cc3a",
      "commit_date": "2024-10-06T17:21:38Z",
      "author": {
        "login": "glutamate",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 106,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "packages/server/routes/eventlog.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -41,6 +41,7 @@ const {\n   i,\n   th,\n   pre,\n+  text,\n } = require(\"@saltcorn/markup/tags\");\n const Table = require(\"@saltcorn/data/models/table\");\n const { send_events_page } = require(\"../markup/admin.js\");\n@@ -442,7 +443,7 @@ router.get(\n           ) +\n           div(\n             { class: \"eventpayload\" },\n-            ev.payload ? pre(JSON.stringify(ev.payload, null, 2)) : \"\"\n+            ev.payload ? pre(text(JSON.stringify(ev.payload, null, 2))) : \"\"\n           ),\n       },\n     });"
        },
        {
          "filename": "packages/server/routes/sync.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -335,13 +335,14 @@ router.post(\n   \"/clean_sync_dir\",\n   error_catcher(async (req, res) => {\n     const { dir_name } = req.body;\n+    const safe_dir_name = File.normalize(dir_name);\n     try {\n       const rootFolder = await File.rootFolder();\n       const syncDir = path.join(\n         rootFolder.location,\n         \"mobile_app\",\n         \"sync\",\n-        dir_name\n+        safe_dir_name\n       );\n       await fs.rm(syncDir, { recursive: true, force: true });\n       res.status(200).send(\"\");"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "5120414af1cb790ce4df253c8abc2bf2f9a499e6",
            "date": "2025-01-13T21:32:35Z",
            "author_login": "glutamate"
          },
          {
            "sha": "76d38ffa93afca1446e79dedcaaaa53987bad908",
            "date": "2025-01-13T21:31:55Z",
            "author_login": "St0rml"
          },
          {
            "sha": "c6521755126b42cc06ab94e7ee3280030f87cc54",
            "date": "2025-01-12T15:04:25Z",
            "author_login": "glutamate"
          },
          {
            "sha": "cf5bdfe53ce53dfe8b583811d9010bbce324dcf8",
            "date": "2025-01-11T14:59:27Z",
            "author_login": "glutamate"
          },
          {
            "sha": "6685c58ebc36b72f239eaaf44f2de674335b7ccf",
            "date": "2025-01-10T11:03:49Z",
            "author_login": "glutamate"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-22",
    "description": "Saltcorn is an extensible, open source, no-code database application builder. A logged-in user with any role can delete arbitrary files on the filesystem by calling the `sync/clean_sync_dir` endpoint. The `dir_name` POST parameter is not validated/sanitized and is used to construct the `syncDir` that is deleted by calling `fs.rm`. This issue has been addressed in release version 1.0.0-beta16 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-07T22:15:04.037",
    "last_modified": "2024-10-10T12:57:21.987",
    "fix_date": "2024-10-06T17:21:38Z"
  },
  "references": [
    {
      "url": "https://github.com/saltcorn/saltcorn/blob/v1.0.0-beta.15/packages/server/routes/sync.js#L337-L346",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/saltcorn/saltcorn/commit/3c551261d0e230635774798009951fa83a07cc3a",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/saltcorn/saltcorn/security/advisories/GHSA-43f3-h63w-p6f6",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.119206",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "saltcorn",
    "owner": "saltcorn",
    "created_at": "2020-03-24T14:31:21Z",
    "updated_at": "2025-01-13T21:32:39Z",
    "pushed_at": "2025-01-14T10:50:20Z",
    "size": 119371,
    "stars": 1737,
    "forks": 296,
    "open_issues": 519,
    "watchers": 1737,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "JavaScript": 3726939,
      "TypeScript": 1584703,
      "CSS": 60671,
      "Python": 41038,
      "Svelte": 24685,
      "HTML": 12832,
      "Shell": 11575,
      "Swift": 11334,
      "Dockerfile": 1727,
      "Batchfile": 36
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:04:38.768321"
  }
}