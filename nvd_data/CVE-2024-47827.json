{
  "cve_id": "CVE-2024-47827",
  "github_data": {
    "repository": "argoproj/argo-workflows",
    "fix_commit": "524406451f4dfa57bf3371fb85becdb56a2b309a",
    "related_commits": [
      "524406451f4dfa57bf3371fb85becdb56a2b309a"
    ],
    "patch_url": "https://github.com/argoproj/argo-workflows/commit/524406451f4dfa57bf3371fb85becdb56a2b309a.patch",
    "fix_commit_details": {
      "sha": "524406451f4dfa57bf3371fb85becdb56a2b309a",
      "commit_date": "2024-09-23T09:25:24Z",
      "author": {
        "login": "meln5674",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: Prevent data race from global metrics round-tripper (#13641)",
        "length": 121,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 8,
        "deletions": 6
      },
      "files": [
        {
          "filename": "workflow/metrics/metrics_k8s_request.go",
          "status": "modified",
          "additions": 8,
          "deletions": 6,
          "patch": "@@ -38,15 +38,19 @@ func addK8sRequests(_ context.Context, m *Metrics) error {\n \treturn err\n }\n \n+type metricsRoundTripperContext struct {\n+\tctx     context.Context\n+\tmetrics *Metrics\n+}\n+\n type metricsRoundTripper struct {\n-\tctx          context.Context\n+\t*metricsRoundTripperContext\n \troundTripper http.RoundTripper\n-\tmetrics      *Metrics\n }\n \n // This is a messy global as we need to register as a roundtripper before\n // we can instantiate metrics\n-var k8sMetrics metricsRoundTripper\n+var k8sMetrics metricsRoundTripperContext\n \n func (m metricsRoundTripper) RoundTrip(r *http.Request) (*http.Response, error) {\n \tstartTime := time.Now()\n@@ -71,9 +75,7 @@ func AddMetricsTransportWrapper(ctx context.Context, config *rest.Config) *rest.\n \t\tif wrap != nil {\n \t\t\trt = wrap(rt)\n \t\t}\n-\t\tk8sMetrics.ctx = ctx\n-\t\tk8sMetrics.roundTripper = rt\n-\t\treturn &k8sMetrics\n+\t\treturn &metricsRoundTripper{roundTripper: rt, metricsRoundTripperContext: &k8sMetrics}\n \t}\n \treturn config\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a7a72e7ca3c2bbf127b65fdcf1b5b85fbd2aad19",
            "date": "2025-01-10T10:28:07Z",
            "author_login": "Joibel"
          },
          {
            "sha": "09d5ee75ed1cf480e4a8c2663256a4b12db720da",
            "date": "2025-01-09T23:26:50Z",
            "author_login": "isubasinghe"
          },
          {
            "sha": "e088cfc66e6bf263d273b20d15a7e6722ff4e3ea",
            "date": "2025-01-08T06:02:20Z",
            "author_login": "Unperceivable"
          },
          {
            "sha": "2ece85c23646574434518a3ffb2236f2162f58b1",
            "date": "2025-01-07T04:50:31Z",
            "author_login": "tczhao"
          },
          {
            "sha": "82537a7737028a0a2ee579f7d8d1e54dabcf6481",
            "date": "2025-01-06T22:13:50Z",
            "author_login": "chengjoey"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 5.7,
    "cvss_vector": "CVSS:3.1/AV:A/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-362",
    "description": "Argo Workflows is an open source container-native workflow engine for orchestrating parallel jobs on Kubernetes. Due to a race condition in a global variable in 3.6.0-rc1, the argo workflows controller can be made to crash on-command by any user with access to execute a workflow. This vulnerability is fixed in 3.6.0-rc2.",
    "attack_vector": "ADJACENT_NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-28T16:15:03.990",
    "last_modified": "2024-11-05T16:50:27.330",
    "fix_date": "2024-09-23T09:25:24Z"
  },
  "references": [
    {
      "url": "https://github.com/argoproj/argo-workflows/blob/ce7f9bfb9b45f009b3e85fabe5e6410de23c7c5f/workflow/metrics/metrics_k8s_request.go#L75",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/argoproj/argo-workflows/commit/524406451f4dfa57bf3371fb85becdb56a2b309a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/argoproj/argo-workflows/pull/13641",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/argoproj/argo-workflows/security/advisories/GHSA-ghjw-32xw-ffwr",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:27.100323",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "argo-workflows",
    "owner": "argoproj",
    "created_at": "2017-08-21T18:50:44Z",
    "updated_at": "2025-01-14T13:18:20Z",
    "pushed_at": "2025-01-10T10:28:07Z",
    "size": 153349,
    "stars": 15249,
    "forks": 3226,
    "open_issues": 1120,
    "watchers": 15249,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "1.0",
      "1.1",
      "main",
      "release-2.0",
      "release-2.1",
      "release-2.2",
      "release-2.3",
      "release-2.4",
      "release-2.5",
      "release-2.6",
      "release-2.7",
      "release-2.8",
      "release-2.9",
      "release-2.10",
      "release-2.11",
      "release-2.12",
      "release-2.12.1",
      "release-2.12.4"
    ],
    "languages": {
      "Go": 4336834,
      "TypeScript": 695528,
      "Nix": 110538,
      "Makefile": 40782,
      "SCSS": 37320,
      "Shell": 16717,
      "JavaScript": 4234,
      "Dockerfile": 3977,
      "Python": 3639,
      "Java": 2559,
      "HTML": 472
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T13:24:53.168255"
  }
}