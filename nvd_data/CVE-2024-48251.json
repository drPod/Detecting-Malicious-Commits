{
  "cve_id": "CVE-2024-48251",
  "github_data": {
    "repository": "wavelog/wavelog",
    "fix_commit": "0bf2675d93602b591850790c8fcfced886eca423",
    "related_commits": [
      "0bf2675d93602b591850790c8fcfced886eca423"
    ],
    "patch_url": "https://github.com/wavelog/wavelog/commit/0bf2675d93602b591850790c8fcfced886eca423.patch",
    "fix_commit_details": {
      "sha": "0bf2675d93602b591850790c8fcfced886eca423",
      "commit_date": "2024-09-12T15:54:37Z",
      "author": {
        "login": "int2001",
        "type": "User",
        "stats": {
          "total_commits": 1403,
          "average_weekly_commits": 5.416988416988417,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 77
        }
      },
      "commit_message": {
        "title": "Replace evil SQLs with bindings",
        "length": 31,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 63,
        "additions": 33,
        "deletions": 30
      },
      "files": [
        {
          "filename": "application/models/Stations.php",
          "status": "modified",
          "additions": 33,
          "deletions": 30,
          "patch": "@@ -461,35 +461,38 @@ function stations_with_hrdlog_code() {\n     }\n \n     function stations_with_qrz_api_key() {\n-       $sql = \"SELECT station_profile.station_id, station_profile.station_profile_name, station_profile.station_callsign, modc.modcount, notc.notcount, totc.totcount\n-                FROM station_profile\n-                LEFT OUTER JOIN (\n-                            SELECT count(*) modcount, station_id\n-                    FROM \". $this->config->item('table_name') .\n-                    \" WHERE COL_QRZCOM_QSO_UPLOAD_STATUS = 'M'\n-                    group by station_id\n-                ) as modc on station_profile.station_id = modc.station_id\n-                LEFT OUTER JOIN (\n-                            SELECT count(*) notcount, station_id\n-                    FROM \" . $this->config->item('table_name') .\n-                    \" WHERE (coalesce(COL_QRZCOM_QSO_UPLOAD_STATUS, '') = ''\n-                    or COL_QRZCOM_QSO_UPLOAD_STATUS = 'N')\n-                    group by station_id\n-                ) as notc on station_profile.station_id = notc.station_id\n-                LEFT OUTER JOIN (\n-                    SELECT count(*) totcount, station_id\n-                    FROM \" . $this->config->item('table_name') .\n-                    \" WHERE COL_QRZCOM_QSO_UPLOAD_STATUS = 'Y'\n-                    group by station_id\n-                ) as totc on station_profile.station_id = totc.station_id\n-                WHERE coalesce(station_profile.qrzapikey, '') <> ''\n-\t\t\t\t AND station_profile.user_id = \" . $this->session->userdata('user_id');\n-        $query = $this->db->query($sql);\n-\n-        return $query;\n+\t    $bindings=[];\n+\t    $sql = \"SELECT station_profile.station_id, station_profile.station_profile_name, station_profile.station_callsign, modc.modcount, notc.notcount, totc.totcount\n+\t\t    FROM station_profile\n+\t\t    LEFT OUTER JOIN (\n+\t\t\t    SELECT count(*) modcount, station_id\n+\t\t\t    FROM \". $this->config->item('table_name') .\n+\t\t\t    \" WHERE COL_QRZCOM_QSO_UPLOAD_STATUS = 'M'\n+\t\t\t    group by station_id\n+\t\t) as modc on station_profile.station_id = modc.station_id\n+\t\tLEFT OUTER JOIN (\n+\t\t\tSELECT count(*) notcount, station_id\n+\t\t\tFROM \" . $this->config->item('table_name') .\n+\t\t\t\" WHERE (coalesce(COL_QRZCOM_QSO_UPLOAD_STATUS, '') = ''\n+\t\t\tor COL_QRZCOM_QSO_UPLOAD_STATUS = 'N')\n+\t\t\tgroup by station_id\n+\t\t) as notc on station_profile.station_id = notc.station_id\n+\t\tLEFT OUTER JOIN (\n+\t\t\tSELECT count(*) totcount, station_id\n+\t\t\tFROM \" . $this->config->item('table_name') .\n+\t\t\t\" WHERE COL_QRZCOM_QSO_UPLOAD_STATUS = 'Y'\n+\t\t\tgroup by station_id\n+\t\t) as totc on station_profile.station_id = totc.station_id\n+\t\tWHERE coalesce(station_profile.qrzapikey, '') <> ''\n+\t\tAND station_profile.user_id = ?\";\n+\t    $bindings[]=$this->session->userdata('user_id');\n+\t    $query = $this->db->query($sql, $bindings);\n+\n+\t    return $query;\n     }\n \n \tfunction stations_with_webadif_api_key() {\n+\t\t$bindings=[];\n \t\t$sql=\"\n \t\t\tSELECT station_profile.station_id, station_profile.station_profile_name, station_profile.station_callsign, notc.c notcount, totc.c totcount\n \t\t\tFROM station_profile\n@@ -508,15 +511,15 @@ function stations_with_webadif_api_key() {\n \t\t\t) totc ON station_profile.station_id = totc.station_id\n \t\t\tWHERE COALESCE(station_profile.webadifapikey, '') <> ''\n \t\t\tAND COALESCE(station_profile.webadifapiurl, '') <> ''\n-\t\t\tAND station_profile.user_id = %d\n+\t\t\tAND station_profile.user_id = ?\n \t\t\";\n+\t\t$bindings[]=$this->session->userdata('user_id');\n \t\t$sql=sprintf(\n \t\t\t$sql,\n \t\t\t$this->config->item('table_name'),\n-\t\t\t$this->config->item('table_name'),\n-\t\t\t$this->session->userdata('user_id')\n+\t\t\t$this->config->item('table_name')\n \t\t);\n-\t\treturn $this->db->query($sql);\n+\t\treturn $this->db->query($sql,$bindings);\n \t}\n \n     /*"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "e88a5ac220266b46c04b8d0428859b9ff95c188b",
            "date": "2025-01-01T17:12:26Z",
            "author_login": "HB9HIL"
          },
          {
            "sha": "631875eea6731be35baec0200bdc30794c565178",
            "date": "2025-01-01T17:10:36Z",
            "author_login": "invalid-email-address"
          },
          {
            "sha": "b840778e96b57f5783f26be74ef3592c3e0d84bf",
            "date": "2025-01-01T17:10:15Z",
            "author_login": "HB9HIL"
          },
          {
            "sha": "983de9ffc9dd6d36ae629f18f4befd8b7cc66502",
            "date": "2025-01-01T17:04:24Z",
            "author_login": "kikosgc"
          },
          {
            "sha": "3a5988e3168c1709594747746ec85d570a7dcfbb",
            "date": "2025-01-01T17:09:02Z",
            "author_login": "HB9HIL"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-89",
    "description": "Wavelog 1.8.5 allows Activated_gridmap_model.php get_band_confirmed SQL injection via band, sat, propagation, or mode.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-14T15:15:13.857",
    "last_modified": "2024-10-17T18:35:12.280",
    "fix_date": "2024-09-12T15:54:37Z"
  },
  "references": [
    {
      "url": "https://chiggerlor.substack.com/p/unauthenticated-sql-injection-in",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wavelog/wavelog/commit/0bf2675d93602b591850790c8fcfced886eca423",
      "source": "cve@mitre.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://www.wavelog.org",
      "source": "cve@mitre.org",
      "tags": [
        "Product"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:02.141574",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "wavelog",
    "owner": "wavelog",
    "created_at": "2024-01-15T15:37:48Z",
    "updated_at": "2025-01-14T14:38:37Z",
    "pushed_at": "2025-01-14T09:45:30Z",
    "size": 210833,
    "stars": 194,
    "forks": 43,
    "open_issues": 37,
    "watchers": 194,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 7207944,
      "JavaScript": 4019626,
      "CSS": 157948,
      "HTML": 11984,
      "Shell": 9823,
      "Dockerfile": 1997,
      "Hack": 119
    },
    "commit_activity": {
      "total_commits_last_year": 6151,
      "avg_commits_per_week": 118.28846153846153,
      "days_active_last_year": 331
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T18:15:00.209991"
  }
}