{
  "cve_id": "CVE-2024-48336",
  "github_data": {
    "repository": "topjohnwu/Magisk",
    "fix_commit": "c2eb6039579b8a2fb1e11a753cea7662c07bec02",
    "related_commits": [
      "c2eb6039579b8a2fb1e11a753cea7662c07bec02"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c2eb6039579b8a2fb1e11a753cea7662c07bec02",
      "commit_date": "2024-08-20T15:40:52Z",
      "author": {
        "login": "aviraxp",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Require GMS to be system app",
        "length": 84,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 10,
        "deletions": 1
      },
      "files": [
        {
          "filename": "app/shared/src/main/java/com/topjohnwu/magisk/ProviderInstaller.java",
          "status": "modified",
          "additions": 10,
          "deletions": 1,
          "patch": "@@ -1,13 +1,22 @@\n package com.topjohnwu.magisk;\n \n import android.content.Context;\n+import android.content.pm.ApplicationInfo;\n \n public class ProviderInstaller {\n \n+    private static final String GMS_PACKAGE_NAME = \"com.google.android.gms\";\n+\n     public static boolean install(Context context) {\n         try {\n+            // Check if gms is a system app\n+            ApplicationInfo appInfo = context.getPackageManager().getApplicationInfo(GMS_PACKAGE_NAME, 0);\n+            if ((appInfo.flags & ApplicationInfo.FLAG_SYSTEM) == 0) {\n+                return false;\n+            }\n+\n             // Try installing new SSL provider from Google Play Service\n-            Context gms = context.createPackageContext(\"com.google.android.gms\",\n+            Context gms = context.createPackageContext(GMS_PACKAGE_NAME,\n                     Context.CONTEXT_INCLUDE_CODE | Context.CONTEXT_IGNORE_SECURITY);\n             gms.getClassLoader()\n                     .loadClass(\"com.google.android.gms.common.security.ProviderInstallerImpl\")"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 8
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "54428ba415aa10045c9854dcdabbabc9e5702420",
            "date": "2025-01-25T18:24:35Z",
            "author_login": "topjohnwu"
          },
          {
            "sha": "95d1e69d8e21b7258dfe54e60d146a8d220991c2",
            "date": "2025-01-21T05:50:59Z",
            "author_login": "topjohnwu"
          },
          {
            "sha": "a0f13ab49fd9e70b1748998b66cd06acfffb4e99",
            "date": "2025-01-19T10:59:17Z",
            "author_login": "topjohnwu"
          },
          {
            "sha": "c3e840502087a549fe1aba336eb76c2bd05ef5a0",
            "date": "2025-01-19T07:22:44Z",
            "author_login": "topjohnwu"
          },
          {
            "sha": "a93593ea66b1852c308aac7d1eb14eeb8ab7e4e4",
            "date": "2025-01-19T07:24:03Z",
            "author_login": "Pesh4waaa"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
    "cwe_id": "CWE-829",
    "description": "The install() function of ProviderInstaller.java in Magisk App before canary version 27007 does not verify the GMS app before loading it, which allows a local untrusted app with no additional privileges to silently execute arbitrary code in the Magisk app and escalate privileges to root via a crafted package, aka Bug #8279. User interaction is not needed for exploitation.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-04T18:15:05.027",
    "last_modified": "2024-11-04T20:35:10.193",
    "fix_date": "2024-08-20T15:40:52Z"
  },
  "references": [
    {
      "url": "https://github.com/canyie/MagiskEoP",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/topjohnwu/Magisk/commit/c2eb6039579b8a2fb1e11a753cea7662c07bec02",
      "source": "cve@mitre.org",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.200158",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "Magisk",
    "owner": "topjohnwu",
    "created_at": "2016-09-08T12:42:53Z",
    "updated_at": "2025-01-26T01:55:11Z",
    "pushed_at": "2025-01-25T18:24:40Z",
    "size": 60330,
    "stars": 50421,
    "forks": 12987,
    "open_issues": 41,
    "watchers": 50421,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "C++": 499409,
      "Kotlin": 431179,
      "Rust": 262205,
      "Java": 124953,
      "Shell": 67580,
      "Python": 31111,
      "Makefile": 5718,
      "C": 699,
      "AIDL": 255
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-26T07:38:09.972146"
  }
}