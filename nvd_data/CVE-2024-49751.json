{
  "cve_id": "CVE-2024-49751",
  "github_data": {
    "repository": "frappe/press",
    "fix_commit": "5d118a902872d7941f099ad1fb918e2421e79ccd",
    "related_commits": [
      "5d118a902872d7941f099ad1fb918e2421e79ccd"
    ],
    "patch_url": "https://github.com/frappe/press/commit/5d118a902872d7941f099ad1fb918e2421e79ccd.patch",
    "fix_commit_details": {
      "sha": "5d118a902872d7941f099ad1fb918e2421e79ccd",
      "commit_date": "2024-06-29T06:30:08Z",
      "author": {
        "login": "BreadGenie",
        "type": "User",
        "stats": {
          "total_commits": 1648,
          "average_weekly_commits": 6.103703703703704,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 81
        }
      },
      "commit_message": {
        "title": "fix(saas-signup): use clean instead of sanitize",
        "length": 47,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 3,
        "deletions": 3
      },
      "files": [
        {
          "filename": "press/api/saas.py",
          "status": "modified",
          "additions": 3,
          "deletions": 3,
          "patch": "@@ -33,7 +33,7 @@ def account_request(\n \t\"\"\"\n \treturn: Stripe setup intent and AR key if stripe flow, else None\n \t\"\"\"\n-\tfrom frappe.utils import sanitize_html\n+\tfrom frappe.utils.html_utils import clean_html\n \n \temail = email.strip().lower()\n \tfrappe.utils.validate_email_address(email, True)\n@@ -63,8 +63,8 @@ def account_request(\n \t\t\t\t\"subdomain\": subdomain,\n \t\t\t\t\"email\": email,\n \t\t\t\t\"role\": \"Press Admin\",\n-\t\t\t\t\"first_name\": sanitize_html(first_name),\n-\t\t\t\t\"last_name\": sanitize_html(last_name),\n+\t\t\t\t\"first_name\": clean_html(first_name),\n+\t\t\t\t\"last_name\": clean_html(last_name),\n \t\t\t\t\"country\": country,\n \t\t\t\t\"url_args\": url_args or json.dumps({}),\n \t\t\t\t\"send_email\": True,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "22305dcc25aab8aae9e6eeecbab41130fefbe1bd",
            "date": "2025-01-14T11:53:44Z",
            "author_login": "adityahase"
          },
          {
            "sha": "1302a32f152802a1c3d41fbea5d0aff22a2384a2",
            "date": "2025-01-14T11:53:28Z",
            "author_login": "adityahase"
          },
          {
            "sha": "ee2c3a16bc09bb4db19997eeca800105d729723f",
            "date": "2025-01-14T09:10:54Z",
            "author_login": "adityahase"
          },
          {
            "sha": "a77c2c644ba889e475a31b0065d1fe602ad8d6ec",
            "date": "2025-01-14T09:06:57Z",
            "author_login": "adityahase"
          },
          {
            "sha": "470d80c5d3a7b74da6d02229e7752a37c2d93442",
            "date": "2025-01-14T09:03:12Z",
            "author_login": "adityahase"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "Press, a Frappe custom app that runs Frappe Cloud, manages infrastructure, subscription, marketplace, and software-as-a-service (SaaS). Prior to commit 5d118a902872d7941f099ad1fb918e2421e79ccd, a user could inject HTML through SaaS signup inputs. The user who injected the unsafe HTML code would only affect themselves and would not affect other users. Commit 5d118a902872d7941f099ad1fb918e2421e79ccd patches this bug.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-10-23T16:15:10.310",
    "last_modified": "2024-10-25T12:56:36.827",
    "fix_date": "2024-06-29T06:30:08Z"
  },
  "references": [
    {
      "url": "https://github.com/frappe/press/commit/5d118a902872d7941f099ad1fb918e2421e79ccd",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/frappe/press/security/advisories/GHSA-rf69-h96f-rf2j",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:27.076405",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "press",
    "owner": "frappe",
    "created_at": "2019-12-09T06:29:43Z",
    "updated_at": "2025-01-14T11:53:49Z",
    "pushed_at": "2025-01-14T11:53:44Z",
    "size": 37556,
    "stars": 299,
    "forks": 206,
    "open_issues": 402,
    "watchers": 299,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "Python": 2452364,
      "Vue": 1647949,
      "JavaScript": 334630,
      "HTML": 124702,
      "TypeScript": 71383,
      "Dockerfile": 12750,
      "Jinja": 9456,
      "Shell": 7503,
      "CSS": 5957,
      "Vim Script": 142
    },
    "commit_activity": {
      "total_commits_last_year": 3888,
      "avg_commits_per_week": 74.76923076923077,
      "days_active_last_year": 306
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T17:22:44.689072"
  }
}