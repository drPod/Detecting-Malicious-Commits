{
  "cve_id": "CVE-2024-51058",
  "github_data": {
    "repository": "tecnickcom/TCPDF",
    "fix_commit": "bfa7d2b6d455ebf72ebe3d48fbd487ee5a1f6f3b",
    "related_commits": [
      "bfa7d2b6d455ebf72ebe3d48fbd487ee5a1f6f3b"
    ],
    "patch_url": "https://github.com/tecnickcom/TCPDF/commit/bfa7d2b6d455ebf72ebe3d48fbd487ee5a1f6f3b.patch",
    "fix_commit_details": {
      "sha": "bfa7d2b6d455ebf72ebe3d48fbd487ee5a1f6f3b",
      "commit_date": "2024-10-06T10:38:38Z",
      "author": {
        "login": "nicolaasuni",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Forbid access to parent folder in HTML images",
        "length": 45,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 62,
        "additions": 34,
        "deletions": 28
      },
      "files": [
        {
          "filename": "CHANGELOG.TXT",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -1,3 +1,6 @@\n+6.7.6 (2024-10-06)\n+\t- Forbid access to parent folder in HTML images.\n+\n 6.7.5 (2024-04-20)\n \t- Update GitHub actions\n \t- fix: CSV-2024-22640 (#712)"
        },
        {
          "filename": "VERSION",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-6.7.5\n+6.7.6"
        },
        {
          "filename": "composer.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -12,7 +12,7 @@\n         \"barcodes\"\n     ],\n     \"homepage\": \"http://www.tcpdf.org/\",\n-    \"version\": \"6.7.5\",\n+    \"version\": \"6.7.6\",\n     \"license\": \"LGPL-3.0-or-later\",\n     \"authors\": [\n         {"
        },
        {
          "filename": "include/tcpdf_static.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -55,7 +55,7 @@ class TCPDF_STATIC {\n \t * Current TCPDF version.\n \t * @private static\n \t */\n-\tprivate static $tcpdf_version = '6.7.5';\n+\tprivate static $tcpdf_version = '6.7.6';\n \n \t/**\n \t * String alias for total number of pages."
        },
        {
          "filename": "tcpdf.php",
          "status": "modified",
          "additions": 28,
          "deletions": 25,
          "patch": "@@ -1,9 +1,9 @@\n <?php\n //============================================================+\n // File name   : tcpdf.php\n-// Version     : 6.7.5\n+// Version     : 6.7.6\n // Begin       : 2002-08-03\n-// Last Update : 2024-03-18\n+// Last Update : 2024-10-06\n // Author      : Nicola Asuni - Tecnick.com LTD - www.tecnick.com - info@tecnick.com\n // License     : GNU-LGPL v3 (http://www.gnu.org/copyleft/lesser.html)\n // -------------------------------------------------------------------\n@@ -128,7 +128,7 @@\n  * TCPDF project (http://www.tcpdf.org) has been originally derived in 2002 from the Public Domain FPDF class by Olivier Plathey (http://www.fpdf.org), but now is almost entirely rewritten.<br>\n  * @package com.tecnick.tcpdf\n  * @brief PHP class for generating PDF documents without requiring external extensions.\n- * @version 6.7.5\n+ * @version 6.7.6\n  * @author Nicola Asuni - info@tecnick.com\n  * @IgnoreAnnotation(\"protected\")\n  * @IgnoreAnnotation(\"public\")\n@@ -19010,29 +19010,29 @@ protected function openHTMLTagHandler($dom, $key, $cell) {\n \t\t\t\t$this->setLineWidth($hrHeight);\n \n \t\t\t\t$lineStyle = array();\n-                    \t\tif (isset($tag['fgcolor'])) {\n-\t\t                        $lineStyle['color'] = $tag['fgcolor'];\n-                    \t\t}\n+\t\t\t\tif (isset($tag['fgcolor'])) {\n+\t\t\t\t\t$lineStyle['color'] = $tag['fgcolor'];\n+\t\t\t\t}\n \n-                    \t\tif (isset($tag['fgcolor'])) {\n-                        \t\t$lineStyle['color'] = $tag['fgcolor'];\n-                    \t\t}\n+\t\t\t\tif (isset($tag['fgcolor'])) {\n+\t\t\t\t\t$lineStyle['color'] = $tag['fgcolor'];\n+\t\t\t\t}\n \n-                    \t\tif (isset($tag['style']['cap'])) {\n-                        \t\t$lineStyle['cap'] = $tag['style']['cap'];\n-                    \t\t}\n+\t\t\t\tif (isset($tag['style']['cap'])) {\n+\t\t\t\t\t$lineStyle['cap'] = $tag['style']['cap'];\n+\t\t\t\t}\n \n-                    \t\tif (isset($tag['style']['join'])) {\n-                        \t\t$lineStyle['join'] = $tag['style']['join'];\n-                    \t\t}\n+\t\t\t\tif (isset($tag['style']['join'])) {\n+\t\t\t\t\t$lineStyle['join'] = $tag['style']['join'];\n+\t\t\t\t}\n \n-                    \t\tif (isset($tag['style']['dash'])) {\n-                        \t\t$lineStyle['dash'] = $tag['style']['dash'];\n-                    \t\t}\n+\t\t\t\tif (isset($tag['style']['dash'])) {\n+\t\t\t\t\t$lineStyle['dash'] = $tag['style']['dash'];\n+\t\t\t\t}\n \n-                    \t\tif (isset($tag['style']['phase'])) {\n-                        \t\t$lineStyle['phase'] = $tag['style']['phase'];\n-                    \t\t}\n+\t\t\t\tif (isset($tag['style']['phase'])) {\n+\t\t\t\t\t$lineStyle['phase'] = $tag['style']['phase'];\n+\t\t\t\t}\n \n \t\t\t\t$lineStyle = array_filter($lineStyle);\n \n@@ -19059,11 +19059,14 @@ protected function openHTMLTagHandler($dom, $key, $cell) {\n \t\t\t\t} else if (preg_match('@^data:image/([^;]*);base64,(.*)@', $imgsrc, $reg)) {\n \t\t\t\t\t$imgsrc = '@'.base64_decode($reg[2]);\n \t\t\t\t\t$type = $reg[1];\n+\t\t\t\t} elseif (str_contains($imgsrc, '../')) {\n+\t\t\t\t\t// accessing parent folders is not allowed\n+\t\t\t\t\tbreak;\n \t\t\t\t} elseif ( $this->allowLocalFiles && substr($imgsrc, 0, 7) === 'file://') {\n-                    // get image type from a local file path\n-                    $imgsrc = substr($imgsrc, 7);\n-                    $type = TCPDF_IMAGES::getImageFileType($imgsrc);\n-                } else {\n+\t\t\t\t\t// get image type from a local file path\n+\t\t\t\t\t$imgsrc = substr($imgsrc, 7);\n+\t\t\t\t\t$type = TCPDF_IMAGES::getImageFileType($imgsrc);\n+\t\t\t\t} else {\n \t\t\t\t\tif (($imgsrc[0] === '/') AND !empty($_SERVER['DOCUMENT_ROOT']) AND ($_SERVER['DOCUMENT_ROOT'] != '/')) {\n \t\t\t\t\t\t// fix image path\n \t\t\t\t\t\t$findroot = strpos($imgsrc, $_SERVER['DOCUMENT_ROOT']);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "14ffa0e308f5634aa2489568b4b90b24073b6731",
            "date": "2024-12-23T13:34:57Z",
            "author_login": "nicolaasuni"
          },
          {
            "sha": "306bdf9aca751791da708031641c5c1157467182",
            "date": "2024-12-23T13:32:06Z",
            "author_login": "nicolaasuni"
          },
          {
            "sha": "d0f52e184b539e75473f2d7a3a9b5c399c138c7f",
            "date": "2024-12-23T13:31:14Z",
            "author_login": "nicolaasuni"
          },
          {
            "sha": "818abfae4c6ea6b05d3f1f2c5d8718fbdd0f987e",
            "date": "2024-12-23T13:11:44Z",
            "author_login": "nicolaasuni"
          },
          {
            "sha": "a9d32801f1f6f560c43f12a5b0fdee3fd94d9a2d",
            "date": "2024-12-23T13:09:17Z",
            "author_login": "nicolaasuni"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.2,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-552",
    "description": "Local File Inclusion (LFI) vulnerability has been discovered in TCPDF 6.7.5. This vulnerability enables a user to read arbitrary files from the server's file system through <img> src tag, potentially exposing sensitive information.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-26T18:15:19.440",
    "last_modified": "2024-11-26T20:15:33.253",
    "fix_date": "2024-10-06T10:38:38Z"
  },
  "references": [
    {
      "url": "https://github.com/saravana-hackz/vulnerability-research/tree/main/CVE-2024-51058",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/tecnickcom/TCPDF",
      "source": "cve@mitre.org",
      "tags": []
    },
    {
      "url": "https://github.com/tecnickcom/TCPDF/commit/bfa7d2b6d455ebf72ebe3d48fbd487ee5a1f6f3b",
      "source": "cve@mitre.org",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.306521",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "TCPDF",
    "owner": "tecnickcom",
    "created_at": "2014-08-08T08:49:17Z",
    "updated_at": "2025-01-13T08:51:06Z",
    "pushed_at": "2024-12-23T13:37:48Z",
    "size": 68914,
    "stars": 4271,
    "forks": 1532,
    "open_issues": 347,
    "watchers": 4271,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "PHP": 13827941,
      "Shell": 6981
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T13:11:04.927584"
  }
}