{
  "cve_id": "CVE-2024-51752",
  "github_data": {
    "repository": "workos/authkit-nextjs",
    "fix_commit": "15a332632f7560b03cc6d8cc8da24fd2ac931da7",
    "related_commits": [
      "15a332632f7560b03cc6d8cc8da24fd2ac931da7"
    ],
    "patch_url": "https://github.com/workos/authkit-nextjs/commit/15a332632f7560b03cc6d8cc8da24fd2ac931da7.patch",
    "fix_commit_details": {
      "sha": "15a332632f7560b03cc6d8cc8da24fd2ac931da7",
      "commit_date": "2024-11-04T16:09:11Z",
      "author": {
        "login": "PaulAsjes",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update logging strategy (#128)",
        "length": 75,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"@workos-inc/authkit-nextjs\",\n-  \"version\": \"0.13.1\",\n+  \"version\": \"0.13.2\",\n   \"description\": \"Authentication and session helpers for using WorkOS & AuthKit with Next.js\",\n   \"sideEffects\": false,\n   \"type\": \"module\","
        },
        {
          "filename": "src/session.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -120,7 +120,7 @@ async function updateSession(\n   }\n \n   try {\n-    if (debug) console.log('Session invalid. Attempting refresh', session.refreshToken);\n+    if (debug) console.log(`Session invalid. Refreshing access token that ends in ${session.accessToken.slice(-10)}`);\n \n     const { org_id: organizationId } = decodeJwt<AccessToken>(session.accessToken);\n \n@@ -131,7 +131,7 @@ async function updateSession(\n       organizationId,\n     });\n \n-    if (debug) console.log('Refresh successful:', refreshToken);\n+    if (debug) console.log(`Refresh successful. New access token ends in ${accessToken.slice(-10)}`);\n \n     // Encrypt session with new access and refresh tokens\n     const encryptedSession = await encryptSession({"
        },
        {
          "filename": "src/workos.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n import { WorkOS } from '@workos-inc/node';\n import { WORKOS_API_HOSTNAME, WORKOS_API_KEY, WORKOS_API_HTTPS, WORKOS_API_PORT } from './env-variables.js';\n \n-export const VERSION = '0.13.1';\n+export const VERSION = '0.13.2';\n \n const options = {\n   apiHostname: WORKOS_API_HOSTNAME,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ce5f0a356260a372a70a9860d336a4224615ae91",
            "date": "2025-01-14T17:32:06Z",
            "author_login": "PaulAsjes"
          },
          {
            "sha": "5e9ac801ee32737b626e34971130e2274e388f69",
            "date": "2025-01-13T16:31:51Z",
            "author_login": "marji-workos"
          },
          {
            "sha": "2b269cc836fb6625437caa313f92f035e64ae949",
            "date": "2025-01-13T16:00:18Z",
            "author_login": "PaulAsjes"
          },
          {
            "sha": "e20e926849a0f837c7efb0fd94af5e3a8183572b",
            "date": "2025-01-13T10:47:08Z",
            "author_login": "PaulAsjes"
          },
          {
            "sha": "3714fb891a0e59d687d7702719bd8577f6f42357",
            "date": "2025-01-13T10:44:44Z",
            "author_login": "PaulAsjes"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-532",
    "description": "The AuthKit library for Next.js provides convenient helpers for authentication and session management using WorkOS & AuthKit with Next.js. In affected versions refresh tokens are logged to the console when the disabled by default `debug` flag, is enabled. This issue has been patched in version 0.13.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-11-05T20:15:15.167",
    "last_modified": "2024-11-06T18:17:17.287",
    "fix_date": "2024-11-04T16:09:11Z"
  },
  "references": [
    {
      "url": "https://github.com/workos/authkit-nextjs/commit/15a332632f7560b03cc6d8cc8da24fd2ac931da7",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/workos/authkit-nextjs/releases/tag/v0.13.2",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/workos/authkit-nextjs/security/advisories/GHSA-5wmg-9cvh-qw25",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.222924",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "authkit-nextjs",
    "owner": "workos",
    "created_at": "2024-03-15T13:00:41Z",
    "updated_at": "2025-01-13T16:31:55Z",
    "pushed_at": "2025-01-13T16:31:53Z",
    "size": 327,
    "stars": 74,
    "forks": 25,
    "open_issues": 12,
    "watchers": 74,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 105719,
      "JavaScript": 217
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T16:07:08.048888"
  }
}