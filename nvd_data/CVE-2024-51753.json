{
  "cve_id": "CVE-2024-51753",
  "github_data": {
    "repository": "workos/authkit-remix",
    "fix_commit": "32d5bcd54c795c1e2a3204f8e3977ab9ad57ec06",
    "related_commits": [
      "32d5bcd54c795c1e2a3204f8e3977ab9ad57ec06"
    ],
    "patch_url": "https://github.com/workos/authkit-remix/commit/32d5bcd54c795c1e2a3204f8e3977ab9ad57ec06.patch",
    "fix_commit_details": {
      "sha": "32d5bcd54c795c1e2a3204f8e3977ab9ad57ec06",
      "commit_date": "2024-11-04T16:09:47Z",
      "author": {
        "login": "PaulAsjes",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Update logging strategy (#27)",
        "length": 29,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 8,
        "additions": 4,
        "deletions": 4
      },
      "files": [
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n {\n   \"name\": \"@workos-inc/authkit-remix\",\n-  \"version\": \"0.4.0\",\n+  \"version\": \"0.4.1\",\n   \"description\": \"Authentication and session helpers for using WorkOS & AuthKit with Remix\",\n   \"sideEffects\": false,\n   \"type\": \"commonjs\","
        },
        {
          "filename": "src/session.ts",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -27,15 +27,15 @@ async function updateSession(request: Request, debug: boolean) {\n   }\n \n   try {\n-    if (debug) console.log('Session invalid. Attempting refresh', session.refreshToken);\n+    if (debug) console.log(`Session invalid. Refreshing access token that ends in ${session.accessToken.slice(-10)}`);\n \n     // If the session is invalid (i.e. the access token has expired) attempt to re-authenticate with the refresh token\n     const { accessToken, refreshToken } = await workos.userManagement.authenticateWithRefreshToken({\n       clientId: WORKOS_CLIENT_ID,\n       refreshToken: session.refreshToken,\n     });\n \n-    if (debug) console.log('Refresh successful:', refreshToken);\n+    if (debug) console.log(`Refresh successful. New access token ends in ${accessToken.slice(-10)}`);\n \n     const newSession = {\n       accessToken,"
        },
        {
          "filename": "src/workos.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,7 +1,7 @@\n import { WorkOS } from '@workos-inc/node';\n import { WORKOS_API_HOSTNAME, WORKOS_API_HTTPS, WORKOS_API_KEY, WORKOS_API_PORT } from './env-variables.js';\n \n-const VERSION = '0.4.0';\n+const VERSION = '0.4.1';\n \n const options = {\n   apiHostname: WORKOS_API_HOSTNAME,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "a68475bfefb9d3b13b5ae98ba506785a9216e32b",
            "date": "2024-12-12T14:09:51Z",
            "author_login": "PaulAsjes"
          },
          {
            "sha": "cd25a09e1b04e39e0c1bd010038896a817178ad6",
            "date": "2024-12-12T09:10:08Z",
            "author_login": "cosn"
          },
          {
            "sha": "ece92e4d7f475eb718b972b84f7d2f0048449542",
            "date": "2024-12-03T20:25:10Z",
            "author_login": "mthadley"
          },
          {
            "sha": "084e0e5c18e91585d3a941bcddd9db6d6d1ec94b",
            "date": "2024-12-02T20:08:21Z",
            "author_login": "mthadley"
          },
          {
            "sha": "db89c94a5b0fcfab60b623f3d9d159f857a4e609",
            "date": "2024-11-27T16:15:55Z",
            "author_login": "dandorman"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-532",
    "description": "The AuthKit library for Remix provides convenient helpers for authentication and session management using WorkOS & AuthKit with Remix. In affected versions refresh tokens are logged to the console when the disabled by default `debug` flag, is enabled. This issue has been patched in version 0.4.1. All users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-11-05T20:15:15.300",
    "last_modified": "2024-11-06T18:17:17.287",
    "fix_date": "2024-11-04T16:09:47Z"
  },
  "references": [
    {
      "url": "https://github.com/workos/authkit-remix/commit/32d5bcd54c795c1e2a3204f8e3977ab9ad57ec06",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/workos/authkit-remix/releases/tag/v0.4.1",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/workos/authkit-remix/security/advisories/GHSA-v2qh-f584-6hj8",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.223219",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "authkit-remix",
    "owner": "workos",
    "created_at": "2024-06-13T13:57:11Z",
    "updated_at": "2024-12-12T14:09:55Z",
    "pushed_at": "2024-12-12T14:10:16Z",
    "size": 143,
    "stars": 22,
    "forks": 8,
    "open_issues": 9,
    "watchers": 22,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "TypeScript": 17035,
      "JavaScript": 221
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T15:17:28.285347"
  }
}