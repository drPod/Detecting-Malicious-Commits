{
  "cve_id": "CVE-2024-51756",
  "github_data": {
    "repository": "bytecodealliance/cap-std",
    "fix_commit": "dcc3818039761331fbeacbb3a40c542b65b5ebf7",
    "related_commits": [
      "dcc3818039761331fbeacbb3a40c542b65b5ebf7"
    ],
    "patch_url": "https://github.com/bytecodealliance/cap-std/commit/dcc3818039761331fbeacbb3a40c542b65b5ebf7.patch",
    "fix_commit_details": {
      "sha": "dcc3818039761331fbeacbb3a40c542b65b5ebf7",
      "commit_date": "2024-11-05T16:20:08Z",
      "author": {
        "login": "nathaniel-daniel",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Add missing reserved file names (#371)",
        "length": 38,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 6,
        "additions": 4,
        "deletions": 2
      },
      "files": [
        {
          "filename": "cap-primitives/src/windows/fs/open_impl.rs",
          "status": "modified",
          "additions": 4,
          "deletions": 2,
          "patch": "@@ -10,12 +10,14 @@ pub(crate) fn open_impl(\n ) -> io::Result<fs::File> {\n     // Windows reserves several special device paths. Disallow opening any\n     // of them.\n+    // See: https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#naming-conventions\n     if let Some(stem) = path.file_stem() {\n         if let Some(stemstr) = stem.to_str() {\n             match stemstr.to_uppercase().as_str() {\n                 \"CON\" | \"PRN\" | \"AUX\" | \"NUL\" | \"COM0\" | \"COM1\" | \"COM2\" | \"COM3\" | \"COM4\"\n-                | \"COM5\" | \"COM6\" | \"COM7\" | \"COM8\" | \"COM9\" | \"LPT0\" | \"LPT1\" | \"LPT2\"\n-                | \"LPT3\" | \"LPT4\" | \"LPT5\" | \"LPT6\" | \"LPT7\" | \"LPT8\" | \"LPT9\" => {\n+                | \"COM5\" | \"COM6\" | \"COM7\" | \"COM8\" | \"COM9\" | \"COM\u00b9\" | \"COM\u00b2\" | \"COM\u00b3\"\n+                | \"LPT0\" | \"LPT1\" | \"LPT2\" | \"LPT3\" | \"LPT4\" | \"LPT5\" | \"LPT6\" | \"LPT7\"\n+                | \"LPT8\" | \"LPT9\" | \"LPT\u00b9\" | \"LPT\u00b2\" | \"LPT\u00b3\" => {\n                     return Err(io::Error::from_raw_os_error(ERROR_FILE_NOT_FOUND as i32));\n                 }\n                 _ => {}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "4747d7d009da023c3decc68fac487b66b76649ec",
            "date": "2024-12-04T01:51:13Z",
            "author_login": "sunfishcode"
          },
          {
            "sha": "97ff12ebba231511081885fe36b17d174915b688",
            "date": "2024-12-04T01:49:32Z",
            "author_login": "sunfishcode"
          },
          {
            "sha": "0f53e08b91f72e3fa1b44d5346a2089630725318",
            "date": "2024-12-04T00:57:53Z",
            "author_login": "sunfishcode"
          },
          {
            "sha": "3d4542c38c0303acacde26f43938e48525a1c0a5",
            "date": "2024-12-04T00:47:13Z",
            "author_login": "sunfishcode"
          },
          {
            "sha": "cc7d2b9410fe981b6c00f993caf9a733ead3ff71",
            "date": "2024-11-22T01:05:04Z",
            "author_login": "sunfishcode"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "The cap-std project is organized around the eponymous `cap-std` crate, and develops libraries to make it easy to write capability-based code. cap-std's filesystem sandbox implementation on Windows blocks access to special device filenames such as \"COM1\", \"COM2\", \"LPT0\", \"LPT1\", and so on, however it did not block access to the special device filenames which use superscript digits, such as \"COM\u00b9\", \"COM\u00b2\", \"LPT\u2070\", \"LPT\u00b9\", and so on. Untrusted filesystem paths could bypass the sandbox and access devices through those special device filenames with superscript digits, and through them provide access peripheral devices connected to the computer, or network resources mapped to those devices. This can include modems, printers, network printers, and any other device connected to a serial or parallel port, including emulated USB serial ports. The bug is fixed in #371, which is published in cap-primitives 3.4.1, cap-std 3.4.1, and cap-async-std 3.4.1. There are no known workarounds for this issue. Affected Windows users are recommended to upgrade.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-11-05T22:15:21.817",
    "last_modified": "2024-11-21T09:45:56.203",
    "fix_date": "2024-11-05T16:20:08Z"
  },
  "references": [
    {
      "url": "https://en.wikipedia.org/wiki/ISO/IEC_8859-1",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/cap-std/commit/dcc3818039761331fbeacbb3a40c542b65b5ebf7",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/cap-std/pull/371",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/bytecodealliance/cap-std/security/advisories/GHSA-hxf5-99xg-86hw",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://learn.microsoft.com/en-us/windows/win32/fileio/naming-a-file#naming-conventions",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.223686",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cap-std",
    "owner": "bytecodealliance",
    "created_at": "2020-06-25T20:55:02Z",
    "updated_at": "2025-01-09T23:15:56Z",
    "pushed_at": "2024-12-04T01:52:18Z",
    "size": 2521,
    "stars": 667,
    "forks": 32,
    "open_issues": 18,
    "watchers": 667,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Rust": 1305321
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T19:37:23.495187"
  }
}