{
  "cve_id": "CVE-2024-52306",
  "github_data": {
    "repository": "Laravel-Backpack/FileManager",
    "fix_commit": "2830498b85e05fb3c92179053b4d7c4a0fdb880b",
    "related_commits": [
      "2830498b85e05fb3c92179053b4d7c4a0fdb880b"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "2830498b85e05fb3c92179053b4d7c4a0fdb880b",
      "commit_date": "2024-11-05T16:05:02Z",
      "author": {
        "login": "pxpm",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #58 from Laravel-Backpack/fix-json-decode-request-value",
        "length": 90,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 36,
        "additions": 35,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/BackpackElfinderController.php",
          "status": "added",
          "additions": 28,
          "deletions": 0,
          "patch": "@@ -0,0 +1,28 @@\n+<?php\n+\n+namespace Backpack\\FileManager;\n+\n+use Illuminate\\Support\\Facades\\Crypt;\n+use Illuminate\\Support\\Facades\\Log;\n+\n+class BackpackElfinderController extends \\Barryvdh\\Elfinder\\ElfinderController\n+{\n+    public function showPopup($input_id)\n+    {\n+        $mimes = request('mimes');\n+\n+        try {\n+            $mimes = Crypt::decrypt(urldecode(request('mimes')));\n+        } catch (\\Illuminate\\Contracts\\Encryption\\DecryptException $e) {\n+            Log::error('Someone attempted to tamper with mime types in elfinder popup. The attempt was blocked.');\n+            abort(403, 'Unauthorized action.');\n+        }\n+\n+        request()->merge(['mimes' => urlencode(serialize($mimes))]);\n+\n+        return $this->app['view']\n+            ->make($this->package.'::standalonepopup')\n+            ->with($this->getViewVars())\n+            ->with(compact('input_id'));\n+    }\n+}"
        },
        {
          "filename": "src/FileManagerServiceProvider.php",
          "status": "modified",
          "additions": 7,
          "deletions": 1,
          "patch": "@@ -3,13 +3,14 @@\n namespace Backpack\\FileManager;\n \n use Backpack\\Basset\\Facades\\Basset;\n+use Barryvdh\\Elfinder\\ElfinderController;\n use Illuminate\\Support\\Facades\\Config;\n use Illuminate\\Support\\ServiceProvider;\n \n class FileManagerServiceProvider extends ServiceProvider\n {\n     protected $commands = [\n-        \\Backpack\\FileManager\\Console\\Commands\\Install::class,\n+        Console\\Commands\\Install::class,\n     ];\n \n     /**\n@@ -25,6 +26,11 @@ public function boot()\n         }\n     }\n \n+    public function register()\n+    {\n+        $this->app->bind(ElfinderController::class, BackpackElfinderController::class);\n+    }\n+\n     /**\n      * Console-specific booting.\n      *"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "25b5c97084b8a2af67d822c376066e4f4fdb8e85",
            "date": "2024-11-18T13:11:07Z",
            "author_login": "pxpm"
          },
          {
            "sha": "3275e4b6db46a41c803332c67316c88ad0a3cd56",
            "date": "2024-11-18T12:13:46Z",
            "author_login": "pxpm"
          },
          {
            "sha": "d7d729deeaf76803aa911fe501ac30d8e98c6317",
            "date": "2024-11-07T07:25:40Z",
            "author_login": "tabacitu"
          },
          {
            "sha": "2830498b85e05fb3c92179053b4d7c4a0fdb880b",
            "date": "2024-11-05T16:05:02Z",
            "author_login": "pxpm"
          },
          {
            "sha": "4bb4b2422c6bed8c9435fb4bb81b0dc95cb5c734",
            "date": "2024-11-05T11:56:17Z",
            "author_login": "pxpm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.6,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-502",
    "description": "FileManager provides a Backpack admin interface for files and folder. Prior to 3.0.9, deserialization of untrusted data from the mimes parameter could lead to remote code execution. This vulnerability is fixed in 3.0.9.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-11-13T16:15:20.723",
    "last_modified": "2024-11-19T15:02:45.053",
    "fix_date": "2024-11-05T16:05:02Z"
  },
  "references": [
    {
      "url": "https://github.com/Laravel-Backpack/FileManager/commit/2830498b85e05fb3c92179053b4d7c4a0fdb880b",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Laravel-Backpack/FileManager/security/advisories/GHSA-8237-957h-h2c2",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.292156",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "FileManager",
    "owner": "Laravel-Backpack",
    "created_at": "2020-03-21T16:54:35Z",
    "updated_at": "2025-01-14T22:57:54Z",
    "pushed_at": "2025-01-22T15:45:32Z",
    "size": 122,
    "stars": 97,
    "forks": 21,
    "open_issues": 6,
    "watchers": 97,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main",
      "v2"
    ],
    "languages": {
      "PHP": 33684,
      "Blade": 24532,
      "CSS": 4207
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:30:27.715071"
  }
}