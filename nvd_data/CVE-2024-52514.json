{
  "cve_id": "CVE-2024-52514",
  "github_data": {
    "repository": "nextcloud/server",
    "fix_commit": "5fffbcfe8650eab75b00e8d188fbc95b0e43f3a8",
    "related_commits": [
      "5fffbcfe8650eab75b00e8d188fbc95b0e43f3a8"
    ],
    "patch_url": "https://github.com/nextcloud/server/commit/5fffbcfe8650eab75b00e8d188fbc95b0e43f3a8.patch",
    "fix_commit_details": {
      "sha": "5fffbcfe8650eab75b00e8d188fbc95b0e43f3a8",
      "commit_date": "2024-04-18T08:48:03Z",
      "author": {
        "login": "nickvergessen",
        "type": "User",
        "stats": {
          "total_commits": 5084,
          "average_weekly_commits": 6.654450261780105,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 493
        }
      },
      "commit_message": {
        "title": "Merge pull request #44889 from nextcloud/bugfix/noid/skip-cross-storage-move-with-ac",
        "length": 146,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 3,
        "additions": 3,
        "deletions": 0
      },
      "files": [
        {
          "filename": "lib/private/Files/Storage/Local.php",
          "status": "modified",
          "additions": 3,
          "deletions": 0,
          "patch": "@@ -584,11 +584,14 @@ private function calculateEtag(string $path, array $stat): string {\n \t}\n \n \tprivate function canDoCrossStorageMove(IStorage $sourceStorage) {\n+\t\t/** @psalm-suppress UndefinedClass */\n \t\treturn $sourceStorage->instanceOfStorage(Local::class)\n \t\t\t// Don't treat ACLStorageWrapper like local storage where copy can be done directly.\n \t\t\t// Instead, use the slower recursive copying in php from Common::copyFromStorage with\n \t\t\t// more permissions checks.\n \t\t\t&& !$sourceStorage->instanceOfStorage('OCA\\GroupFolders\\ACL\\ACLStorageWrapper')\n+\t\t\t// Same for access control\n+\t\t\t&& !$sourceStorage->instanceOfStorage(\\OCA\\FilesAccessControl\\StorageWrapper::class)\n \t\t\t// when moving encrypted files we have to handle keys and the target might not be encrypted\n \t\t\t&& !$sourceStorage->instanceOfStorage(Encryption::class);\n \t}"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 4
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dd36163bb030efbc2772f0cc7bb350dd6a7d1070",
            "date": "2025-01-14T16:42:35Z",
            "author_login": "Pytal"
          },
          {
            "sha": "93a64d67b58c4def5281c62e97760ae191fd664e",
            "date": "2025-01-14T16:12:36Z",
            "author_login": "ArtificialOwl"
          },
          {
            "sha": "f44f122456205975f3080028b13a7151e815d6bc",
            "date": "2025-01-14T15:42:15Z",
            "author_login": "skjnldsv"
          },
          {
            "sha": "ce5cbd8d364d44a424401d46506c1e007ab3eb6f",
            "date": "2025-01-14T15:25:36Z",
            "author_login": "skjnldsv"
          },
          {
            "sha": "a9a43f3df4f2e56f4d95c62a4577ea2ff663cc19",
            "date": "2025-01-06T07:24:56Z",
            "author_login": "provokateurin"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N",
    "cwe_id": "CWE-284",
    "description": "Nextcloud Server is a self hosted personal cloud system. After a user received a share with some files inside being blocked by the files access control, the user would still be able to copy the intermediate folder inside Nextcloud allowing them to afterwards potentially access the blocked files depending on the user access control rules. It is recommended that the Nextcloud Server is upgraded to 27.1.9, 28.0.5 or 29.0.0 and Nextcloud Enterprise Server is upgraded to 21.0.9.18, 22.2.10.23, 23.0.12.18, 24.0.12.14, 25.0.13.9, 26.0.13.3, 27.1.9, 28.0.5 or 29.0.0.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-15T18:15:30.370",
    "last_modified": "2024-11-18T17:11:56.587",
    "fix_date": "2024-04-18T08:48:03Z"
  },
  "references": [
    {
      "url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-g8pr-g25r-58xj",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/nextcloud/server/commit/5fffbcfe8650eab75b00e8d188fbc95b0e43f3a8",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/nextcloud/server/pull/44889",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://hackerone.com/reports/2447316",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:29.313840",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "server",
    "owner": "nextcloud",
    "created_at": "2016-06-02T07:44:14Z",
    "updated_at": "2025-01-14T12:13:57Z",
    "pushed_at": "2025-01-14T12:17:20Z",
    "size": 4884750,
    "stars": 27939,
    "forks": 4113,
    "open_issues": 2572,
    "watchers": 27939,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "PHP": 22391764,
      "JavaScript": 14448704,
      "Vue": 1226343,
      "TypeScript": 861776,
      "Gherkin": 433358,
      "SCSS": 158244,
      "Shell": 81434,
      "HTML": 64175,
      "CSS": 25415,
      "Handlebars": 3817,
      "Dockerfile": 2908,
      "Makefile": 1649
    },
    "commit_activity": {
      "total_commits_last_year": 6549,
      "avg_commits_per_week": 125.9423076923077,
      "days_active_last_year": 359
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:06:55.727793"
  }
}