{
  "cve_id": "CVE-2024-52798",
  "github_data": {
    "repository": "pillarjs/path-to-regexp",
    "fix_commit": "f01c26a013b1889f0c217c643964513acf17f6a4",
    "related_commits": [
      "f01c26a013b1889f0c217c643964513acf17f6a4"
    ],
    "patch_url": "https://github.com/pillarjs/path-to-regexp/commit/f01c26a013b1889f0c217c643964513acf17f6a4.patch",
    "fix_commit_details": {
      "sha": "f01c26a013b1889f0c217c643964513acf17f6a4",
      "commit_date": "2024-12-05T22:05:02Z",
      "author": {
        "login": "blakeembrey",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 65,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 16,
        "additions": 13,
        "deletions": 3
      },
      "files": [
        {
          "filename": "index.js",
          "status": "modified",
          "additions": 9,
          "deletions": 3,
          "patch": "@@ -72,20 +72,26 @@ function pathToRegexp(path, keys, options) {\n   path = path.replace(\n     /\\\\.|(\\/)?(\\.)?:(\\w+)(\\(.*?\\))?(\\*)?(\\?)?|[.*]|\\/\\(/g,\n     function (match, slash, format, key, capture, star, optional, offset) {\n-      pos = offset + match.length;\n-\n       if (match[0] === '\\\\') {\n         backtrack += match;\n+        pos += 2;\n         return match;\n       }\n \n       if (match === '.') {\n         backtrack += '\\\\.';\n         extraOffset += 1;\n+        pos += 1;\n         return '\\\\.';\n       }\n \n-      backtrack = slash || format ? '' : path.slice(pos, offset);\n+      if (slash || format) {\n+        backtrack = '';\n+      } else {\n+        backtrack += path.slice(pos, offset);\n+      }\n+\n+      pos = offset + match.length;\n \n       if (match === '*') {\n         extraOffset += 3;"
        },
        {
          "filename": "test.js",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -8,6 +8,10 @@ describe('path-to-regexp', function () {\n     }, /path must be a string, array of strings, or regular expression/);\n   });\n \n+  it('should generate a regex without backtracking', function () {\n+    assert.deepEqual(pathToRegExp('/:a-:b'), /^(?:\\/([^/]+?))-(?:((?:(?!\\/|-).)+?))\\/?$/i);\n+  });\n+\n   describe('strings', function () {\n     it('should match simple paths', function () {\n       var params = [];"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "39e861d02d959ba99d0632af994ab48d4a8eeb14",
            "date": "2025-01-13T02:04:35Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "d63f44bc54f2c6fe7d35dc77f8515622006bf7cb",
            "date": "2024-09-30T21:27:01Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "973d15c262f113c4cb88762971920053fdbd31ff",
            "date": "2024-09-26T03:34:22Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "776c8986b89b29a368f22c1a6c598242b67fb832",
            "date": "2024-09-26T03:25:56Z",
            "author_login": "blakeembrey"
          },
          {
            "sha": "678756a844e16e1d85098343336ea31d743b290b",
            "date": "2024-09-26T03:21:41Z",
            "author_login": "blakeembrey"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-1333",
    "description": "path-to-regexp turns path strings into a regular expressions. In certain cases, path-to-regexp will output a regular expression that can be exploited to cause poor performance. The regular expression that is vulnerable to backtracking can be generated in the 0.1.x release of path-to-regexp. Upgrade to 0.1.12. This vulnerability exists because of an incomplete fix for CVE-2024-45296.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-12-05T23:15:06.310",
    "last_modified": "2024-12-05T23:15:06.310",
    "fix_date": "2024-12-05T22:05:02Z"
  },
  "references": [
    {
      "url": "https://github.com/pillarjs/path-to-regexp/commit/f01c26a013b1889f0c217c643964513acf17f6a4",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/pillarjs/path-to-regexp/security/advisories/GHSA-rhx6-c78j-4q9w",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:33.099780",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "path-to-regexp",
    "owner": "pillarjs",
    "created_at": "2012-08-01T22:47:17Z",
    "updated_at": "2025-01-14T06:21:22Z",
    "pushed_at": "2025-01-13T02:04:39Z",
    "size": 1046,
    "stars": 8251,
    "forks": 389,
    "open_issues": 2,
    "watchers": 8251,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "TypeScript": 52127
    },
    "commit_activity": {
      "total_commits_last_year": 69,
      "avg_commits_per_week": 1.3269230769230769,
      "days_active_last_year": 25
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T12:59:16.284082"
  }
}