{
  "cve_id": "CVE-2024-52803",
  "github_data": {
    "repository": "hiyouga/LLaMA-Factory",
    "fix_commit": "b3aa80d54a67da45e9e237e349486fb9c162b2ac",
    "related_commits": [
      "b3aa80d54a67da45e9e237e349486fb9c162b2ac"
    ],
    "patch_url": "https://github.com/hiyouga/LLaMA-Factory/commit/b3aa80d54a67da45e9e237e349486fb9c162b2ac.patch",
    "fix_commit_details": {
      "sha": "b3aa80d54a67da45e9e237e349486fb9c162b2ac",
      "commit_date": "2024-11-21T14:39:44Z",
      "author": {
        "login": "hiyouga",
        "type": "User",
        "stats": {
          "total_commits": 1722,
          "average_weekly_commits": 20.023255813953487,
          "total_additions": 7674781,
          "total_deletions": 7605416,
          "weeks_active": 85
        }
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 79,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 2,
        "additions": 1,
        "deletions": 1
      },
      "files": [
        {
          "filename": "src/llamafactory/webui/runner.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -320,7 +320,7 @@ def _launch(self, data: Dict[\"Component\", Any], do_train: bool) -> Generator[Dic\n             if args.get(\"deepspeed\", None) is not None:\n                 env[\"FORCE_TORCHRUN\"] = \"1\"\n \n-            self.trainer = Popen(f\"llamafactory-cli train {save_cmd(args)}\", env=env, shell=True)\n+            self.trainer = Popen([\"llamafactory-cli\", \"train\", save_cmd(args)], env=env)\n             yield from self.monitor()\n \n     def _form_config_dict(self, data: Dict[\"Component\", Any]) -> Dict[str, Any]:"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "9b7ba093c7e017ea18a4562550d5d2e82c4a0161",
            "date": "2025-01-14T13:22:35Z",
            "author_login": "BUAADreamer"
          },
          {
            "sha": "1278c3e92eeb297e883aab89e2384c1df1d0e910",
            "date": "2025-01-14T10:40:07Z",
            "author_login": "hiyouga"
          },
          {
            "sha": "deacc00b1226ca3d53bf7bb1231cf276eaa8296b",
            "date": "2025-01-14T10:07:27Z",
            "author_login": "hhaAndroid"
          },
          {
            "sha": "58d029f3212dba1808e63cc8875022f6d741bd63",
            "date": "2025-01-14T09:35:54Z",
            "author_login": "xiaosu-zhu"
          },
          {
            "sha": "158a127d340d5e4ca23263ffad042f861fd77deb",
            "date": "2025-01-14T09:34:58Z",
            "author_login": "BUAADreamer"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
    "cwe_id": "CWE-79",
    "description": "LLama Factory enables fine-tuning of large language models. A critical remote OS command injection vulnerability has been identified in the LLama Factory training process. This vulnerability arises from improper handling of user input, allowing malicious actors to execute arbitrary OS commands on the host system. The issue is caused by insecure usage of the `Popen` function with `shell=True`, coupled with unsanitized user input. Immediate remediation is required to mitigate the risk. This vulnerability is fixed in 0.9.1.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-11-21T17:15:24.470",
    "last_modified": "2024-11-21T17:15:24.470",
    "fix_date": "2024-11-21T14:39:44Z"
  },
  "references": [
    {
      "url": "https://gist.github.com/superboy-zjc/f2d2b93ae511c445ba97e144b70e534d",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/hiyouga/LLaMA-Factory/commit/b3aa80d54a67da45e9e237e349486fb9c162b2ac",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/hiyouga/LLaMA-Factory/security/advisories/GHSA-hj3w-wrh4-44vp",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.277116",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "LLaMA-Factory",
    "owner": "hiyouga",
    "created_at": "2023-05-28T10:09:12Z",
    "updated_at": "2025-01-14T15:23:47Z",
    "pushed_at": "2025-01-14T13:22:35Z",
    "size": 240962,
    "stars": 38034,
    "forks": 4687,
    "open_issues": 269,
    "watchers": 38034,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "Python": 1017230,
      "Dockerfile": 7782,
      "Makefile": 391
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T15:33:57.011108"
  }
}