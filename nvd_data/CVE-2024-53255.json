{
  "cve_id": "CVE-2024-53255",
  "github_data": {
    "repository": "BoidCMS/BoidCMS",
    "fix_commit": "42f4d703a87f5199bbd701b3495a26c91b9cfab7",
    "related_commits": [
      "42f4d703a87f5199bbd701b3495a26c91b9cfab7"
    ],
    "patch_url": "https://github.com/BoidCMS/BoidCMS/commit/42f4d703a87f5199bbd701b3495a26c91b9cfab7.patch",
    "fix_commit_details": {
      "sha": "42f4d703a87f5199bbd701b3495a26c91b9cfab7",
      "commit_date": "2024-11-23T16:38:53Z",
      "author": {
        "login": "shoaiyb",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 40,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 14,
        "additions": 7,
        "deletions": 7
      },
      "files": [
        {
          "filename": "app/app.php",
          "status": "modified",
          "additions": 6,
          "deletions": 6,
          "patch": "@@ -9,7 +9,7 @@\n  * @package BoidCMS\n  * @author Shuaib Yusuf Shuaib\n  * @link https://boidcms.github.io\n- * @version 2.1.1\n+ * @version 2.1.2\n  * @licence MIT\n  */\n #[AllowDynamicProperties]\n@@ -83,7 +83,7 @@ public function __construct( string $root ) {\n       file_put_contents( $this->root( 'data/database.json' ), $json, LOCK_EX );\n     }\n     $this->actions = array();\n-    $this->version = '2.1.1';\n+    $this->version = '2.1.2';\n     $this->logged_in = ( isset( $_SESSION[ 'logged_in' ], $_SESSION[ 'root' ] ) && $this->root === $_SESSION[ 'root' ] );\n     $this->database = json_decode( file_get_contents( $this->root( 'data/database.json' ) ), true );\n     $this->plugins = array_map( 'basename', glob( $this->root( 'plugins/*' ), GLOB_ONLYDIR ) );\n@@ -840,10 +840,10 @@ public function admin(): void {\n             foreach ( $pages as $page ) {\n               if ( $this->delete_page( $page ) ) {\n                 $this->get_action( 'delete_success', $page );\n-                $this->alert( sprintf( 'Page <b>%s</b> has been deleted successfully.', $page ), 'success' );\n+                $this->alert( sprintf( 'Page <b>%s</b> has been deleted successfully.', $this->esc( $page ) ), 'success' );\n               } else {\n                 $this->get_action( 'delete_error', $page );\n-                $this->alert( sprintf( 'Page <b>%s</b> was not deleted, please try again.', $page ), 'error' );\n+                $this->alert( sprintf( 'Page <b>%s</b> was not deleted, please try again.', $this->esc( $page ) ), 'error' );\n               }\n             }\n             $this->go( $this->admin_url( '?page=delete' ) );\n@@ -989,10 +989,10 @@ public function admin(): void {\n             $this->get_action( 'on_media' );\n             $file = ( $_GET[ 'file' ] ?? '' );\n             if ( $this->delete_media( $file ) ) {\n-              $this->alert( sprintf( 'File <b>%s</b> has been deleted successfully.', $file ), 'success' );\n+              $this->alert( sprintf( 'File <b>%s</b> has been deleted successfully.', $this->esc( $file ) ), 'success' );\n               $this->go( $this->admin_url( '?page=media' ) );\n             }\n-            $this->alert( sprintf( 'File <b>%s</b> was not deleted, please try again.', $file ), 'error' );\n+            $this->alert( sprintf( 'File <b>%s</b> was not deleted, please try again.', $this->esc( $file ) ), 'error' );\n             $this->go( $this->admin_url( '?page=media' ) );\n           } else if ( isset( $_POST[ 'upload' ] ) ) {\n             $this->auth();"
        },
        {
          "filename": "index.php",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -9,7 +9,7 @@\n  * @package BoidCMS\n  * @author Shuaib Yusuf Shuaib\n  * @link https://boidcms.github.io\n- * @version 2.1.1\n+ * @version 2.1.2\n  * @licence MIT\n  */\n session_start();"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "42f4d703a87f5199bbd701b3495a26c91b9cfab7",
            "date": "2024-11-23T16:38:53Z",
            "author_login": "shoaiyb"
          },
          {
            "sha": "3faf83542874cf967bfbf4090d202956d2a8c1bb",
            "date": "2024-10-30T23:13:52Z",
            "author_login": "shoaiyb"
          },
          {
            "sha": "bddffdcd74ab0745a457449ab606d97134978a86",
            "date": "2024-03-03T13:59:26Z",
            "author_login": "shoaiyb"
          },
          {
            "sha": "2519f20258089285a362928ac3b80e5a40bbc879",
            "date": "2023-07-15T23:43:17Z",
            "author_login": "shoaiyb"
          },
          {
            "sha": "6bb909b1b9029264f77462d6c192e9f357ec2912",
            "date": "2022-09-12T03:22:19Z",
            "author_login": "BoidCMS"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "BoidCMS is a free and open-source flat file CMS for building simple websites and blogs, developed using PHP and uses JSON as a database. In affected versions a reflected Cross-site Scripting (XSS) vulnerability exists in the /admin?page=media endpoint in the file parameter, allowing an attacker to inject arbitrary JavaScript code. This code could be used to steal the user's session cookie, perform phishing attacks, or deface the website. This issue has been addressed in version 2.1.2 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-11-25T19:15:11.760",
    "last_modified": "2024-11-25T19:15:11.760",
    "fix_date": "2024-11-23T16:38:53Z"
  },
  "references": [
    {
      "url": "https://github.com/BoidCMS/BoidCMS/commit/42f4d703a87f5199bbd701b3495a26c91b9cfab7",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/BoidCMS/BoidCMS/security/advisories/GHSA-7q7m-cgw8-px4r",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.302407",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "BoidCMS",
    "owner": "BoidCMS",
    "created_at": "2022-01-21T00:36:15Z",
    "updated_at": "2024-12-21T20:31:31Z",
    "pushed_at": "2024-11-23T16:45:47Z",
    "size": 36,
    "stars": 53,
    "forks": 6,
    "open_issues": 0,
    "watchers": 53,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "PHP": 75598
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T19:18:35.086153"
  }
}