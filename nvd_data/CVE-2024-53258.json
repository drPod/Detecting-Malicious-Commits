{
  "cve_id": "CVE-2024-53258",
  "github_data": {
    "repository": "autolab/Autolab",
    "fix_commit": "1aa4c7690892fb458d2c61ff86739f368e34769d",
    "related_commits": [
      "1aa4c7690892fb458d2c61ff86739f368e34769d"
    ],
    "patch_url": "https://github.com/autolab/Autolab/commit/1aa4c7690892fb458d2c61ff86739f368e34769d.patch",
    "fix_commit_details": {
      "sha": "1aa4c7690892fb458d2c61ff86739f368e34769d",
      "commit_date": "2024-11-24T19:46:55Z",
      "author": {
        "login": "jhs-panda",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 22,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 5,
        "additions": 5,
        "deletions": 0
      },
      "files": [
        {
          "filename": "app/controllers/users_controller.rb",
          "status": "modified",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -165,6 +165,11 @@ def edit\n   action_auth_level :download_all_submissions, :student\n   def download_all_submissions\n     user = User.find(params[:id])\n+    # user can only download their own submissions\n+    if user != current_user\n+      flash[:error] = \"Permission denied: You are not allowed to download submissions of this user.\"\n+      redirect_to(user_path(current_user)) && return\n+    end\n     submissions = if params[:final]\n                     Submission.latest.where(course_user_datum: CourseUserDatum.where(user_id: user))\n                   else"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "2dc3ce92d593b9fb93827b36b0a51fb4ed24da03",
            "date": "2025-01-13T18:28:32Z",
            "author_login": "jhs-panda"
          },
          {
            "sha": "8267f9aa6a8296831fd61d04ecb89dd8608a9e14",
            "date": "2025-01-13T17:58:39Z",
            "author_login": "KesterTan"
          },
          {
            "sha": "8c81601f43830d92210174c7e597123ed9b6d693",
            "date": "2024-12-15T01:43:39Z",
            "author_login": "Nita242004"
          },
          {
            "sha": "fe44b53815d37c63e751032205b692ccd5737620",
            "date": "2024-11-27T20:27:13Z",
            "author_login": "20wildmanj"
          },
          {
            "sha": "1aa4c7690892fb458d2c61ff86739f368e34769d",
            "date": "2024-11-24T19:46:55Z",
            "author_login": "jhs-panda"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-359",
    "description": "Autolab is a course management service that enables auto-graded programming assignments. From Autolab versions v.3.0.0 onward students can download all assignments from another student, as long as they are logged in, using the download_all_submissions feature. This can allow for leakage of submissions to unauthorized users, such as downloading submissions from other students in the class, or even instructor test submissions, given they know their user IDs. This issue has been patched in commit `1aa4c769` which is not yet in a release version, but is expected to be included in version 3.0.3. Users are advised to either manually patch or to wait for version 3.0.3. As a workaround administrators can disable the feature.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-11-25T20:15:10.030",
    "last_modified": "2024-11-25T20:15:10.030",
    "fix_date": "2024-11-24T19:46:55Z"
  },
  "references": [
    {
      "url": "https://github.com/autolab/Autolab/commit/1aa4c7690892fb458d2c61ff86739f368e34769d",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/autolab/Autolab/security/advisories/GHSA-84qc-7773-2gg3",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.302703",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Autolab",
    "owner": "autolab",
    "created_at": "2014-10-25T18:58:53Z",
    "updated_at": "2025-01-13T18:32:20Z",
    "pushed_at": "2025-01-13T19:47:35Z",
    "size": 10064,
    "stars": 771,
    "forks": 226,
    "open_issues": 161,
    "watchers": 771,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "develop/autolab-3.0",
      "develop/firewall",
      "master"
    ],
    "languages": {
      "Ruby": 979618,
      "HTML": 365392,
      "JavaScript": 263566,
      "Java": 261126,
      "SCSS": 109158,
      "CSS": 16865,
      "Shell": 10622,
      "Dockerfile": 1584,
      "CoffeeScript": 211,
      "Python": 34
    },
    "commit_activity": {
      "total_commits_last_year": 105,
      "avg_commits_per_week": 2.019230769230769,
      "days_active_last_year": 70
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:21:33.966961"
  }
}