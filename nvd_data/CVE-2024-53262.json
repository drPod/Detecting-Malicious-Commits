{
  "cve_id": "CVE-2024-53262",
  "github_data": {
    "repository": "sveltejs/kit",
    "fix_commit": "134e36343ef57ed7e6e2b3bb9e7f05ad37865794",
    "related_commits": [
      "134e36343ef57ed7e6e2b3bb9e7f05ad37865794"
    ],
    "patch_url": "https://github.com/sveltejs/kit/commit/134e36343ef57ed7e6e2b3bb9e7f05ad37865794.patch",
    "fix_commit_details": {
      "sha": "134e36343ef57ed7e6e2b3bb9e7f05ad37865794",
      "commit_date": "2024-11-25T05:36:56Z",
      "author": {
        "login": "benmccann",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: ensure error messages are escaped (#13050)",
        "length": 47,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": ".changeset/fast-swans-perform.md",
          "status": "added",
          "additions": 5,
          "deletions": 0,
          "patch": "@@ -0,0 +1,5 @@\n+---\n+'@sveltejs/kit': patch\n+---\n+\n+fix: ensure error messages are escaped"
        },
        {
          "filename": "packages/kit/src/exports/vite/dev/index.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -18,6 +18,7 @@ import { compact } from '../../../utils/array.js';\n import { not_found } from '../utils.js';\n import { SCHEME } from '../../../utils/url.js';\n import { check_feature } from '../../../utils/features.js';\n+import { escape_html } from '../../../utils/escape.js';\n \n const cwd = process.cwd();\n \n@@ -508,7 +509,7 @@ export async function dev(vite, vite_config, svelte_config) {\n \t\t\t\t\tconst error_template = ({ status, message }) => {\n \t\t\t\t\t\treturn error_page\n \t\t\t\t\t\t\t.replace(/%sveltekit\\.status%/g, String(status))\n-\t\t\t\t\t\t\t.replace(/%sveltekit\\.error\\.message%/g, message);\n+\t\t\t\t\t\t\t.replace(/%sveltekit\\.error\\.message%/g, escape_html(message));\n \t\t\t\t\t};\n \n \t\t\t\t\tres.writeHead(500, {"
        },
        {
          "filename": "packages/kit/src/runtime/server/utils.js",
          "status": "modified",
          "additions": 2,
          "deletions": 1,
          "patch": "@@ -5,6 +5,7 @@ import { negotiate } from '../../utils/http.js';\n import { HttpError } from '../control.js';\n import { fix_stack_trace } from '../shared-server.js';\n import { ENDPOINT_METHODS } from '../../constants.js';\n+import { escape_html } from '../../utils/escape.js';\n \n /** @param {any} body */\n export function is_pojo(body) {\n@@ -50,7 +51,7 @@ export function allowed_methods(mod) {\n  * @param {string} message\n  */\n export function static_error_page(options, status, message) {\n-\tlet page = options.templates.error({ status, message });\n+\tlet page = options.templates.error({ status, message: escape_html(message) });\n \n \tif (DEV) {\n \t\t// inject Vite HMR client, for easier debugging"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 6
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "c8164ad17d4472d5b3eb0d0eef5fd34dd0ae60a1",
            "date": "2025-01-14T16:51:37Z",
            "author_login": "aeons"
          },
          {
            "sha": "226db42d08d3be3dfbb25750c5cc55f81bd6d722",
            "date": "2025-01-14T00:10:25Z",
            "author_login": "renovate[bot]"
          },
          {
            "sha": "1bedcc1cfc1f2d85946c1423f60faa8a2a56148b",
            "date": "2025-01-13T19:50:42Z",
            "author_login": "aloisklink"
          },
          {
            "sha": "e201fa9380a00e072a80a2dcab56de3d77e5b67c",
            "date": "2025-01-13T19:26:22Z",
            "author_login": "janabimustafa"
          },
          {
            "sha": "c2ffdcfd73a4159267b4b01878ce71ca3c456a2d",
            "date": "2025-01-13T15:37:16Z",
            "author_login": "Rich-Harris"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-79",
    "description": "SvelteKit is a framework for rapidly developing robust, performant web applications using Svelte. The static error.html template for errors contains placeholders that are replaced without escaping the content first. error.html is the page that is rendered when everything else fails. It can contain the following placeholders: %sveltekit.status% \u2014 the HTTP status, and %sveltekit.error.message% \u2014 the error message.  This leads to possible injection if an app explicitly creates an error with a message that contains user controlled content. Only applications where user provided input is used in the `Error` message will be vulnerable, so the vast majority of applications will not be vulnerable This issue has been addressed in version 2.8.3 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-11-25T20:15:10.423",
    "last_modified": "2024-11-25T20:15:10.423",
    "fix_date": "2024-11-25T05:36:56Z"
  },
  "references": [
    {
      "url": "https://github.com/sveltejs/kit/commit/134e36343ef57ed7e6e2b3bb9e7f05ad37865794",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/sveltejs/kit/security/advisories/GHSA-mh2x-fcqh-fmqv",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://kit.svelte.dev/docs/errors",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:31.303192",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "kit",
    "owner": "sveltejs",
    "created_at": "2020-10-15T14:00:23Z",
    "updated_at": "2025-01-14T16:51:49Z",
    "pushed_at": "2025-01-14T17:03:30Z",
    "size": 27341,
    "stars": 18915,
    "forks": 1996,
    "open_issues": 814,
    "watchers": 18915,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "JavaScript": 801855,
      "HTML": 1710,
      "Svelte": 1223,
      "TypeScript": 445,
      "Shell": 71
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T17:29:47.085872"
  }
}