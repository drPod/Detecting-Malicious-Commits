{
  "cve_id": "CVE-2024-53999",
  "github_data": {
    "repository": "MobSF/Mobile-Security-Framework-MobSF",
    "fix_commit": "27d165872847f5ae7417caf09f37edeeba741e1e",
    "related_commits": [
      "27d165872847f5ae7417caf09f37edeeba741e1e"
    ],
    "patch_url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/27d165872847f5ae7417caf09f37edeeba741e1e.patch",
    "fix_commit_details": {
      "sha": "27d165872847f5ae7417caf09f37edeeba741e1e",
      "commit_date": "2024-12-03T06:33:01Z",
      "author": {
        "login": "ajinabraham",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Fixes a stored XSS in Recent Scans diff APK, GHSA-5jc6-h9w7-jm3p",
        "length": 64,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 28,
        "additions": 21,
        "deletions": 7
      },
      "files": [
        {
          "filename": "mobsf/MobSF/init.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -18,7 +18,7 @@\n \n logger = logging.getLogger(__name__)\n \n-VERSION = '4.2.8'\n+VERSION = '4.2.9'\n BANNER = r\"\"\"\n   __  __       _    ____  _____       _  _    ____  \n  |  \\/  | ___ | |__/ ___||  ___|_   _| || |  |___ \\ "
        },
        {
          "filename": "mobsf/MobSF/views/home.py",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -163,7 +163,7 @@ def upload(self):\n         request = self.request\n         scanning = Scanning(request)\n         content_type = self.file.content_type\n-        file_name = self.file.name\n+        file_name = sanitize_filename(self.file.name)\n         logger.info('MIME Type: %s FILE: %s', content_type, file_name)\n         if self.file_type.is_apk():\n             return scanning.scan_apk()"
        },
        {
          "filename": "mobsf/MobSF/views/scanning.py",
          "status": "modified",
          "additions": 3,
          "deletions": 1,
          "patch": "@@ -8,6 +8,7 @@\n from django.utils import timezone\n \n from mobsf.StaticAnalyzer.models import RecentScansDB\n+from mobsf.MobSF.security import sanitize_filename\n \n logger = logging.getLogger(__name__)\n \n@@ -62,7 +63,8 @@ class Scanning(object):\n \n     def __init__(self, request):\n         self.file = request.FILES['file']\n-        self.file_name = request.FILES['file'].name\n+        self.file_name = sanitize_filename(\n+            request.FILES['file'].name)\n         self.data = {\n             'analyzer': 'static_analyzer',\n             'status': 'success',"
        },
        {
          "filename": "mobsf/templates/general/recent.html",
          "status": "modified",
          "additions": 15,
          "deletions": 3,
          "patch": "@@ -184,6 +184,18 @@ <h3 class=\"box-title\"><i class=\"fa fa-rocket\"></i> Recent Scans</h3>\n {% block extra_scripts %}\n <script src=\"{% static \"adminlte/plugins/sweetalert2/sweetalert2.min.js\" %}\"></script>\n <script>\n+\n+    // Escape HTML\n+    function escapeHtml(unsafe)\n+    {\n+        return unsafe\n+            .replace(/&/g, \"&amp;\")\n+            .replace(/</g, \"&lt;\")\n+            .replace(/>/g, \"&gt;\")\n+            .replace(/\"/g, \"&quot;\")\n+            .replace(/'/g, \"&#039;\");\n+    }\n+\n     // Diff functions\n     var diff_first_md5 = '';\n     var diff_first_name = '';\n@@ -231,7 +243,7 @@ <h3 class=\"box-title\"><i class=\"fa fa-rocket\"></i> Recent Scans</h3>\n     }\n \n     function diff_cleanup() {\n-        first_td_id = diff_first_md5 + '_' + diff_first_name;\n+        first_td_id = diff_first_md5 + '_' + escapeHtml(diff_first_name);\n         $('[id=\"' + first_td_id + '\"]').closest(\"tr\").removeClass(\"selected\");\n         $('[id=\"' + first_td_id + '\"]').closest(\"tbody\").removeClass(\"selectable_table\");\n         diff_first_md5 = \"\";\n@@ -254,8 +266,8 @@ <h3 class=\"box-title\"><i class=\"fa fa-rocket\"></i> Recent Scans</h3>\n             title: '<strong>Diff confirmation</strong>',\n             type: 'info',\n             html:\n-                '<strong>Do you want to diff - </strong><br />' + diff_first_name +\n-                '<br /> <strong>with - <br /> </strong>' + diff_second_name + ' <br /> <strong>?</strong>',\n+                '<strong>Do you want to diff - </strong><br />' + escapeHtml(diff_first_name) +\n+                '<br /> <strong>with - <br /> </strong>' + escapeHtml(diff_second_name) + ' <br /> <strong>?</strong>',\n \n             showCancelButton: true,\n             cancelButtonText: 'Cancel',"
        },
        {
          "filename": "pyproject.toml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,6 +1,6 @@\n [tool.poetry]\n name = \"mobsf\"\n-version = \"4.2.8\"\n+version = \"4.2.9\"\n description = \"Mobile Security Framework (MobSF) is an automated, all-in-one mobile application (Android/iOS/Windows) pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis.\"\n keywords = [\"mobsf\", \"mobile security framework\", \"mobile security\", \"security tool\", \"static analysis\", \"dynamic analysis\", \"malware analysis\"]\n authors = [\"Ajin Abraham <ajin@opensecurity.in>\"]"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "79b2d28c3b45dd176b0e63bd3deef2608960339a",
            "date": "2024-12-19T02:35:11Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "180de6b6110c9deba5284ae65ffaa46b660516ad",
            "date": "2024-12-18T01:56:54Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "17332e88c0f6c264c689af4eeedd515327c2713c",
            "date": "2024-12-18T01:56:25Z",
            "author_login": "dmarushkin"
          },
          {
            "sha": "fbf567446bfe818b179aed074ec5f2c4de3915d3",
            "date": "2024-12-18T01:03:03Z",
            "author_login": "ajinabraham"
          },
          {
            "sha": "3223736d93b2c7e4b55e739e135f5d728d0b66dd",
            "date": "2024-12-12T02:08:06Z",
            "author_login": "ajinabraham"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 8.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:H/A:N",
    "cwe_id": "CWE-79",
    "description": "Mobile Security Framework (MobSF) is a pen-testing, malware analysis and security assessment framework capable of performing static and dynamic analysis. The application allows users to upload files with scripts in the filename parameter. As a result, a malicious user can upload a script file to the system. When users in the application use the \"Diff or Compare\" functionality, they are affected by a Stored Cross-Site Scripting vulnerability. This vulnerability is fixed in 4.2.9.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-12-03T16:15:24.250",
    "last_modified": "2024-12-03T16:15:24.250",
    "fix_date": "2024-12-03T06:33:01Z"
  },
  "references": [
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/commit/27d165872847f5ae7417caf09f37edeeba741e1e",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/MobSF/Mobile-Security-Framework-MobSF/security/advisories/GHSA-5jc6-h9w7-jm3p",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:33.086624",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "Mobile-Security-Framework-MobSF",
    "owner": "MobSF",
    "created_at": "2015-01-31T04:36:01Z",
    "updated_at": "2025-01-14T12:25:42Z",
    "pushed_at": "2024-12-19T02:35:13Z",
    "size": 1525379,
    "stars": 17868,
    "forks": 3277,
    "open_issues": 13,
    "watchers": 17868,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "JavaScript": 1582153,
      "Python": 1354876,
      "HTML": 1073775,
      "CSS": 148866,
      "Shell": 11552,
      "Batchfile": 4318,
      "PowerShell": 3089,
      "Dockerfile": 2892
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T15:25:15.645730"
  }
}