{
  "cve_id": "CVE-2024-55662",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "8659f17d500522bf33595e402391592a35a162e8",
    "related_commits": [
      "8659f17d500522bf33595e402391592a35a162e8"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "8659f17d500522bf33595e402391592a35a162e8",
      "commit_date": "2024-04-05T08:19:50Z",
      "author": {
        "login": "pjeanjean",
        "type": "User",
        "stats": {
          "total_commits": 36,
          "average_weekly_commits": 0.03765690376569038,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 23
        }
      },
      "commit_message": {
        "title": "XWIKI-21890: Improve escaping in Extension Sheet",
        "length": 48,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 297,
        "additions": 272,
        "deletions": 25
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-repository/xwiki-platform-repository-server-ui/pom.xml",
          "status": "modified",
          "additions": 47,
          "deletions": 0,
          "patch": "@@ -96,6 +96,53 @@\n       <version>${rendering.version}</version>\n       <scope>runtime</scope>\n     </dependency>\n+    <!-- Test dependencies. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-test-page</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-uiextension-api</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+      <type>test-jar</type>\n+    </dependency>\n+    <!-- Provides the component list for RenderingScriptService. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-xwiki</artifactId>\n+      <version>${project.version}</version>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-configuration-default</artifactId>\n+      <version>${project.version}</version>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-rendering-macro-groovy</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-logging-script</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.commons</groupId>\n+      <artifactId>xwiki-commons-logging-logback</artifactId>\n+      <version>${commons.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n   <build>\n     <plugins>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-repository/xwiki-platform-repository-server-ui/src/main/resources/ExtensionCode/ExtensionAuthorsDisplayer.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -88,7 +88,7 @@\n     &lt;/script&gt;\n   {{/html}}\n #else\n-  #foreach($page in $pageList)#if($foreach.count &gt; 1), #end#if($xwiki.exists($page))[[${xwiki.getUserName($page, false)}&gt;&gt;$page]]#else$page#end#end\n+  #foreach($page in $pageList)#if($foreach.count &gt; 1), #end#if($xwiki.exists($page))[[${xwiki.getUserName($page, false)}&gt;&gt;$page]]#else$services.rendering.escape($page, 'xwiki/2.1')#end#end\n #end\n {{/velocity}}</content>\n   <object>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-repository/xwiki-platform-repository-server-ui/src/main/resources/ExtensionCode/ExtensionSheet.xml",
          "status": "modified",
          "additions": 28,
          "deletions": 24,
          "patch": "@@ -90,9 +90,9 @@\n     (% class=\"extensionSummary\" %)\n     #set($icon = $doc.getValue(\"icon\"))\n     #if (\"$!{icon.trim()}\" != \"\")\n-      |[[image:${doc.getValue('icon')}]]|**{{{$doc.getValue(\"summary\")}}}**\n+      |[[image:${services.rendering.escape($doc.getValue('icon'), 'xwiki/2.1')}]]|**${services.rendering.escape($doc.getValue(\"summary\"), 'xwiki/2.1')}**\n     #else\n-      |[[image:icon:cog]]|**{{{$doc.getValue(\"summary\")}}}**\n+      |[[image:icon:cog]]|**${services.rendering.escape($doc.getValue(\"summary\"), 'xwiki/2.1')}**\n     #end\n \n     ## Viewing\n@@ -116,14 +116,14 @@\n       #if (\"$!typeDisplay\" == '')\n         #set($typeDisplay = $type)\n       #end\n-      |(% class=\"label\" width='30%' %)Type(%%)|$typeDisplay\n+      |(% class=\"label\" width='30%' %)Type(%%)|$services.rendering.escape($typeDisplay, 'xwiki/2.1')\n       ##------- Category --------------\n       #set($categoryDisplay = $extensionCategoryObject.getProperty('name').value)\n       #if (\"$!categoryDisplay\" == '')\n         #set($categoryDisplay = $category)\n       #end\n       #if ($categoryDisplay)\n-      |(% class=\"label\" width='30%' %)Category(%%)|$categoryDisplay\n+      |(% class=\"label\" width='30%' %)Category(%%)|$services.rendering.escape($categoryDisplay, 'xwiki/2.1')\n       #end\n       ##------- Developed By --------\n       #set($authors = $doc.getValue(\"authors\"))\n@@ -134,23 +134,23 @@\n         #end\n       ##------- Active Installs --------\n       #if ($doc.getValue('installedCount') &amp;&amp; $doc.getValue('showInstalledCount') != 0)\n-        |(% class=\"label\" %)Active Installs(%%)|$!doc.getValue('installedCount')\n+        |(% class=\"label\" %)Active Installs(%%)|$services.rendering.escape($!doc.getValue('installedCount'), 'xwiki/2.1')\n       #end\n       ##------- Rating --------\n       |(% class=\"label\" %)Rating(%%)|#displayFullRating($doc.documentReference)\n       ##------- Website --------------\n       #set($website = $extension.getProperty(\"website\").value)\n       #if (\"$!website\" != '')\n         |(% class=\"label\" %)Website(%%)|#if ($website.length() &gt; 40)\n-                                          [[{{{$website.substring(0, 40)...}}}&gt;&gt;url:$website]]\n+                                          [[$services.rendering.escape($services.rendering.escape($website.substring(0, 40), 'xwiki/2.1'), 'xwiki/2.1')...&gt;&gt;$services.rendering.escape($website, 'xwiki/2.1')]]\n                                         #else\n-                                          $website\n+                                          [[$services.rendering.escape($website, 'xwiki/2.1')]]\n                                         #end\n       #end\n       ##------- License --------\n       #set($licenseName = $doc.getValue(\"licenseName\"))\n       #if (\"$!licenseName\" != \"\")\n-        |(% class=\"label\" %)License(%%)|$licenseName\n+        |(% class=\"label\" %)License(%%)|$services.rendering.escape($licenseName, 'xwiki/2.1')\n       #else\n         |(% class=\"label\" %)License(%%)|Unknown\n       #end\n@@ -178,21 +178,21 @@\n           #set ($download = $lastVersionObject.getProperty(\"download\").value)\n           #if (\"$!download\" == '')\n             #if ($doc.getAttachment(\"${id}-${version}.${type}\"))\n-              [[$services.icon.render('download')  Download v$version&gt;&gt;attach:${id}-${version}.${type}||class=\"btn btn-primary\"]]##\n+              [[$services.icon.render('download')  Download v$services.rendering.escape($services.rendering.escape($version, 'xwiki/2.1'), 'xwiki/2.1')&gt;&gt;$services.rendering.escape(\"attach:${id}-${version}.${type}\")||class=\"btn btn-primary\"]]##\n             #end\n           #else\n-            [[$services.icon.render('download')  Download v$version&gt;&gt;${download}||class=\"btn btn-primary\"]]##\n+            [[$services.icon.render('download')  Download v$services.rendering.escape($services.rendering.escape($version, 'xwiki/2.1'), 'xwiki/2.1')&gt;&gt;$services.rendering.escape($download, 'xwiki/2.1')||class=\"btn btn-primary\"]]##\n           #end\n         #end\n         ##------- Source --------\n         #set($source = $doc.getValue(\"source\"))\n         #if (\"$!source\" != \"\")\n-          [[Sources&gt;&gt;${source}||class=\"btn btn-default\"]]##\n+          [[Sources&gt;&gt;$services.rendering.escape($source, 'xwiki/2.1')||class=\"btn btn-default\"]]##\n         #end\n         ##------- Issues --------\n         #set($issues = $doc.getValue(\"issueManagementURL\"))\n         #if (\"$!issues\" != \"\")\n-          [[Issues&gt;&gt;${issues}||class=\"btn btn-default\"]]##\n+          [[Issues&gt;&gt;$services.rendering.escape($issues, 'xwiki/2.1')||class=\"btn btn-default\"]]##\n         #end\n       )))\n     {{/box}}\n@@ -240,7 +240,7 @@\n     |Category|#if($proxyExtensionObject)$doc.display('category', 'view')#else$doc.display('category')#end~\n     |Summary|#if($proxyExtensionObject)$doc.display('summary', 'view')#else$doc.display('summary')#end~\n     ## FIXME: there seems to be a bug with custom displayer where they don't take into account the mode passed to display\n-    |Authors|#if($proxyExtensionObject)$doc.getValue('authors')#else$doc.display('authors')#end~\n+    |Authors|#if($proxyExtensionObject)$services.rendering.escape($doc.getValue('authors').toString(), 'xwiki/2.1')#else$doc.display('authors')#end~\n     |License|#if($proxyExtensionObject)$doc.display('licenseName', 'view')#else$doc.display('licenseName')#end~\n     |Source|$doc.display('source')\n     |Display Icon Location\n@@ -255,9 +255,11 @@\n     = Description =\n     #if ($isViewMode)\n       ## Make sure to resolve reference based on the right document\n-      $doc.getValue(\"description\")\n+      {{context transformationContext=\"document\" restricted=true}}\n+        $doc.getValue('description')\n+      {{/context}}\n     #else\n-      $doc.display(\"description\")\n+      $doc.display('description')\n     #end\n \n     #if ($extensionTypeObject &amp;&amp; $lastVersionObject &amp;&amp; \"$!{extension.getProperty('customInstallationOnly').value}\" != '1')\n@@ -272,7 +274,7 @@\n \n       #if ($isEditMode)\n         ; Custom installation only\n-        : $extension.customInstallationOnly\n+        : $extension.display('customInstallationOnly', 'edit')\n       #end\n       ##\n       ## Standard installation\n@@ -288,9 +290,11 @@\n       #if ($isEditMode)\n         == Custom installation instructions\n \n-        $extension.installation\n+        $extension.display('installation', 'edit')\n       #elseif ($extraInstallation != '')\n-        $extraInstallation\n+        {{context transformationContext=\"document\" restricted=true}}\n+          $extraInstallation\n+        {{/context}}\n       #end\n     #end\n \n@@ -299,7 +303,7 @@\n       #set ($releaseNotes = [])\n       #set ($versions = $doc.getObjects(\"ExtensionCode.ExtensionVersionClass\"))\n       #foreach ($versionObject in $versions)\n-        #set ($notes = $!{versionObject.getProperty('notes').value})\n+        #set ($notes = $!{versionObject.display('notes', 'read')})\n         #set ($version = $!{versionObject.getProperty('version').value})\n         #if (\"$!notes\" != '' &amp;&amp; \"$!version\" != '')\n           #set ($discard = $releaseNotes.add([$version, $notes]))\n@@ -310,26 +314,26 @@\n       #if (!$releaseNotes.isEmpty())\n         = Release Notes =\n         #foreach ($entry in $releaseNotes)\n-          == v$entry.get(0) ==\n+          == v$services.rendering.escape($entry.get(0), 'xwiki/2.1') ==\n           $entry.get(1)\n         #end\n       #end\n \n-      #set($extensionDependencies = $doc.getObjects('ExtensionCode.ExtensionDependencyClass', 'extensionVersion', $lastVersionObject.version))\n+      #set($extensionDependencies = $doc.getObjects('ExtensionCode.ExtensionDependencyClass', 'extensionVersion', $lastVersionObject.getValue('version')))\n       #if ($extensionDependencies.size() &gt; 0)\n         = Dependencies =\n \n-         Dependencies for this extension (${extension.getProperty('id').value} ${doc.getValue('lastVersion')}):\n+         Dependencies for this extension ($services.rendering.escape(\"${extension.getValue('id')} ${doc.getValue('lastVersion')}\", 'xwiki/2.1')):\n          #foreach($extensionDependency in $extensionDependencies)\n           #set($dependencyDocumentName = $null)\n           #set($dependencyDocumentNames = $services.query.xwql('from doc.object(ExtensionCode.ExtensionClass) as extension where extension.id = :id').bindValue(\"id\", $extensionDependency.id).execute())\n           #if (!$dependencyDocumentNames.isEmpty())\n             #set($dependencyDocumentName = $dependencyDocumentNames.get(0))\n           #end\n           #if ($dependencyDocumentName)\n-            * [[$extensionDependency.id&gt;&gt;$dependencyDocumentName]] $extensionDependency.constraint\n+            * [[$services.rendering.escape($services.rendering.escape($extensionDependency.getValue('id'), 'xwiki/2.1'), 'xwiki/2.1')&gt;&gt;$services.rendering.escape($dependencyDocumentName, 'xwiki/2.1')]] $services.rendering.escape($extensionDependency.getValue('constraint'), 'xwiki/2.1')\n           #else\n-            * $extensionDependency.id $extensionDependency.constraint\n+            * $services.rendering.escape(\"${extensionDependency.getValue('id')} ${extensionDependency.getValue('constraint')}\", 'xwiki/2.1')\n           #end\n         #end\n       #end"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-repository/xwiki-platform-repository-server-ui/src/test/java/org/xwiki/repository/server/ui/ExtensionSheetPageTest.java",
          "status": "added",
          "additions": 196,
          "deletions": 0,
          "patch": "@@ -0,0 +1,196 @@\n+/*\n+ * See the NOTICE file distributed with this work for additional\n+ * information regarding copyright ownership.\n+ *\n+ * This is free software; you can redistribute it and/or modify it\n+ * under the terms of the GNU Lesser General Public License as\n+ * published by the Free Software Foundation; either version 2.1 of\n+ * the License, or (at your option) any later version.\n+ *\n+ * This software is distributed in the hope that it will be useful,\n+ * but WITHOUT ANY WARRANTY; without even the implied warranty of\n+ * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU\n+ * Lesser General Public License for more details.\n+ *\n+ * You should have received a copy of the GNU Lesser General Public\n+ * License along with this software; if not, write to the Free\n+ * Software Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA\n+ * 02110-1301 USA, or see the FSF site: http://www.fsf.org.\n+ */\n+package org.xwiki.repository.server.ui;\n+\n+import java.util.List;\n+\n+import javax.inject.Named;\n+\n+import org.junit.jupiter.api.BeforeEach;\n+import org.junit.jupiter.api.Test;\n+import org.xwiki.groovy.internal.DefaultGroovyConfiguration;\n+import org.xwiki.groovy.internal.GroovyScriptEngineFactory;\n+import org.xwiki.logging.logback.internal.DefaultLoggerManager;\n+import org.xwiki.logging.script.LoggingScriptService;\n+import org.xwiki.model.reference.DocumentReference;\n+import org.xwiki.observation.internal.DefaultObservationManager;\n+import org.xwiki.query.Query;\n+import org.xwiki.query.script.QueryManagerScriptService;\n+import org.xwiki.rendering.RenderingScriptServiceComponentList;\n+import org.xwiki.rendering.async.internal.AsyncMacro;\n+import org.xwiki.rendering.async.internal.block.DefaultBlockAsyncRenderer;\n+import org.xwiki.rendering.internal.configuration.DefaultRenderingConfigurationComponentList;\n+import org.xwiki.rendering.internal.macro.box.DefaultBoxMacro;\n+import org.xwiki.rendering.internal.macro.context.ContextMacro;\n+import org.xwiki.rendering.internal.macro.context.ContextMacroDocument;\n+import org.xwiki.rendering.internal.macro.groovy.GroovyMacro;\n+import org.xwiki.rendering.internal.macro.script.PermissionCheckerListener;\n+import org.xwiki.rendering.internal.macro.source.DefaultMacroWikiContentSourceFactory;\n+import org.xwiki.rendering.internal.macro.toc.DefaultTocEntriesResolver;\n+import org.xwiki.rendering.internal.macro.toc.DefaultTocTreeBuilderFactory;\n+import org.xwiki.rendering.internal.macro.toc.TocMacro;\n+import org.xwiki.rendering.macro.script.MacroPermissionPolicy;\n+import org.xwiki.rendering.transformation.MacroTransformationContext;\n+import org.xwiki.script.service.ScriptService;\n+import org.xwiki.test.annotation.ComponentList;\n+import org.xwiki.test.junit5.mockito.MockComponent;\n+import org.xwiki.test.page.HTML50ComponentList;\n+import org.xwiki.test.page.PageTest;\n+import org.xwiki.test.page.TestNoScriptMacro;\n+import org.xwiki.test.page.XWikiSyntax21ComponentList;\n+\n+import com.xpn.xwiki.doc.XWikiDocument;\n+import com.xpn.xwiki.objects.BaseObject;\n+\n+import static org.mockito.ArgumentMatchers.any;\n+import static org.mockito.Mockito.mock;\n+import static org.mockito.Mockito.when;\n+\n+/**\n+ * Page Test for {@code ExtensionCode.ExtensionSheet}.\n+ *\n+ * @version $Id$\n+ * @since 15.10.9\n+ * @since 16.3.0RC1\n+ */\n+@RenderingScriptServiceComponentList\n+@DefaultRenderingConfigurationComponentList\n+@HTML50ComponentList\n+@XWikiSyntax21ComponentList\n+@ComponentList({\n+    AsyncMacro.class,\n+    ContextMacroDocument.class,\n+    ContextMacro.class,\n+    DefaultBlockAsyncRenderer.class,\n+    DefaultBoxMacro.class,\n+    DefaultGroovyConfiguration.class,\n+    DefaultLoggerManager.class,\n+    DefaultMacroWikiContentSourceFactory.class,\n+    DefaultObservationManager.class,\n+    DefaultTocEntriesResolver.class,\n+    DefaultTocTreeBuilderFactory.class,\n+    GroovyMacro.class,\n+    GroovyScriptEngineFactory.class,\n+    LoggingScriptService.class,\n+    PermissionCheckerListener.class,\n+    TestNoScriptMacro.class,\n+    TocMacro.class,\n+})\n+public class ExtensionSheetPageTest extends PageTest\n+{\n+    private static final String WIKI_NAME = \"xwiki\";\n+\n+    private static final DocumentReference EXTENSION_SHEET =\n+        new DocumentReference(WIKI_NAME, \"ExtensionCode\", \"ExtensionSheet\");\n+\n+    private static final DocumentReference EXTENSION_CLASS =\n+        new DocumentReference(WIKI_NAME, \"ExtensionCode\", \"ExtensionClass\");\n+\n+    private static final DocumentReference EXTENSION_DEPENDENCY_CLASS =\n+        new DocumentReference(WIKI_NAME, \"ExtensionCode\", \"ExtensionDependencyClass\");\n+\n+    private static final DocumentReference EXTENSION_VERSION_CLASS =\n+        new DocumentReference(WIKI_NAME, \"ExtensionCode\", \"ExtensionVersionClass\");\n+\n+    private static final DocumentReference EXTENSION_AUTHORS_DISPLAYER =\n+        new DocumentReference(WIKI_NAME, \"ExtensionCode\", \"ExtensionAuthorsDisplayer\");\n+\n+    private static final DocumentReference TEST_PAGE =\n+        new DocumentReference(WIKI_NAME, \"Test\", \"TestDocument\");\n+\n+    private XWikiDocument testPageDocument;\n+\n+    private XWikiDocument extensionSheetDocument;\n+\n+    @MockComponent\n+    @Named(\"groovy\")\n+    private MacroPermissionPolicy groovyMacroPermissionPolicy;\n+\n+    @BeforeEach\n+    void setUp() throws Exception\n+    {\n+        this.xwiki.initializeMandatoryDocuments(this.context);\n+        loadPage(EXTENSION_AUTHORS_DISPLAYER);\n+        loadPage(EXTENSION_DEPENDENCY_CLASS);\n+        loadPage(EXTENSION_VERSION_CLASS);\n+        loadPage(EXTENSION_CLASS);\n+        loadPage(EXTENSION_SHEET);\n+\n+        String testString = \"]]}}}{{async}}{{velocity}}{{noscript /}}{{/velocity}}{{/async}}\";\n+        String groovyTestString = \"\"\"\n+                {{async}}\n+                {{groovy}}\n+                services.logging.getLogger(\"Groovy\").error(\"SHOULD NOT BE CALLED!\")\n+                {{/groovy}}\n+                {{/async}}\n+            \"\"\";\n+\n+        this.extensionSheetDocument = this.xwiki.getDocument(EXTENSION_SHEET, this.context);\n+\n+        this.testPageDocument = this.xwiki.getDocument(TEST_PAGE, this.context);\n+        this.testPageDocument.setTitle(\"Extension Test\");\n+        BaseObject extensionObject =\n+            this.testPageDocument.newXObject(EXTENSION_CLASS, this.context);\n+        extensionObject.setStringValue(\"id\", testString);\n+        extensionObject.setStringValue(\"name\", testString);\n+        extensionObject.setStringValue(\"description\", groovyTestString);\n+        extensionObject.setStringValue(\"summary\", testString);\n+        extensionObject.setStringValue(\"icon\", testString);\n+        extensionObject.setStringValue(\"type\", testString);\n+        extensionObject.setStringValue(\"category\", testString);\n+        extensionObject.setStringValue(\"installedCount\", testString);\n+        extensionObject.setStringValue(\"licenseName\", testString);\n+        extensionObject.setStringValue(\"issueManagementURL\", testString);\n+        extensionObject.setStringValue(\"installation\", groovyTestString);\n+        extensionObject.setStringValue(\"lastVersion\", testString);\n+        extensionObject.setStringListValue(\"authors\", List.of(testString));\n+\n+        BaseObject extensionVersionObject = this.testPageDocument.newXObject(EXTENSION_VERSION_CLASS, this.context);\n+        extensionVersionObject.setStringValue(\"version\", testString);\n+        extensionVersionObject.setStringValue(\"notes\", groovyTestString);\n+\n+        BaseObject extensionDependencyObject =\n+            this.testPageDocument.newXObject(EXTENSION_DEPENDENCY_CLASS, this.context);\n+        extensionDependencyObject.setStringValue(\"extensionVersion\", testString);\n+        extensionDependencyObject.setStringValue(\"id\", testString);\n+        extensionDependencyObject.setStringValue(\"constraint\", testString);\n+\n+        // Mock the database.\n+        Query query = mock(Query.class);\n+        QueryManagerScriptService queryManagerScriptService =\n+            this.componentManager.registerMockComponent(ScriptService.class, \"query\", QueryManagerScriptService.class,\n+                false);\n+        when(queryManagerScriptService.xwql(any())).thenReturn(query);\n+        when(query.bindValue(any(), any())).thenReturn(query);\n+        when(query.execute()).thenReturn(List.of());\n+\n+        // Mock restricted contexts.\n+        when(this.groovyMacroPermissionPolicy.hasPermission(any(), any())).thenAnswer(i ->\n+            !((MacroTransformationContext) i.getArgument(1)).getTransformationContext().isRestricted());\n+    }\n+\n+    @Test\n+    void display() throws Exception\n+    {\n+        this.context.setDoc(this.testPageDocument);\n+        // The only expectation is to not get any error log due to macro executions.\n+        renderHTMLPage(this.extensionSheetDocument);\n+    }\n+}"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 3,
        "max_directory_depth": 11
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "20d352276c008c8ea2a1cf1ea9ceb84193098477",
            "date": "2025-01-25T19:15:09Z",
            "author_login": "mflorea"
          },
          {
            "sha": "e29b630b2d5a42b6f12ed3f0e4f59bd078f8a0f7",
            "date": "2025-01-24T07:34:53Z",
            "author_login": "mflorea"
          },
          {
            "sha": "023144daf732d04b085c2423ebd4552edd09ac5c",
            "date": "2025-01-24T15:44:30Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "a46579427dc202957d623b8e69a6a894243c6690",
            "date": "2025-01-21T16:53:45Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "3d661180a9075925c3d2d75816356925f32ae89d",
            "date": "2025-01-21T16:13:46Z",
            "author_login": "Sereza7"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 9.9,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
    "cwe_id": "CWE-96",
    "description": "XWiki Platform is a generic wiki platform. Starting in version 3.3-milestone-1 and prior to versions 15.10.9 and 16.3.0, on instances where `Extension Repository Application` is installed, any user can execute any code requiring `programming` rights on the server. This vulnerability has been fixed in XWiki 15.10.9 and 16.3.0. Since `Extension Repository Application` is not mandatory, it can be safely disabled on instances that do not use it as a workaround. It is also possible to manually apply the patches from commit 8659f17d500522bf33595e402391592a35a162e8 to the page `ExtensionCode.ExtensionSheet` and to the page `ExtensionCode.ExtensionAuthorsDisplayer`.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-12-12T18:15:27.860",
    "last_modified": "2024-12-13T15:15:42.707",
    "fix_date": "2024-04-05T08:19:50Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/8659f17d500522bf33595e402391592a35a162e8",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-j2pq-22jj-4pm5",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-21890",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-21890",
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:33.134371",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-25T19:23:49Z",
    "pushed_at": "2025-01-25T19:23:45Z",
    "size": 563394,
    "stars": 1035,
    "forks": 555,
    "open_issues": 143,
    "watchers": 1035,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34352251,
      "JavaScript": 2404688,
      "HTML": 388086,
      "Less": 318876,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115582,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1743,
      "avg_commits_per_week": 33.51923076923077,
      "days_active_last_year": 261
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-26T07:34:26.816515"
  }
}