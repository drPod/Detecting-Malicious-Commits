{
  "cve_id": "CVE-2024-55876",
  "github_data": {
    "repository": "xwiki/xwiki-platform",
    "fix_commit": "54bcc5a7a2e440cc591b91eece9c13dc0c487331",
    "related_commits": [
      "54bcc5a7a2e440cc591b91eece9c13dc0c487331"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "54bcc5a7a2e440cc591b91eece9c13dc0c487331",
      "commit_date": "2024-04-26T17:14:06Z",
      "author": {
        "login": "pjeanjean",
        "type": "User",
        "stats": {
          "total_commits": 36,
          "average_weekly_commits": 0.03765690376569038,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 23
        }
      },
      "commit_message": {
        "title": "XWIKI-21663: Improve Scheduler access",
        "length": 37,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 272,
        "additions": 82,
        "deletions": 190
      },
      "files": [
        {
          "filename": "xwiki-platform-core/xwiki-platform-oldcore/src/main/resources/ApplicationResources.properties",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -2896,6 +2896,7 @@ xe.scheduler.job.backtolist=Back to the job list\n xe.scheduler.job.object=This sheet must be applied to a page that holds a scheduler job object.\n xe.scheduler.updateJobClassComment=Created/Updated Scheduler Job Class definition\n xe.scheduler.invalidToken=Invalid token, please try again by clicking on the desired action below.\n+xe.scheduler.missingProgrammingRights=This action requires programming rights.\n \n ### Statistics application\n xe.statistics.activity=Activity Statistics"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-scheduler/xwiki-platform-scheduler-ui/pom.xml",
          "status": "modified",
          "additions": 21,
          "deletions": 0,
          "patch": "@@ -97,5 +97,26 @@\n       <type>test-jar</type>\n       <scope>test</scope>\n     </dependency>\n+    <!-- Provides the component list for SecurityAuthorizationScriptService. -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-security-authorization-script</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-security-authorization-script</artifactId>\n+      <version>${project.version}</version>\n+      <type>test-jar</type>\n+      <scope>test</scope>\n+    </dependency>\n+    <!-- Provides TranslationMacro -->\n+    <dependency>\n+      <groupId>org.xwiki.platform</groupId>\n+      <artifactId>xwiki-platform-localization-macro</artifactId>\n+      <version>${project.version}</version>\n+      <scope>test</scope>\n+    </dependency>\n   </dependencies>\n </project>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-scheduler/xwiki-platform-scheduler-ui/src/main/resources/Scheduler/WebHome.xml",
          "status": "modified",
          "additions": 30,
          "deletions": 23,
          "patch": "@@ -41,7 +41,8 @@\n ##\n #set ($scheduler = $xwiki.scheduler)\n ##\n-## If the sheet is called with an action ($request.do), let us first process this action\n+## If the sheet is called with an action ($request.do), let us first process this action after checking the user has\n+## programming rights.\n ## Possible values are : \"schedule\", \"pause\", \"resume\", \"unschedule\", \"delete\"\n ##\n #if (\"$!request.do\" != '' &amp;&amp; \"$!request.which\" != '')\n@@ -51,23 +52,29 @@\n   #set ($tJobHolder = $request.which)\n   #set ($jobDoc = $xwiki.getDocument($tJobHolder))\n   #set ($jobObj = $jobDoc.getObject('XWiki.SchedulerJobClass'))\n-  #if (!$services.csrf.isTokenValid($request.form_token))\n+  #if (!$services.security.authorization.hasAccess('programming', $xcontext.userReference, $doc.documentReference))\n+     ##\n+     ## Check that the user has programming rights\n+     ##\n+     {{error}}{{translation key='xe.scheduler.missingProgrammingRights'/}}{{/error}}\n+\n+  #elseif (!$services.csrf.isTokenValid($request.form_token))\n      ##\n      ## Check that the CSRF token matches the user before any operation\n      ##\n-     {{error}}$services.localization.render('xe.scheduler.invalidToken'){{/error}}\n+     {{error}}{{translation key='xe.scheduler.invalidToken'/}}{{/error}}\n \n   #elseif ($request.do == 'schedule')\n     ##\n     ## Schedule a job\n     ##\n     #set ($ok = $scheduler.scheduleJob($jobObj))\n     #if (!$ok)\n-      {{error}}$xcontext.get('error'){{/error}}\n+      {{error}}$escapetool.xml($xcontext.get('error')){{/error}}\n \n     #else\n       #set ($jobName = \"$jobObj.get('jobName')\")\n-      {{info}}$services.localization.render('xe.scheduler.jobscheduled', [$jobName, $scheduler.getNextFireTime($jobObj)]){{/info}}\n+      {{info}}$escapetool.xml($services.localization.render('xe.scheduler.jobscheduled', [$jobName, $scheduler.getNextFireTime($jobObj)])){{/info}}\n \n     #end\n   #elseif ($request.do == 'pause')\n@@ -76,10 +83,10 @@\n     ##\n     #set ($ok = $scheduler.pauseJob($jobObj))\n     #if (!$ok)\n-      {{error}}$xcontext.get('error'){{/error}}\n+      {{error}}$escapetool.xml($xcontext.get('error')){{/error}}\n \n     #else\n-      {{info}}$services.localization.render('xe.scheduler.paused', [$jobObj.get('jobName')]){{/info}}\n+      {{info}}$escapetool.xml($services.localization.render('xe.scheduler.paused', [$jobObj.get('jobName')])){{/info}}\n \n     #end\n   #elseif ($request.do == 'resume')\n@@ -88,10 +95,10 @@\n     ##\n     #set ($ok = $scheduler.resumeJob($jobObj))\n     #if (!$ok)\n-      {{error}}$xcontext.get('error'){{/error}}\n+      {{error}}$escapetool.xml($xcontext.get('error')){{/error}}\n \n     #else\n-      {{info}}$services.localization.render('xe.scheduler.resumed', [$jobObj.get('jobName'), $scheduler.getNextFireTime($jobObj)]){{/info}}\n+      {{info}}$escapetool.xml($services.localization.render('xe.scheduler.resumed', [$jobObj.get('jobName'), $scheduler.getNextFireTime($jobObj)])){{/info}}\n \n     #end\n   #elseif ($request.do == 'unschedule')\n@@ -100,10 +107,10 @@\n     ##\n     #set ($ok = $scheduler.unscheduleJob($jobObj))\n     #if (!$ok)\n-      {{error}}$xcontext.get('error'){{/error}}\n+      {{error}}$escapetool.xml($xcontext.get('error')){{/error}}\n \n     #else\n-      {{info}}$services.localization.render('xe.scheduler.unscheduled', [$jobObj.get('jobName')]){{/info}}\n+      {{info}}$escapetool.xml($services.localization.render('xe.scheduler.unscheduled', [$jobObj.get('jobName')])){{/info}}\n \n     #end\n   #elseif ($request.do == 'delete')\n@@ -118,7 +125,7 @@\n         #set ($deleteRedirect = $xwiki.getURL($jobObj.getName(), 'delete'))\n         $response.sendRedirect($deleteRedirect)\n       #else\n-        {{error}}$xcontext.get('error'){{/error}}\n+        {{error}}$escapetool.xml($xcontext.get('error')){{/error}}\n \n       #end\n     #else\n@@ -131,23 +138,23 @@\n     ##\n     #set ($ok = $scheduler.triggerJob($jobObj))\n     #if (!$ok)\n-      {{error}}$xcontext.get('error'){{/error}}\n+      {{error}}$escapetool.xml($xcontext.get('error')){{/error}}\n \n     #else\n-      {{info}}$services.localization.render('xe.scheduler.triggered', [$jobObj.get('jobName')]){{/info}}\n+      {{info}}$escapetool.xml($services.localization.render('xe.scheduler.triggered', [$jobObj.get('jobName')])){{/info}}\n \n     #end\n   #end\n #end\n-$services.localization.render('xe.scheduler.welcome')\n+{{translation key='xe.scheduler.welcome'/}}\n \n-= $services.localization.render('xe.scheduler.jobs.list') =\n+= {{translation key='xe.scheduler.jobs.list'/}} =\n \n ##\n ## Retrieve all scheduler jobs\n ## Display their name, status, possible next fire time, and available actions\n ##\n-|=(%scope=\"col\"%)$services.localization.render('xe.scheduler.jobs.name')|=(%scope=\"col\"%)$services.localization.render('xe.scheduler.jobs.status')|=(%scope=\"col\"%)$services.localization.render('xe.scheduler.jobs.next')|=(%scope=\"col\"%)$services.localization.render('xe.scheduler.jobs.actions')\n+|=(%scope=\"col\"%){{translation key='xe.scheduler.jobs.name'/}}|=(%scope=\"col\"%){{translation key='xe.scheduler.jobs.status'/}}|=(%scope=\"col\"%){{translation key='xe.scheduler.jobs.next'/}}|=(%scope=\"col\"%){{translation key='xe.scheduler.jobs.actions'/}}\n #foreach ($docName in $services.query.xwql('from doc.object(XWiki.SchedulerJobClass) as jobs where doc.fullName &lt;&gt; ''XWiki.SchedulerJobTemplate''').execute())\n   #set ($jobHolder = $xwiki.getDocument($docName))\n   #set ($job = $jobHolder.getObject('XWiki.SchedulerJobClass'))\n@@ -159,7 +166,7 @@ $services.localization.render('xe.scheduler.welcome')\n   #if ($status != 'None')\n     #set ($firetime = $scheduler.getNextFireTime($job))\n   #else\n-    #set ($firetime = $services.localization.render('xe.scheduler.jobs.next.undefined'))\n+    #set ($firetime = \"{{translation key='xe.scheduler.jobs.next.undefined'/}}\")\n   #end\n   #set ($actions = ['trigger'])\n   #if ($status == 'None')\n@@ -170,7 +177,7 @@ $services.localization.render('xe.scheduler.welcome')\n     #set ($ok = $actions.addAll(['resume', 'unschedule']))\n   #end\n   #set ($ok = $actions.add('delete'))\n-|$job.get('jobName')|$status|$firetime|**$services.localization.render('xe.scheduler.jobs.actions.access')** [[$services.localization.render('xe.scheduler.jobs.actions.view')&gt;&gt;$services.rendering.escape($jobHolder.fullName, 'xwiki/2.1')]]#if($jobHolder.hasAccessLevel('programming')) [[$services.localization.render('xe.scheduler.jobs.actions.edit')&gt;&gt;path:${jobHolder.getURL('edit')}]]#end **$services.localization.render('xe.scheduler.jobs.actions.manage')**#foreach($action in $actions) [[$services.localization.render(\"xe.scheduler.jobs.actions.$action\")&gt;&gt;path:$doc.getURL('view', $escapetool.url({'do': $action, 'which': $jobHolder.fullName, 'form_token': $services.csrf.token}))]]#end\n+|$job.get('jobName')|$status|$firetime|**{{translation key='xe.scheduler.jobs.actions.access'/}}** [[{{translation key='xe.scheduler.jobs.actions.view'/}}&gt;&gt;$services.rendering.escape($jobHolder.fullName, 'xwiki/2.1')]]#if($jobHolder.hasAccessLevel('programming')) [[{{translation key='xe.scheduler.jobs.actions.edit'/}}&gt;&gt;path:${jobHolder.getURL('edit')}]]#end **{{translation key='xe.scheduler.jobs.actions.manage'/}}**#foreach($action in $actions) [[{{translation key='xe.scheduler.jobs.actions.$action'/}}&gt;&gt;path:$doc.getURL('view', $escapetool.url({'do': $action, 'which': $jobHolder.fullName, 'form_token': $services.csrf.token}))]]#end\n \n #end\n #if ($doc.hasAccessLevel('programming'))\n@@ -181,12 +188,12 @@ $services.localization.render('xe.scheduler.welcome')\n ## schedule, pause, etc.\n ##\n \n-= $services.localization.render('xe.scheduler.jobs.create') =\n+= {{translation key='xe.scheduler.jobs.create'/}} =\n \n ##\n ## Form to create a new Job\n ##\n-{{info}}$services.localization.render('xe.scheduler.jobs.explaincreate'){{/info}}\n+{{info}}{{translation key='xe.scheduler.jobs.explaincreate'/}}{{/info}}\n \n {{html}}\n &lt;form action=\"$doc.getURL('create')\" id=\"newdoc\" class=\"form-inline\"&gt;&lt;div&gt;\n@@ -195,7 +202,7 @@ $services.localization.render('xe.scheduler.welcome')\n   &lt;input type=\"hidden\" name=\"template\" value=\"XWiki.SchedulerJobTemplate\" /&gt;\n   &lt;input type=\"hidden\" name=\"sheet\" value=\"1\" /&gt;\n   &lt;input type=\"hidden\" name=\"space\" value=\"Scheduler\"/&gt;\n-  &lt;label class=\"sr-only\" for=\"page\"&gt;$services.localization.render('xe.scheduler.jobs.create.nameTip')&lt;/label&gt;\n+  &lt;label class=\"sr-only\" for=\"page\"&gt;$escapetool.xml($services.localization.render('xe.scheduler.jobs.create.nameTip'))&lt;/label&gt;\n   &lt;input id=\"page\" name=\"page\" size=\"30\" type=\"text\"\n       placeholder=\"$escapetool.xml($services.localization.render('xe.scheduler.jobs.create.nameTip'))\" /&gt;\n   &lt;span class=\"buttonwrapper\"&gt;\n@@ -207,7 +214,7 @@ $services.localization.render('xe.scheduler.welcome')\n \n #else\n \n-  {{warning}}$services.localization.render('xe.scheduler.jobs.warning'){{/warning}}\n+  {{warning}}{{translation key='xe.scheduler.jobs.warning'/}}{{/warning}}\n \n #end\n {{/velocity}}</content>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-scheduler/xwiki-platform-scheduler-ui/src/main/resources/Scheduler/WebPreferences.xml",
          "status": "modified",
          "additions": 1,
          "deletions": 167,
          "patch": "@@ -114,176 +114,10 @@\n       <groups>XWiki.XWikiAdminGroup</groups>\n     </property>\n     <property>\n-      <levels>admin,edit</levels>\n+      <levels>view,edit,comment,delete,admin</levels>\n     </property>\n     <property>\n       <users/>\n     </property>\n   </object>\n-  <object>\n-    <name>Scheduler.WebPreferences</name>\n-    <number>1</number>\n-    <className>XWiki.XWikiGlobalRights</className>\n-    <guid>0b2c7da3-315a-4a6d-b782-5de0b20b6497</guid>\n-    <class>\n-      <name>XWiki.XWikiGlobalRights</name>\n-      <customClass/>\n-      <customMapping/>\n-      <defaultViewSheet/>\n-      <defaultEditSheet/>\n-      <defaultWeb/>\n-      <nameField/>\n-      <validationScript/>\n-      <allow>\n-        <defaultValue>1</defaultValue>\n-        <disabled>0</disabled>\n-        <displayFormType>select</displayFormType>\n-        <displayType>allow</displayType>\n-        <name>allow</name>\n-        <number>4</number>\n-        <prettyName>Allow/Deny</prettyName>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n-      </allow>\n-      <groups>\n-        <cache>0</cache>\n-        <disabled>0</disabled>\n-        <displayType>input</displayType>\n-        <multiSelect>1</multiSelect>\n-        <name>groups</name>\n-        <number>1</number>\n-        <picker>1</picker>\n-        <prettyName>Groups</prettyName>\n-        <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n-        <size>5</size>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>\n-      </groups>\n-      <levels>\n-        <cache>0</cache>\n-        <disabled>0</disabled>\n-        <displayType>select</displayType>\n-        <multiSelect>1</multiSelect>\n-        <name>levels</name>\n-        <number>2</number>\n-        <prettyName>Levels</prettyName>\n-        <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n-        <size>3</size>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>\n-      </levels>\n-      <users>\n-        <cache>0</cache>\n-        <disabled>0</disabled>\n-        <displayType>input</displayType>\n-        <multiSelect>1</multiSelect>\n-        <name>users</name>\n-        <number>3</number>\n-        <picker>1</picker>\n-        <prettyName>Users</prettyName>\n-        <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n-        <size>5</size>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>\n-      </users>\n-    </class>\n-    <property>\n-      <allow>0</allow>\n-    </property>\n-    <property>\n-      <groups>XWiki.XWikiAllGroup</groups>\n-    </property>\n-    <property>\n-      <levels>view</levels>\n-    </property>\n-    <property>\n-      <users/>\n-    </property>\n-  </object>\n-  <object>\n-    <name>Scheduler.WebPreferences</name>\n-    <number>2</number>\n-    <className>XWiki.XWikiGlobalRights</className>\n-    <guid>fef3f075-e0ed-46d1-991f-680326129a9d</guid>\n-    <class>\n-      <name>XWiki.XWikiGlobalRights</name>\n-      <customClass/>\n-      <customMapping/>\n-      <defaultViewSheet/>\n-      <defaultEditSheet/>\n-      <defaultWeb/>\n-      <nameField/>\n-      <validationScript/>\n-      <allow>\n-        <defaultValue>1</defaultValue>\n-        <disabled>0</disabled>\n-        <displayFormType>select</displayFormType>\n-        <displayType>allow</displayType>\n-        <name>allow</name>\n-        <number>4</number>\n-        <prettyName>Allow/Deny</prettyName>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.BooleanClass</classType>\n-      </allow>\n-      <groups>\n-        <cache>0</cache>\n-        <disabled>0</disabled>\n-        <displayType>input</displayType>\n-        <multiSelect>1</multiSelect>\n-        <name>groups</name>\n-        <number>1</number>\n-        <picker>1</picker>\n-        <prettyName>Groups</prettyName>\n-        <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n-        <size>5</size>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.GroupsClass</classType>\n-      </groups>\n-      <levels>\n-        <cache>0</cache>\n-        <disabled>0</disabled>\n-        <displayType>select</displayType>\n-        <multiSelect>1</multiSelect>\n-        <name>levels</name>\n-        <number>2</number>\n-        <prettyName>Levels</prettyName>\n-        <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n-        <size>3</size>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.LevelsClass</classType>\n-      </levels>\n-      <users>\n-        <cache>0</cache>\n-        <disabled>0</disabled>\n-        <displayType>input</displayType>\n-        <multiSelect>1</multiSelect>\n-        <name>users</name>\n-        <number>3</number>\n-        <picker>1</picker>\n-        <prettyName>Users</prettyName>\n-        <relationalStorage>0</relationalStorage>\n-        <separator> </separator>\n-        <size>5</size>\n-        <unmodifiable>0</unmodifiable>\n-        <classType>com.xpn.xwiki.objects.classes.UsersClass</classType>\n-      </users>\n-    </class>\n-    <property>\n-      <allow>0</allow>\n-    </property>\n-    <property>\n-      <groups/>\n-    </property>\n-    <property>\n-      <levels>view</levels>\n-    </property>\n-    <property>\n-      <users>XWiki.XWikiGuest</users>\n-    </property>\n-  </object>\n </xwikidoc>"
        },
        {
          "filename": "xwiki-platform-core/xwiki-platform-scheduler/xwiki-platform-scheduler-ui/src/test/java/org/xwiki/scheduler/ui/SchedulerPageTest.java",
          "status": "modified",
          "additions": 29,
          "deletions": 0,
          "patch": "@@ -32,6 +32,7 @@\n import org.mockito.Mock;\n import org.quartz.Trigger;\n import org.xwiki.csrf.script.CSRFTokenScriptService;\n+import org.xwiki.localization.macro.internal.TranslationMacro;\n import org.xwiki.model.reference.DocumentReference;\n import org.xwiki.query.internal.ScriptQuery;\n import org.xwiki.query.script.QueryManagerScriptService;\n@@ -41,6 +42,10 @@\n import org.xwiki.rendering.internal.macro.message.InfoMessageMacro;\n import org.xwiki.rendering.internal.macro.message.WarningMessageMacro;\n import org.xwiki.script.service.ScriptService;\n+import org.xwiki.security.authorization.Right;\n+import org.xwiki.security.authorization.script.SecurityAuthorizationScriptService;\n+import org.xwiki.security.script.SecurityScriptService;\n+import org.xwiki.security.script.SecurityScriptServiceComponentList;\n import org.xwiki.test.annotation.ComponentList;\n import org.xwiki.test.page.HTML50ComponentList;\n import org.xwiki.test.page.PageTest;\n@@ -77,8 +82,10 @@\n     ErrorMessageMacro.class,\n     SchedulerJobClassDocumentInitializer.class,\n     TestNoScriptMacro.class,\n+    TranslationMacro.class,\n     WarningMessageMacro.class\n })\n+@SecurityScriptServiceComponentList\n @RenderingScriptServiceComponentList\n @DefaultRenderingConfigurationComponentList\n @HTML50ComponentList\n@@ -98,6 +105,8 @@ class SchedulerPageTest extends PageTest\n \n     private CSRFTokenScriptService tokenService;\n \n+    private SecurityAuthorizationScriptService authorizationScriptService;\n+\n     private SchedulerPluginApi schedulerPluginApi;\n \n     @Mock\n@@ -138,6 +147,9 @@ void setUp() throws Exception\n         // Fake programming access level to display the complete page.\n         when(this.oldcore.getMockRightService().hasAccessLevel(eq(\"programming\"), anyString(), anyString(),\n             any(XWikiContext.class))).thenReturn(true);\n+        this.authorizationScriptService = this.oldcore.getMocker().getInstance(ScriptService.class,\n+            SecurityScriptService.ROLEHINT + \".\" + SecurityAuthorizationScriptService.ID);\n+        when(this.authorizationScriptService.hasAccess(eq(Right.PROGRAM), any(), any())).thenReturn(true);\n     }\n \n     /**\n@@ -178,6 +190,23 @@ void checkValidCSRFToken() throws Exception\n         assertTrue(result.getElementsByClass(\"errormessage\").isEmpty());\n     }\n \n+    /**\n+     * Check that the trigger operation fails if the user is missing programming rights.\n+     */\n+    @Test\n+    void checkMissingProgrammingRights() throws Exception\n+    {\n+        when(this.authorizationScriptService.hasAccess(eq(Right.PROGRAM), any(), any())).thenReturn(false);\n+        when(this.schedulerPluginApi.triggerJob(this.testJobObjectApi)).thenReturn(true);\n+\n+        this.request.put(\"do\", \"trigger\");\n+        this.request.put(\"which\", \"Scheduler.TestJob\");\n+        Document result = renderHTMLPage(SCHEDULER_WEB_HOME);\n+\n+        verify(this.schedulerPluginApi, never()).triggerJob(any(Object.class));\n+        assertEquals(\"xe.scheduler.missingProgrammingRights\", result.getElementsByClass(\"errormessage\").text());\n+    }\n+\n     /**\n      * List every possible action that can be applied to a job depending on its current status.\n      *"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 1,
        "unique_directories": 4,
        "max_directory_depth": 10
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "20d352276c008c8ea2a1cf1ea9ceb84193098477",
            "date": "2025-01-25T19:15:09Z",
            "author_login": "mflorea"
          },
          {
            "sha": "e29b630b2d5a42b6f12ed3f0e4f59bd078f8a0f7",
            "date": "2025-01-24T07:34:53Z",
            "author_login": "mflorea"
          },
          {
            "sha": "023144daf732d04b085c2423ebd4552edd09ac5c",
            "date": "2025-01-24T15:44:30Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "a46579427dc202957d623b8e69a6a894243c6690",
            "date": "2025-01-21T16:53:45Z",
            "author_login": "Sereza7"
          },
          {
            "sha": "3d661180a9075925c3d2d75816356925f32ae89d",
            "date": "2025-01-21T16:13:46Z",
            "author_login": "Sereza7"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-862",
    "description": "XWiki Platform is a generic wiki platform. Starting in version 1.2-milestone-2 and prior to versions 15.10.9 and 16.3.0, any user with an account on the main wiki could run scheduling operations on subwikis. To reproduce, as a user on the main wiki without any special right, view the document `Scheduler.WebHome` in a subwiki. Then, click on any operation (*e.g.,* Trigger) on any job. If the operation is successful, then the instance is vulnerable. This has been patched in XWiki 15.10.9 and 16.3.0. As a workaround, those who have subwikis where the Job Scheduler is enabled can edit the objects on `Scheduler.WebPreferences` to match the patch.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-12-12T19:15:14.140",
    "last_modified": "2024-12-13T15:15:42.960",
    "fix_date": "2024-04-26T17:14:06Z"
  },
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/54bcc5a7a2e440cc591b91eece9c13dc0c487331",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-cwq6-mjmx-47p6",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-21663",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-21663",
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:33.134930",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "xwiki-platform",
    "owner": "xwiki",
    "created_at": "2011-03-10T13:26:41Z",
    "updated_at": "2025-01-25T19:23:49Z",
    "pushed_at": "2025-01-25T19:23:45Z",
    "size": 563394,
    "stars": 1035,
    "forks": 555,
    "open_issues": 143,
    "watchers": 1035,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [],
    "languages": {
      "Java": 34352251,
      "JavaScript": 2404688,
      "HTML": 388086,
      "Less": 318876,
      "AspectJ": 280487,
      "Vue": 222987,
      "CSS": 115582,
      "XSLT": 109285,
      "Clean": 44054,
      "Shell": 32569,
      "Batchfile": 14604,
      "Python": 5046,
      "Groovy": 3012,
      "AMPL": 1296
    },
    "commit_activity": {
      "total_commits_last_year": 1743,
      "avg_commits_per_week": 33.51923076923077,
      "days_active_last_year": 261
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": false,
      "allow_forking": true,
      "is_template": false,
      "license": "lgpl-2.1"
    },
    "collected_at": "2025-01-26T07:34:26.816515"
  }
}