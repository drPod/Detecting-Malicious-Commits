{
  "cve_id": "CVE-2024-56198",
  "github_data": {
    "repository": "cabraviva/path-sanitizer",
    "fix_commit": "b6d2319eac910dffdfacc8460f5b5cc5a1518ead",
    "related_commits": [
      "b6d2319eac910dffdfacc8460f5b5cc5a1518ead"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "b6d2319eac910dffdfacc8460f5b5cc5a1518ead",
      "commit_date": "2024-12-31T09:26:43Z",
      "author": {
        "login": "cabraviva",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Merge pull request #2 from cabraviva/dev",
        "length": 72,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 142,
        "additions": 80,
        "deletions": 62
      },
      "files": [
        {
          "filename": "lib/index.test.ts",
          "status": "modified",
          "additions": 4,
          "deletions": 0,
          "patch": "@@ -192,4 +192,8 @@ describe('sanitize() - Vulnerability Tests', () => {\n     it('Protects reported vulnerability #1', () => {\n         expect(linuxSlash(join('/var/app-dir', sanitize(\"..=%5c..=%5c..=%5c..=%5c..=%5c..=%5c..=%5cetc/passwd\")))).not.toBe('/etc/passwd')\n     })\n+\n+    it('Protects reported vulnerability #2', () => {\n+        expect(linuxSlash(join('/var/app', sanitize(\"./../../test/../../../../../../../../../../etc/passwd\")))).not.toBe('/etc/passwd')\n+    })\n })"
        },
        {
          "filename": "lib/index.ts",
          "status": "modified",
          "additions": 14,
          "deletions": 0,
          "patch": "@@ -103,6 +103,20 @@ export default function sanitize(pathstr: string, options: SanitizeOptions = DEF\n     // Replace double (back)slashes with a single slash\n     sanitizedPath = sanitizedPath.replace(/[\\/\\\\]+/g, '/')\n \n+    // Replace /../ with /\n+    sanitizedPath = sanitizedPath.replace(options.parentDirectoryRegEx, '/')\n+\n+    // Remove ./ or / at start\n+    while (sanitizedPath.startsWith('/') || sanitizedPath.startsWith('./') || sanitizedPath.endsWith('/..') || sanitizedPath.endsWith('/../') || sanitizedPath.startsWith('../') || sanitizedPath.startsWith('/../')) {\n+        sanitizedPath = sanitizedPath.replace(/^\\.\\//g, '') // ^./\n+        sanitizedPath = sanitizedPath.replace(/^\\//g, '') // ^/\n+        // Remove ../ | /../ at pos 0 and /.. | /../ at end\n+        sanitizedPath = sanitizedPath.replace(/^[\\/\\\\]\\.\\.[\\/\\\\]/g, '/')\n+        sanitizedPath = sanitizedPath.replace(/^\\.\\.[\\/\\\\]/g, '/')\n+        sanitizedPath = sanitizedPath.replace(/[\\/\\\\]\\.\\.$/g, '/')\n+        sanitizedPath = sanitizedPath.replace(/[\\/\\\\]\\.\\.\\/$/g, '/')\n+    }\n+\n     // Make sure out is not \".\"\n     sanitizedPath = sanitizedPath.trim() === '.' ? '' : sanitizedPath\n "
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -20,8 +20,8 @@\n     \"homepage\": \"https://github.com/cabraviva/path-sanitizer#readme\",\n     \"types\": \"dist/index.d.ts\",\n     \"devDependencies\": {\n-        \"@types/node\": \"^22.9.3\",\n+        \"@types/node\": \"^22.10.2\",\n         \"typescript\": \"^5.7.2\",\n-        \"vitest\": \"^2.1.5\"\n+        \"vitest\": \"^2.1.8\"\n     }\n }\n\\ No newline at end of file"
        },
        {
          "filename": "pnpm-lock.yaml",
          "status": "modified",
          "additions": 60,
          "deletions": 60,
          "patch": "@@ -9,14 +9,14 @@ importers:\n   .:\n     devDependencies:\n       '@types/node':\n-        specifier: ^22.9.3\n-        version: 22.9.3\n+        specifier: ^22.10.2\n+        version: 22.10.2\n       typescript:\n         specifier: ^5.7.2\n         version: 5.7.2\n       vitest:\n-        specifier: ^2.1.5\n-        version: 2.1.5(@types/node@22.9.3)\n+        specifier: ^2.1.8\n+        version: 2.1.8(@types/node@22.10.2)\n \n packages:\n \n@@ -254,14 +254,14 @@ packages:\n   '@types/estree@1.0.6':\n     resolution: {integrity: sha512-AYnb1nQyY49te+VRAVgmzfcgjYS91mY5P0TKUDCLEM+gNnA+3T6rWITXRLYCpahpqSQbN5cE+gHpnPyXjHWxcw==}\n \n-  '@types/node@22.9.3':\n-    resolution: {integrity: sha512-F3u1fs/fce3FFk+DAxbxc78DF8x0cY09RRL8GnXLmkJ1jvx3TtPdWoTT5/NiYfI5ASqXBmfqJi9dZ3gxMx4lzw==}\n+  '@types/node@22.10.2':\n+    resolution: {integrity: sha512-Xxr6BBRCAOQixvonOye19wnzyDiUtTeqldOOmj3CkeblonbccA12PFwlufvRdrpjXxqnmUaeiU5EOA+7s5diUQ==}\n \n-  '@vitest/expect@2.1.5':\n-    resolution: {integrity: sha512-nZSBTW1XIdpZvEJyoP/Sy8fUg0b8od7ZpGDkTUcfJ7wz/VoZAFzFfLyxVxGFhUjJzhYqSbIpfMtl/+k/dpWa3Q==}\n+  '@vitest/expect@2.1.8':\n+    resolution: {integrity: sha512-8ytZ/fFHq2g4PJVAtDX57mayemKgDR6X3Oa2Foro+EygiOJHUXhCqBAAKQYYajZpFoIfvBCF1j6R6IYRSIUFuw==}\n \n-  '@vitest/mocker@2.1.5':\n-    resolution: {integrity: sha512-XYW6l3UuBmitWqSUXTNXcVBUCRytDogBsWuNXQijc00dtnU/9OqpXWp4OJroVrad/gLIomAq9aW8yWDBtMthhQ==}\n+  '@vitest/mocker@2.1.8':\n+    resolution: {integrity: sha512-7guJ/47I6uqfttp33mgo6ga5Gr1VnL58rcqYKyShoRK9ebu8T5Rs6HN3s1NABiBeVTdWNrwUMcHH54uXZBN4zA==}\n     peerDependencies:\n       msw: ^2.4.9\n       vite: ^5.0.0\n@@ -271,20 +271,20 @@ packages:\n       vite:\n         optional: true\n \n-  '@vitest/pretty-format@2.1.5':\n-    resolution: {integrity: sha512-4ZOwtk2bqG5Y6xRGHcveZVr+6txkH7M2e+nPFd6guSoN638v/1XQ0K06eOpi0ptVU/2tW/pIU4IoPotY/GZ9fw==}\n+  '@vitest/pretty-format@2.1.8':\n+    resolution: {integrity: sha512-9HiSZ9zpqNLKlbIDRWOnAWqgcA7xu+8YxXSekhr0Ykab7PAYFkhkwoqVArPOtJhPmYeE2YHgKZlj3CP36z2AJQ==}\n \n-  '@vitest/runner@2.1.5':\n-    resolution: {integrity: sha512-pKHKy3uaUdh7X6p1pxOkgkVAFW7r2I818vHDthYLvUyjRfkKOU6P45PztOch4DZarWQne+VOaIMwA/erSSpB9g==}\n+  '@vitest/runner@2.1.8':\n+    resolution: {integrity: sha512-17ub8vQstRnRlIU5k50bG+QOMLHRhYPAna5tw8tYbj+jzjcspnwnwtPtiOlkuKC4+ixDPTuLZiqiWWQ2PSXHVg==}\n \n-  '@vitest/snapshot@2.1.5':\n-    resolution: {integrity: sha512-zmYw47mhfdfnYbuhkQvkkzYroXUumrwWDGlMjpdUr4jBd3HZiV2w7CQHj+z7AAS4VOtWxI4Zt4bWt4/sKcoIjg==}\n+  '@vitest/snapshot@2.1.8':\n+    resolution: {integrity: sha512-20T7xRFbmnkfcmgVEz+z3AU/3b0cEzZOt/zmnvZEctg64/QZbSDJEVm9fLnnlSi74KibmRsO9/Qabi+t0vCRPg==}\n \n-  '@vitest/spy@2.1.5':\n-    resolution: {integrity: sha512-aWZF3P0r3w6DiYTVskOYuhBc7EMc3jvn1TkBg8ttylFFRqNN2XGD7V5a4aQdk6QiUzZQ4klNBSpCLJgWNdIiNw==}\n+  '@vitest/spy@2.1.8':\n+    resolution: {integrity: sha512-5swjf2q95gXeYPevtW0BLk6H8+bPlMb4Vw/9Em4hFxDcaOxS+e0LOX4yqNxoHzMR2akEB2xfpnWUzkZokmgWDg==}\n \n-  '@vitest/utils@2.1.5':\n-    resolution: {integrity: sha512-yfj6Yrp0Vesw2cwJbP+cl04OC+IHFsuQsrsJBL9pyGeQXE56v1UAOQco+SR55Vf1nQzfV0QJg1Qum7AaWUwwYg==}\n+  '@vitest/utils@2.1.8':\n+    resolution: {integrity: sha512-dwSoui6djdwbfFmIgbIjX2ZhIoG7Ex/+xpxyiEgIGzjliY8xGkcpITKTlp6B4MgtGkF2ilvm97cPM96XZaAgcA==}\n \n   assertion-error@2.0.1:\n     resolution: {integrity: sha512-Izi8RQcffqCeNVgFigKli1ssklIbpHnCYc6AknXGYoB6grJqyeby7jv12JUQgmTAnIDnbck1uxksT4dzN3PWBA==}\n@@ -404,11 +404,11 @@ packages:\n     engines: {node: '>=14.17'}\n     hasBin: true\n \n-  undici-types@6.19.8:\n-    resolution: {integrity: sha512-ve2KP6f/JnbPBFyobGHuerC9g1FYGn/F8n1LWTwNxCEzd6IfqTwUQcNXgEtmmQ6DlRrC1hrSrBnCZPokRrDHjw==}\n+  undici-types@6.20.0:\n+    resolution: {integrity: sha512-Ny6QZ2Nju20vw1SRHe3d9jVu6gJ+4e3+MMpqu7pqE5HT6WsTSlce++GQmK5UXS8mzV8DSYHrQH+Xrf2jVcuKNg==}\n \n-  vite-node@2.1.5:\n-    resolution: {integrity: sha512-rd0QIgx74q4S1Rd56XIiL2cYEdyWn13cunYBIuqh9mpmQr7gGS0IxXoP8R6OaZtNQQLyXSWbd4rXKYUbhFpK5w==}\n+  vite-node@2.1.8:\n+    resolution: {integrity: sha512-uPAwSr57kYjAUux+8E2j0q0Fxpn8M9VoyfGiRI8Kfktz9NcYMCenwY5RnZxnF1WTu3TGiYipirIzacLL3VVGFg==}\n     engines: {node: ^18.0.0 || >=20.0.0}\n     hasBin: true\n \n@@ -443,15 +443,15 @@ packages:\n       terser:\n         optional: true\n \n-  vitest@2.1.5:\n-    resolution: {integrity: sha512-P4ljsdpuzRTPI/kbND2sDZ4VmieerR2c9szEZpjc+98Z9ebvnXmM5+0tHEKqYZumXqlvnmfWsjeFOjXVriDG7A==}\n+  vitest@2.1.8:\n+    resolution: {integrity: sha512-1vBKTZskHw/aosXqQUlVWWlGUxSJR8YtiyZDJAFeW2kPAeX6S3Sool0mjspO+kXLuxVWlEDDowBAeqeAQefqLQ==}\n     engines: {node: ^18.0.0 || >=20.0.0}\n     hasBin: true\n     peerDependencies:\n       '@edge-runtime/vm': '*'\n       '@types/node': ^18.0.0 || >=20.0.0\n-      '@vitest/browser': 2.1.5\n-      '@vitest/ui': 2.1.5\n+      '@vitest/browser': 2.1.8\n+      '@vitest/ui': 2.1.8\n       happy-dom: '*'\n       jsdom: '*'\n     peerDependenciesMeta:\n@@ -602,47 +602,47 @@ snapshots:\n \n   '@types/estree@1.0.6': {}\n \n-  '@types/node@22.9.3':\n+  '@types/node@22.10.2':\n     dependencies:\n-      undici-types: 6.19.8\n+      undici-types: 6.20.0\n \n-  '@vitest/expect@2.1.5':\n+  '@vitest/expect@2.1.8':\n     dependencies:\n-      '@vitest/spy': 2.1.5\n-      '@vitest/utils': 2.1.5\n+      '@vitest/spy': 2.1.8\n+      '@vitest/utils': 2.1.8\n       chai: 5.1.2\n       tinyrainbow: 1.2.0\n \n-  '@vitest/mocker@2.1.5(vite@5.4.11(@types/node@22.9.3))':\n+  '@vitest/mocker@2.1.8(vite@5.4.11(@types/node@22.10.2))':\n     dependencies:\n-      '@vitest/spy': 2.1.5\n+      '@vitest/spy': 2.1.8\n       estree-walker: 3.0.3\n       magic-string: 0.30.13\n     optionalDependencies:\n-      vite: 5.4.11(@types/node@22.9.3)\n+      vite: 5.4.11(@types/node@22.10.2)\n \n-  '@vitest/pretty-format@2.1.5':\n+  '@vitest/pretty-format@2.1.8':\n     dependencies:\n       tinyrainbow: 1.2.0\n \n-  '@vitest/runner@2.1.5':\n+  '@vitest/runner@2.1.8':\n     dependencies:\n-      '@vitest/utils': 2.1.5\n+      '@vitest/utils': 2.1.8\n       pathe: 1.1.2\n \n-  '@vitest/snapshot@2.1.5':\n+  '@vitest/snapshot@2.1.8':\n     dependencies:\n-      '@vitest/pretty-format': 2.1.5\n+      '@vitest/pretty-format': 2.1.8\n       magic-string: 0.30.13\n       pathe: 1.1.2\n \n-  '@vitest/spy@2.1.5':\n+  '@vitest/spy@2.1.8':\n     dependencies:\n       tinyspy: 3.0.2\n \n-  '@vitest/utils@2.1.5':\n+  '@vitest/utils@2.1.8':\n     dependencies:\n-      '@vitest/pretty-format': 2.1.5\n+      '@vitest/pretty-format': 2.1.8\n       loupe: 3.1.2\n       tinyrainbow: 1.2.0\n \n@@ -769,15 +769,15 @@ snapshots:\n \n   typescript@5.7.2: {}\n \n-  undici-types@6.19.8: {}\n+  undici-types@6.20.0: {}\n \n-  vite-node@2.1.5(@types/node@22.9.3):\n+  vite-node@2.1.8(@types/node@22.10.2):\n     dependencies:\n       cac: 6.7.14\n       debug: 4.3.7\n       es-module-lexer: 1.5.4\n       pathe: 1.1.2\n-      vite: 5.4.11(@types/node@22.9.3)\n+      vite: 5.4.11(@types/node@22.10.2)\n     transitivePeerDependencies:\n       - '@types/node'\n       - less\n@@ -789,24 +789,24 @@ snapshots:\n       - supports-color\n       - terser\n \n-  vite@5.4.11(@types/node@22.9.3):\n+  vite@5.4.11(@types/node@22.10.2):\n     dependencies:\n       esbuild: 0.21.5\n       postcss: 8.4.49\n       rollup: 4.27.4\n     optionalDependencies:\n-      '@types/node': 22.9.3\n+      '@types/node': 22.10.2\n       fsevents: 2.3.3\n \n-  vitest@2.1.5(@types/node@22.9.3):\n+  vitest@2.1.8(@types/node@22.10.2):\n     dependencies:\n-      '@vitest/expect': 2.1.5\n-      '@vitest/mocker': 2.1.5(vite@5.4.11(@types/node@22.9.3))\n-      '@vitest/pretty-format': 2.1.5\n-      '@vitest/runner': 2.1.5\n-      '@vitest/snapshot': 2.1.5\n-      '@vitest/spy': 2.1.5\n-      '@vitest/utils': 2.1.5\n+      '@vitest/expect': 2.1.8\n+      '@vitest/mocker': 2.1.8(vite@5.4.11(@types/node@22.10.2))\n+      '@vitest/pretty-format': 2.1.8\n+      '@vitest/runner': 2.1.8\n+      '@vitest/snapshot': 2.1.8\n+      '@vitest/spy': 2.1.8\n+      '@vitest/utils': 2.1.8\n       chai: 5.1.2\n       debug: 4.3.7\n       expect-type: 1.1.0\n@@ -817,11 +817,11 @@ snapshots:\n       tinyexec: 0.3.1\n       tinypool: 1.0.2\n       tinyrainbow: 1.2.0\n-      vite: 5.4.11(@types/node@22.9.3)\n-      vite-node: 2.1.5(@types/node@22.9.3)\n+      vite: 5.4.11(@types/node@22.10.2)\n+      vite-node: 2.1.8(@types/node@22.10.2)\n       why-is-node-running: 2.3.0\n     optionalDependencies:\n-      '@types/node': 22.9.3\n+      '@types/node': 22.10.2\n     transitivePeerDependencies:\n       - less\n       - lightningcss"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 1,
        "test_files": 1,
        "unique_directories": 2,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "ace95de09314241ae932923349ceaa35d3afa9a2",
            "date": "2024-12-31T09:29:48Z",
            "author_login": "cabraviva"
          },
          {
            "sha": "028fd50d562fb94057789d0dd9203c5547f5f39d",
            "date": "2024-12-31T09:28:44Z",
            "author_login": "cabraviva"
          },
          {
            "sha": "e8d03cadcd45ad7ce452caa5086013e97434c413",
            "date": "2024-12-31T09:28:12Z",
            "author_login": "dependabot[bot]"
          },
          {
            "sha": "b6d2319eac910dffdfacc8460f5b5cc5a1518ead",
            "date": "2024-12-31T09:26:43Z",
            "author_login": "cabraviva"
          },
          {
            "sha": "bb2e75880592b804ba20ba70b8e9f0b185ea5a79",
            "date": "2024-12-31T09:23:57Z",
            "author_login": "cabraviva"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-22",
    "description": "path-sanitizer is a simple lightweight npm package for sanitizing paths to prevent Path Traversal. Prior to 3.1.0, the filters can be bypassed using .=%5c which results in a path traversal. This vulnerability is fixed in 3.1.0.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-12-31T16:15:27.247",
    "last_modified": "2024-12-31T16:15:27.247",
    "fix_date": "2024-12-31T09:26:43Z"
  },
  "references": [
    {
      "url": "https://github.com/cabraviva/path-sanitizer/commit/b6d2319eac910dffdfacc8460f5b5cc5a1518ead",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/cabraviva/path-sanitizer/security/advisories/GHSA-94p5-r7cc-3rpr",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://www.loom.com/share/b766ece5193842848ce7562fcd559256?sid=fd826eb6-0eee-4601-bf0e-9cfee5c56e9d",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:52.938332",
    "processing_status": "enhanced"
  }
}