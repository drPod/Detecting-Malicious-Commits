{
  "cve_id": "CVE-2024-56331",
  "github_data": {
    "repository": "louislam/uptime-kuma",
    "fix_commit": "6cfae01a0d3727c517afe512fc8fec1d99acf875",
    "related_commits": [
      "6cfae01a0d3727c517afe512fc8fec1d99acf875"
    ],
    "patch_url": "https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875.patch",
    "fix_commit_details": {
      "sha": "6cfae01a0d3727c517afe512fc8fec1d99acf875",
      "commit_date": "2024-12-20T07:02:22Z",
      "author": {
        "login": "louislam",
        "type": "User",
        "stats": {
          "total_commits": 1690,
          "average_weekly_commits": 9.037433155080214,
          "total_additions": 269386,
          "total_deletions": 230044,
          "weeks_active": 145
        }
      },
      "commit_message": {
        "title": "Merge commit from fork",
        "length": 105,
        "has_description": true,
        "references_issue": true
      },
      "stats": {
        "total": 14,
        "additions": 11,
        "deletions": 3
      },
      "files": [
        {
          "filename": "package-lock.json",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -1,12 +1,12 @@\n {\n     \"name\": \"uptime-kuma\",\n-    \"version\": \"1.23.14\",\n+    \"version\": \"1.23.15\",\n     \"lockfileVersion\": 3,\n     \"requires\": true,\n     \"packages\": {\n         \"\": {\n             \"name\": \"uptime-kuma\",\n-            \"version\": \"1.23.14\",\n+            \"version\": \"1.23.15\",\n             \"license\": \"MIT\",\n             \"dependencies\": {\n                 \"@grpc/grpc-js\": \"~1.8.22\","
        },
        {
          "filename": "package.json",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -24,7 +24,7 @@\n         \"start-frontend-devcontainer\": \"cross-env NODE_ENV=development DEVCONTAINER=1 vite --host --config ./config/vite.config.js\",\n         \"start\": \"npm run start-server\",\n         \"start-server\": \"node server/server.js\",\n-        \"start-server-dev\": \"cross-env NODE_ENV=development node server/server.js\",\n+        \"start-server-dev\": \"cross-env NODE_ENV=development node server/server.js --data-dir=./data/v1/\",\n         \"build\": \"vite build --config ./config/vite.config.js\",\n         \"test\": \"node test/prepare-test-server.js && npm run jest-backend\",\n         \"test-with-build\": \"npm run build && npm test\","
        },
        {
          "filename": "server/monitor-types/real-browser-monitor-type.js",
          "status": "modified",
          "additions": 8,
          "deletions": 0,
          "patch": "@@ -193,6 +193,14 @@ class RealBrowserMonitorType extends MonitorType {\n         const context = await browser.newContext();\n         const page = await context.newPage();\n \n+        // Prevent Local File Inclusion\n+        // Accept only http:// and https://\n+        // https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h\n+        let url = new URL(monitor.url);\n+        if (url.protocol !== \"http:\" && url.protocol !== \"https:\") {\n+            throw new Error(\"Invalid url protocol, only http and https are allowed.\");\n+        }\n+\n         const res = await page.goto(monitor.url, {\n             waitUntil: \"networkidle\",\n             timeout: monitor.interval * 1000 * 0.8,"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 2,
        "dependency_files": 1,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "be2faf64ce8973d49d6c4b29dacdedbffc57855e",
            "date": "2024-12-22T05:46:13Z",
            "author_login": "louislam"
          },
          {
            "sha": "0b76e1940105117ed59c42105f4c8211ff4823d5",
            "date": "2024-12-22T05:45:19Z",
            "author_login": "louislam"
          },
          {
            "sha": "97cbaac5d94b5107c3b7da6ad4fca7cc7f2c8859",
            "date": "2024-12-21T11:26:36Z",
            "author_login": "Ionys320"
          },
          {
            "sha": "fd55659c2b209bc6780151f7c8c18378bffb8c44",
            "date": "2024-12-20T08:47:00Z",
            "author_login": "louislam"
          },
          {
            "sha": "20da4d29ab9c7325050f158f8af6ad1eed353002",
            "date": "2024-12-20T08:42:59Z",
            "author_login": "louislam"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 6.8,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:N/A:N",
    "cwe_id": "CWE-22",
    "description": "Uptime Kuma is an open source, self-hosted monitoring tool. An **Improper URL Handling Vulnerability** allows an attacker to access sensitive local files on the server by exploiting the `file:///` protocol. This vulnerability is triggered via the **\"real-browser\"** request type, which takes a screenshot of the URL provided by the attacker. By supplying local file paths, such as `file:///etc/passwd`, an attacker can read sensitive data from the server. This vulnerability arises because the system does not properly validate or sanitize the user input for the URL field. Specifically: 1. The URL input (`<input data-v-5f5c86d7=\"\" id=\"url\" type=\"url\" class=\"form-control\" pattern=\"https?://.+\" required=\"\">`) allows users to input arbitrary file paths, including those using the `file:///` protocol, without server-side validation. 2. The server then uses the user-provided URL to make a request, passing it to a browser instance that performs the \"real-browser\" request, which takes a screenshot of the content at the given URL. If a local file path is entered (e.g., `file:///etc/passwd`), the browser fetches and captures the file\u2019s content. Since the user input is not validated, an attacker can manipulate the URL to request local files (e.g., `file:///etc/passwd`), and the system will capture a screenshot of the file's content, potentially exposing sensitive data. Any **authenticated user** who can submit a URL in \"real-browser\" mode is at risk of exposing sensitive data through screenshots of these files. This issue has been addressed in version 1.23.16 and all users are advised to upgrade. There are no known workarounds for this vulnerability.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-12-20T20:15:24.337",
    "last_modified": "2024-12-20T20:15:24.337",
    "fix_date": "2024-12-20T07:02:22Z"
  },
  "references": [
    {
      "url": "https://github.com/louislam/uptime-kuma/commit/6cfae01a0d3727c517afe512fc8fec1d99acf875",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/louislam/uptime-kuma/security/advisories/GHSA-2qgm-m29m-cj2h",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:52.899089",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "uptime-kuma",
    "owner": "louislam",
    "created_at": "2021-07-03T01:02:42Z",
    "updated_at": "2025-01-14T13:35:01Z",
    "pushed_at": "2025-01-02T14:43:40Z",
    "size": 27366,
    "stars": 62522,
    "forks": 5572,
    "open_issues": 773,
    "watchers": 62522,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "1.23.X",
      "1.23.X-npm-update",
      "1.23.X-to-2",
      "2.0-last-part",
      "2.0.X",
      "2.1.X",
      "ansible-unofficial",
      "api-via-socketio-client",
      "async-fs",
      "check-lang-json",
      "convert-backend-test",
      "custom-head",
      "escaped-debug",
      "extracted-grpc-monitor",
      "fix-2.0.0-docs-update",
      "fix-check-migrate",
      "fix-data-type",
      "fix-knex",
      "fix-push-examples",
      "fix-weblate-conflict",
      "improve-heartbeat-msg",
      "master",
      "nfs-warning",
      "node22",
      "npm-publish",
      "queue",
      "release",
      "revert-4376-progress-bar-redesign",
      "revert-4704-dynamic_prometheus_labels",
      "testcontainers"
    ],
    "languages": {
      "JavaScript": 905295,
      "Vue": 681744,
      "TypeScript": 22221,
      "SCSS": 15534,
      "Dockerfile": 4408,
      "Go": 2699,
      "Shell": 2058,
      "HTML": 1102,
      "Java": 908,
      "C#": 557,
      "PowerShell": 387,
      "PHP": 322,
      "Python": 216
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T13:41:21.643142"
  }
}