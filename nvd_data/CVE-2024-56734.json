{
  "cve_id": "CVE-2024-56734",
  "github_data": {
    "repository": "better-auth/better-auth",
    "fix_commit": "deb3d73aea90d0468d92723f4511542b593e522f",
    "related_commits": [
      "deb3d73aea90d0468d92723f4511542b593e522f"
    ],
    "patch_url": "https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f.patch",
    "fix_commit_details": {
      "sha": "deb3d73aea90d0468d92723f4511542b593e522f",
      "commit_date": "2024-12-30T07:07:58Z",
      "author": {
        "login": "Bekacru",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix: enforce origin checker for GET methods",
        "length": 43,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 4,
        "additions": 1,
        "deletions": 3
      },
      "files": [
        {
          "filename": "packages/better-auth/src/api/middlewares/origin-check.ts",
          "status": "modified",
          "additions": 1,
          "deletions": 3,
          "patch": "@@ -2,15 +2,13 @@ import { APIError } from \"better-call\";\n import { createAuthMiddleware } from \"../call\";\n import { wildcardMatch } from \"../../utils/wildcard\";\n import { getHost } from \"../../utils/url\";\n+import type { GenericEndpointContext } from \"src/types\";\n \n /**\n  * A middleware to validate callbackURL and origin against\n  * trustedOrigins.\n  */\n export const originCheckMiddleware = createAuthMiddleware(async (ctx) => {\n-\tif (ctx.request?.method !== \"POST\") {\n-\t\treturn;\n-\t}\n \tconst { body, query, context } = ctx;\n \tconst originHeader =\n \t\tctx.headers?.get(\"origin\") || ctx.headers?.get(\"referer\") || \"\";"
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "fdd21afb1ba1e50d31f4721f214828c96161cd1d",
            "date": "2025-01-14T18:22:21Z",
            "author_login": "Bekacru"
          },
          {
            "sha": "144eb309b395193f9b67a182649ea27d1908e9ba",
            "date": "2025-01-14T18:18:22Z",
            "author_login": "Bekacru"
          },
          {
            "sha": "4a89fb87320f4512b641745d5ef9f891d0355175",
            "date": "2025-01-14T18:18:14Z",
            "author_login": "Bekacru"
          },
          {
            "sha": "f481a0f304398d0633c9dae6525162dae1408ea5",
            "date": "2025-01-14T17:55:46Z",
            "author_login": "Bekacru"
          },
          {
            "sha": "cd04dc14121ad376d6f32a624bf809c6f08496ea",
            "date": "2025-01-14T17:55:42Z",
            "author_login": "Bekacru"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-601",
    "description": "Better Auth is an authentication library for TypeScript. An open redirect vulnerability has been identified in the verify email endpoint of all versions of Better Auth prior to v1.1.6, potentially allowing attackers to redirect users to malicious websites. This issue affects users relying on email verification links generated by the library. The verify email callback endpoint accepts a `callbackURL` parameter. Unlike other verification methods, email verification only uses JWT to verify and redirect without proper validation of the target domain. The origin checker is bypassed in this scenario because it only checks for `POST` requests. An attacker can manipulate this parameter to redirect users to arbitrary URLs controlled by the attacker. Version 1.1.6 contains a patch for the issue.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2024-12-30T17:15:10.133",
    "last_modified": "2024-12-30T17:15:10.133",
    "fix_date": "2024-12-30T07:07:58Z"
  },
  "references": [
    {
      "url": "https://github.com/better-auth/better-auth/commit/deb3d73aea90d0468d92723f4511542b593e522f",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/better-auth/better-auth/security/advisories/GHSA-8jhw-6pjj-8723",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:52.934967",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "better-auth",
    "owner": "better-auth",
    "created_at": "2024-05-19T21:40:04Z",
    "updated_at": "2025-01-14T20:54:28Z",
    "pushed_at": "2025-01-14T18:22:25Z",
    "size": 34070,
    "stars": 6014,
    "forks": 340,
    "open_issues": 168,
    "watchers": 6014,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "TypeScript": 1006498,
      "JavaScript": 468
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "mit"
    },
    "collected_at": "2025-01-14T21:27:37.005982"
  }
}