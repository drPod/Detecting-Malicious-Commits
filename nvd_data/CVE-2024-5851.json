{
  "cve_id": "CVE-2024-5851",
  "github_data": {
    "repository": "playsms/playsms",
    "fix_commit": "7a88920f6b536c6a91512e739bcb4e8adefeed2b",
    "related_commits": [
      "7a88920f6b536c6a91512e739bcb4e8adefeed2b",
      "7a88920f6b536c6a91512e739bcb4e8adefeed2b"
    ],
    "patch_url": "https://github.com/playsms/playsms/commit/7a88920f6b536c6a91512e739bcb4e8adefeed2b.patch",
    "fix_commit_details": {
      "sha": "7a88920f6b536c6a91512e739bcb4e8adefeed2b",
      "commit_date": "2024-06-10T18:27:45Z",
      "author": {
        "login": "antonraharja",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "sms schedule update v1.1:",
        "length": 207,
        "has_description": true,
        "references_issue": false
      },
      "stats": {
        "total": 314,
        "additions": 161,
        "deletions": 153
      },
      "files": [
        {
          "filename": "web/plugin/feature/schedule/config.php",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -6,7 +6,7 @@\n $menu_config[$menutab][] = array(\n \t\"index.php?app=main&inc=feature_schedule&op=list\",\n \t_('Schedule messages'),\n-\t1 \n+\t1\n );\n \n // plugin config\n@@ -15,7 +15,7 @@\n \t_('Annually') => 1,\n \t_('Monthly') => 2,\n \t_('Weekly') => 3,\n-\t_('Daily') => 4 \n+\t_('Daily') => 4\n );\n \n $plugin_config['schedule']['rules_display'] = array_flip($plugin_config['schedule']['rules']);"
        },
        {
          "filename": "web/plugin/feature/schedule/docs/CHANGELOG",
          "status": "modified",
          "additions": 6,
          "deletions": 0,
          "patch": "@@ -1,2 +1,8 @@\n Version 1.0\n - changelog started\n+\n+Version 1.1\n+- format codes\n+- remove error suppression from dba_*()\n+- strip tags inputs with core_sanitize_string()\n+- strip tags data with core_display_text() before displaying on web and export"
        },
        {
          "filename": "web/plugin/feature/schedule/docs/README",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n Plugin\t: Schedule send SMS for playSMS sponsored by JFG @ Mobile Enterprises\n Author\t: Anton Raharja\n-Release\t: 150214\n+Release\t: 240611\n License\t: GPLv3"
        },
        {
          "filename": "web/plugin/feature/schedule/docs/VERSION",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-1.0\n\\ No newline at end of file\n+1.1\n\\ No newline at end of file"
        },
        {
          "filename": "web/plugin/feature/schedule/docs/info.xml",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -3,8 +3,8 @@\n \t<name>schedule</name>\n \t<alias>SMS Schedule</alias>\n \t<description>SMS Schedule</description>\n-\t<release>1.0</release>\n-\t<date>2015-02-14</date>\n+\t<release>1.1</release>\n+\t<date>2024-06-11</date>\n \t<author>Anton Raharja</author>\n \t<language_file>1</language_file>\n \t<sql_file>0</sql_file>"
        },
        {
          "filename": "web/plugin/feature/schedule/edit.php",
          "status": "modified",
          "additions": 8,
          "deletions": 9,
          "patch": "@@ -24,12 +24,12 @@\n \n switch (_OP_) {\n \tcase \"list\":\n-\t\t$id = $_REQUEST['id'];\n+\t\t$id = (int) $_REQUEST['id'];\n \t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule WHERE uid='\" . $user_config['uid'] . \"' AND id='$id' AND flag_deleted='0'\";\n \t\t$db_result = dba_query($db_query);\n \t\t$db_row = dba_fetch_array($db_result);\n-\t\t$name = $db_row['name'];\n-\t\t$message = $db_row['message'];\n+\t\t$name = core_display_text($db_row['name']);\n+\t\t$message = core_display_text($db_row['message']);\n \t\t$schedule_rule = $db_row['schedule_rule'];\n \t\tif ($id && $name && $message) {\n \t\t\t$content = _dialog() . \"\n@@ -60,18 +60,18 @@\n \t\t}\n \t\t_p($content);\n \t\tbreak;\n-\t\n+\n \tcase \"edit_yes\":\n-\t\t$id = $_POST['id'];\n-\t\t$name = $_POST['name'];\n-\t\t$message = $_POST['message'];\n+\t\t$id = (int) $_POST['id'];\n+\t\t$name = core_sanitize_string($_POST['name']);\n+\t\t$message = core_sanitize_string($_POST['message']);\n \t\t$schedule_rule = (int) $_POST['schedule_rule'];\n \t\tif ($id && $name && $message) {\n \t\t\t$db_query = \"\n \t\t\t\tUPDATE \" . _DB_PREF_ . \"_featureSchedule\n \t\t\t\tSET c_timestamp='\" . time() . \"',name='$name',message='$message', schedule_rule='$schedule_rule'\n \t\t\t\tWHERE uid='\" . $user_config['uid'] . \"' AND id='$id' AND flag_deleted='0'\";\n-\t\t\tif (@dba_affected_rows($db_query)) {\n+\t\t\tif (dba_affected_rows($db_query)) {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('SMS schedule been saved');\n \t\t\t} else {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('Fail to edit SMS schedule');\n@@ -81,5 +81,4 @@\n \t\t}\n \t\theader(\"Location: \" . _u('index.php?app=main&inc=feature_schedule&route=edit&op=list&id=' . $id));\n \t\texit();\n-\t\tbreak;\n }"
        },
        {
          "filename": "web/plugin/feature/schedule/export.php",
          "status": "modified",
          "additions": 9,
          "deletions": 9,
          "patch": "@@ -19,13 +19,13 @@\n defined('_SECURE_') or die('Forbidden');\n \n // Schedule ID\n-$schedule_id = $_REQUEST['schedule_id'];\n+$schedule_id = (int) $_REQUEST['schedule_id'];\n \n // validate, if not exists the block\n $conditions = array(\n \t'uid' => $user_config['uid'],\n \t'id' => $schedule_id,\n-\t'flag_deleted' => 0 \n+\t'flag_deleted' => 0\n );\n if (!dba_isexists(_DB_PREF_ . '_featureSchedule', $conditions)) {\n \tauth_block();\n@@ -34,26 +34,26 @@\n switch (_OP_) {\n \tcase \"list\":\n \t\t$extras = array(\n-\t\t\t'ORDER BY' => 'schedule, name, destination' \n+\t\t\t'ORDER BY' => 'schedule, name, destination'\n \t\t);\n \t\t$conditions = array(\n-\t\t\t'schedule_id' => $schedule_id \n+\t\t\t'schedule_id' => $schedule_id\n \t\t);\n-\t\t$list = dba_search(_DB_PREF_ . '_featureSchedule_dst', '*', $conditions, '', $extras);\n+\t\t$list = dba_search(_DB_PREF_ . '_featureSchedule_dst', '*', $conditions, [], $extras);\n \t\t$data[0] = array(\n \t\t\t_('Name'),\n \t\t\t_('Destination'),\n-\t\t\t_('Schedule') \n+\t\t\t_('Schedule')\n \t\t);\n \t\tfor ($i = 0; $i < count($list); $i++) {\n \t\t\t$j = $i + 1;\n \t\t\tif ($j > $plugin_config['schedule']['export_row_limit']) {\n \t\t\t\tbreak;\n \t\t\t}\n \t\t\t$data[$j] = array(\n-\t\t\t\t$list[$i]['name'],\n-\t\t\t\t$list[$i]['destination'],\n-\t\t\t\tcore_display_datetime($list[$i]['schedule']) \n+\t\t\t\tcore_display_text($list[$i]['name']),\n+\t\t\t\tcore_display_text($list[$i]['destination']),\n+\t\t\t\tcore_display_datetime($list[$i]['schedule'])\n \t\t\t);\n \t\t}\n \t\t$content = core_csv_format($data);"
        },
        {
          "filename": "web/plugin/feature/schedule/fn.php",
          "status": "modified",
          "additions": 36,
          "deletions": 36,
          "patch": "@@ -18,71 +18,71 @@\n  */\n defined('_SECURE_') or die('Forbidden');\n \n-function schedule_hook_playsmsd() {\n+function schedule_hook_playsmsd()\n+{\n \tglobal $core_config;\n-\t\n+\n \t// fetch every minutes\n \tif (!core_playsmsd_timer(60)) {\n \t\treturn;\n \t}\n-\t\n+\n \t// mark a start\n \t//_log('start scheduler', 2, 'schedule_hook_playsmsd');\n-\t\n+\n \n \t// get current server time\n \t$current_datetime = core_display_datetime(core_get_datetime());\n \t$current_timestamp = strtotime($current_datetime);\n-\t\n+\n \t// collect active schedules\n \t$conditions = array(\n \t\t'flag_active' => 1,\n-\t\t'flag_deleted' => 0 \n+\t\t'flag_deleted' => 0\n \t);\n \t$schedules = dba_search(_DB_PREF_ . '_featureSchedule', '*', $conditions);\n-\tforeach ($schedules as $sch) {\n+\tforeach ( $schedules as $sch ) {\n \t\t$schedule_id = $sch['id'];\n \t\t$uid = $sch['uid'];\n-\t\t$schedule_name = $sch['name'];\n \t\t$schedule_rule = (int) $sch['schedule_rule'];\n-\t\t\n+\n \t\t// collect destinations\n \t\t$conditions = array(\n-\t\t\t'schedule_id' => $schedule_id \n+\t\t\t'schedule_id' => $schedule_id\n \t\t);\n-\t\t$destinations = dba_search(_DB_PREF_ . '_featureSchedule_dst', '*', $conditions, '', $extras);\n-\t\tforeach ($destinations as $dst) {\n+\t\t$destinations = dba_search(_DB_PREF_ . '_featureSchedule_dst', '*', $conditions, [], []);\n+\t\tforeach ( $destinations as $dst ) {\n \t\t\t$id = $dst['id'];\n-\t\t\t$name = $dst['name'];\n-\t\t\t$schedule_message = str_ireplace('#NAME#', $name, $sch['message']);\n+\t\t\t$name = core_display_text($dst['name']);\n+\t\t\t$schedule_message = core_display_text(str_ireplace('#NAME#', $name, $sch['message']));\n \t\t\t$destination = $dst['destination'];\n \t\t\t$schedule = ($dst['schedule'] ? core_display_datetime($dst['schedule']) : '0000-00-00 00:00:00');\n \t\t\t$scheduled = ($dst['scheduled'] ? core_display_datetime($dst['scheduled']) : '0000-00-00 00:00:00');\n \t\t\tif (!$scheduled || $scheduled == '0000-00-00 00:00:00') {\n \t\t\t\t$scheduled = $schedule;\n \t\t\t}\n \t\t\t$scheduled_timestamp = strtotime($scheduled);\n-\t\t\t\n+\n \t\t\t//_log('uid:' . $uid . ' schedule_id:' . $schedule_id . ' id:' . $id . ' rule:' . $schedule_rule . ' current:[' . $current_datetime . '] schedule:[' . $schedule . '] scheduled:[' . $scheduled . ']', 2, 'schedule_hook_playsmsd');\t\t\t\n-\t\t\t\n+\n \n \t\t\t$continue = FALSE;\n-\t\t\t\n+\n \t\t\tif ($current_timestamp >= $scheduled_timestamp) {\n \t\t\t\tswitch ($schedule_rule) {\n \t\t\t\t\t// once\n-\t\t\t\t\tcase '0':\n+\t\t\t\t\tcase 0:\n \t\t\t\t\t\t//$scheduled = '2038-01-19 10:14:07';\n \t\t\t\t\t\t$scheduled = '2030-01-19 10:14:07';\n \t\t\t\t\t\t$scheduled = core_adjust_datetime($scheduled);\n \t\t\t\t\t\t$scheduled_timestamp = strtotime($current_datetime);\n \t\t\t\t\t\t$scheduled_display = $current_datetime;\n-\t\t\t\t\t\t\n+\n \t\t\t\t\t\t$continue = TRUE;\n \t\t\t\t\t\tbreak;\n-\t\t\t\t\t\n+\n \t\t\t\t\t// Annually\n-\t\t\t\t\tcase '1':\n+\t\t\t\t\tcase 1:\n \t\t\t\t\t\t$current_schedule = date('Y', $current_timestamp) . '-' . date('m-d H:i:s', strtotime($schedule));\n \t\t\t\t\t\t$next = '';\n \t\t\t\t\t\tif ($current_timestamp > strtotime($current_schedule)) {\n@@ -92,12 +92,12 @@ function schedule_hook_playsmsd() {\n \t\t\t\t\t\t$scheduled = core_adjust_datetime($scheduled);\n \t\t\t\t\t\t$scheduled_timestamp = strtotime($scheduled);\n \t\t\t\t\t\t$scheduled_display = core_display_datetime($scheduled);\n-\t\t\t\t\t\t\n+\n \t\t\t\t\t\t$continue = TRUE;\n \t\t\t\t\t\tbreak;\n-\t\t\t\t\t\n+\n \t\t\t\t\t// Monthly\n-\t\t\t\t\tcase '2':\n+\t\t\t\t\tcase 2:\n \t\t\t\t\t\t$current_schedule = date('Y-m', $current_timestamp) . '-' . date('d H:i:s', strtotime($schedule));\n \t\t\t\t\t\t$next = '';\n \t\t\t\t\t\tif ($current_timestamp > strtotime($current_schedule)) {\n@@ -107,12 +107,12 @@ function schedule_hook_playsmsd() {\n \t\t\t\t\t\t$scheduled = core_adjust_datetime($scheduled);\n \t\t\t\t\t\t$scheduled_timestamp = strtotime($scheduled);\n \t\t\t\t\t\t$scheduled_display = core_display_datetime($scheduled);\n-\t\t\t\t\t\t\n+\n \t\t\t\t\t\t$continue = TRUE;\n \t\t\t\t\t\tbreak;\n-\t\t\t\t\t\n+\n \t\t\t\t\t// Weekly\n-\t\t\t\t\tcase '3':\n+\t\t\t\t\tcase 3:\n \t\t\t\t\t\t$current_schedule = date('Y-m-d', $current_timestamp) . ' ' . date('H:i:s', strtotime($schedule));\n \t\t\t\t\t\t$current_day = date('l', strtotime($current_schedule));\n \t\t\t\t\t\t$next = '';\n@@ -123,12 +123,12 @@ function schedule_hook_playsmsd() {\n \t\t\t\t\t\t$scheduled = core_adjust_datetime($scheduled);\n \t\t\t\t\t\t$scheduled_timestamp = strtotime($scheduled);\n \t\t\t\t\t\t$scheduled_display = core_display_datetime($scheduled);\n-\t\t\t\t\t\t\n+\n \t\t\t\t\t\t$continue = TRUE;\n \t\t\t\t\t\tbreak;\n-\t\t\t\t\t\n+\n \t\t\t\t\t// Daily\n-\t\t\t\t\tcase '4':\n+\t\t\t\t\tcase 4:\n \t\t\t\t\t\t$current_schedule = date('Y-m-d', $current_timestamp) . ' ' . date('H:i:s', strtotime($schedule));\n \t\t\t\t\t\t$next = '';\n \t\t\t\t\t\tif ($current_timestamp > strtotime($current_schedule)) {\n@@ -138,29 +138,29 @@ function schedule_hook_playsmsd() {\n \t\t\t\t\t\t$scheduled = core_adjust_datetime($scheduled);\n \t\t\t\t\t\t$scheduled_timestamp = strtotime($scheduled);\n \t\t\t\t\t\t$scheduled_display = core_display_datetime($scheduled);\n-\t\t\t\t\t\t\n+\n \t\t\t\t\t\t$continue = TRUE;\n \t\t\t\t\t\tbreak;\n \t\t\t\t}\n \t\t\t}\n-\t\t\t\n+\n \t\t\tif ($continue) {\n \t\t\t\t// set scheduled to next time\n \t\t\t\t$items = array(\n \t\t\t\t\t'c_timestamp' => time(),\n-\t\t\t\t\t'scheduled' => $scheduled \n+\t\t\t\t\t'scheduled' => $scheduled\n \t\t\t\t);\n \t\t\t\t$conditions = array(\n \t\t\t\t\t'schedule_id' => $schedule_id,\n-\t\t\t\t\t'id' => $id \n+\t\t\t\t\t'id' => $id\n \t\t\t\t);\n \t\t\t\tif (dba_update(_DB_PREF_ . '_featureSchedule_dst', $items, $conditions, 'AND')) {\n \t\t\t\t\t// if the interval is under an hour then go ahead, otherwise expired\n \t\t\t\t\t$interval = $current_timestamp - $scheduled_timestamp;\n \t\t\t\t\tif ($interval <= 3600) {\n \t\t\t\t\t\t_log('sendsms uid:' . $uid . ' schedule_id:' . $schedule_id . ' id:' . $id . ' rule:' . $schedule_rule . ' schedule:[' . $schedule . '] scheduled:[' . $scheduled_display . ']', 2, 'schedule_hook_playsmsd');\n \t\t\t\t\t\t$username = user_uid2username($uid);\n-\t\t\t\t\t\tsendsms_helper($username, $destination, $schedule_message, 'text', $unicode);\n+\t\t\t\t\t\tsendsms_helper($username, $destination, $schedule_message, 'text');\n \t\t\t\t\t} else {\n \t\t\t\t\t\t_log('expired uid:' . $uid . ' schedule_id:' . $schedule_id . ' id:' . $id . ' rule:' . $schedule_rule . ' schedule:[' . $schedule . '] scheduled:[' . $scheduled_display . '] interval:' . $interval, 2, 'schedule_hook_playsmsd');\n \t\t\t\t\t}\n@@ -170,7 +170,7 @@ function schedule_hook_playsmsd() {\n \t\t\t}\n \t\t}\n \t}\n-\t\n+\n \t// mark an end\n \t//_log('end scheduler', 2, 'schedule_hook_playsmsd');\n }"
        },
        {
          "filename": "web/plugin/feature/schedule/import.php",
          "status": "modified",
          "additions": 20,
          "deletions": 19,
          "patch": "@@ -23,13 +23,13 @@\n }\n \n // Schedule ID\n-$schedule_id = $_REQUEST['schedule_id'];\n+$schedule_id = (int) $_REQUEST['schedule_id'];\n \n // validate, if not exists the block\n $conditions = array(\n \t'uid' => $user_config['uid'],\n \t'id' => $schedule_id,\n-\t'flag_deleted' => 0 \n+\t'flag_deleted' => 0\n );\n if (!dba_isexists(_DB_PREF_ . '_featureSchedule', $conditions)) {\n \tauth_block();\n@@ -86,7 +86,7 @@\n \t\t\t</tr></thead><tbody>\";\n \n \t\tif ($continue && file_exists($fnpb_tmpname)) {\n-\t\t\t\n+\n \t\t\tini_set('auto_detect_line_endings', TRUE);\n \t\t\tif (($fp = fopen($fnpb_tmpname, \"r\")) !== FALSE) {\n \t\t\t\t$i = 0;\n@@ -103,13 +103,13 @@\n \t\t\t\t$session_import = 'schedule_' . _PID_;\n \t\t\t\t$_SESSION['tmp'][$session_import] = array();\n \t\t\t\t$i = 0;\n-\t\t\t\tforeach ($entries as $entry) {\n-\t\t\t\t\t\n+\t\t\t\tforeach ( $entries as $entry ) {\n+\n \t\t\t\t\t// fixme anton - https://www.exploit-database.net/?id=92915\n \t\t\t\t\t$entry[0] = core_sanitize_string($entry[0]);\n \t\t\t\t\t$entry[1] = core_sanitize_string($entry[1]);\n \t\t\t\t\t$entry[2] = core_sanitize_string($entry[2]);\n-\t\t\t\t\t\n+\n \t\t\t\t\tif ($entry[0] && $entry[1] && $entry[2]) {\n \t\t\t\t\t\t$i++;\n \t\t\t\t\t\t$content .= \"\n@@ -125,7 +125,7 @@\n \t\t\t\t}\n \t\t\t}\n \t\t\tini_set('auto_detect_line_endings', FALSE);\n-\t\t\t\n+\n \t\t\t$content .= \"\n \t\t\t\t</tbody></table>\n \t\t\t\t</div>\n@@ -148,29 +148,31 @@\n \tcase \"import_yes\":\n \t\t@set_time_limit(0);\n \t\t$num = $_POST['number_of_row'];\n-\t\t$session_import = $_POST['session_import'];\n+\t\t$session_import = core_sanitize_string($_POST['session_import']);\n \t\t$data = $_SESSION['tmp'][$session_import];\n-\t\tforeach ($data as $d) {\n-\t\t\t$name = trim($d[0]);\n-\t\t\t$destination = trim($d[1]);\n+\t\tforeach ( $data as $d ) {\n+\t\t\t$name = core_sanitize_string(trim($d[0]));\n+\t\t\t$destination = core_sanitize_string(trim($d[1]));\n \t\t\t$schedule = trim($d[2]);\n \t\t\tif ($name && $destination && $schedule) {\n \t\t\t\t$schedule = core_adjust_datetime($schedule);\n \t\t\t\t// add destiantions, replace existing entry with the same name\n-\t\t\t\tif (dba_isexists(_DB_PREF_ . '_featureSchedule_dst', array(\n-\t\t\t\t\t'schedule_id' => $schedule_id,\n-\t\t\t\t\t'name' => $name \n-\t\t\t\t), 'AND')) {\n+\t\t\t\tif (\n+\t\t\t\t\tdba_isexists(_DB_PREF_ . '_featureSchedule_dst', array(\n+\t\t\t\t\t\t'schedule_id' => $schedule_id,\n+\t\t\t\t\t\t'name' => $name\n+\t\t\t\t\t), 'AND')\n+\t\t\t\t) {\n \t\t\t\t\t// update\n \t\t\t\t\t$items = array(\n \t\t\t\t\t\t'c_timestamp' => time(),\n \t\t\t\t\t\t'schedule' => $schedule,\n-\t\t\t\t\t\t'scheduled' => '0000-00-00 00:00:00' \n+\t\t\t\t\t\t'scheduled' => '0000-00-00 00:00:00'\n \t\t\t\t\t);\n \t\t\t\t\t$conditions = array(\n \t\t\t\t\t\t'schedule_id' => $schedule_id,\n \t\t\t\t\t\t'name' => $name,\n-\t\t\t\t\t\t'destination' => $destination \n+\t\t\t\t\t\t'destination' => $destination\n \t\t\t\t\t);\n \t\t\t\t\tdba_update(_DB_PREF_ . '_featureSchedule_dst', $items, $conditions);\n \t\t\t\t} else {\n@@ -180,7 +182,7 @@\n \t\t\t\t\t\t'schedule' => $schedule,\n \t\t\t\t\t\t'scheduled' => '0000-00-00 00:00:00',\n \t\t\t\t\t\t'name' => $name,\n-\t\t\t\t\t\t'destination' => $destination \n+\t\t\t\t\t\t'destination' => $destination\n \t\t\t\t\t);\n \t\t\t\t\tdba_add(_DB_PREF_ . '_featureSchedule_dst', $items);\n \t\t\t\t}\n@@ -189,5 +191,4 @@\n \t\t$_SESSION['dialog']['info'][] = _('Entries in CSV file have been imported');\n \t\theader(\"Location: \" . _u('index.php?app=main&inc=feature_schedule&route=import&op=list&schedule_id=' . $schedule_id));\n \t\texit();\n-\t\tbreak;\n }"
        },
        {
          "filename": "web/plugin/feature/schedule/manage.php",
          "status": "modified",
          "additions": 52,
          "deletions": 51,
          "patch": "@@ -24,12 +24,12 @@\n \n switch (_OP_) {\n \tcase \"list\":\n-\t\t$id = $_REQUEST['id'];\n+\t\t$id = (int) $_REQUEST['id'];\n \t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule WHERE uid='\" . $user_config['uid'] . \"' AND id='$id' AND flag_deleted='0'\";\n \t\t$db_result = dba_query($db_query);\n \t\t$db_row = dba_fetch_array($db_result);\n-\t\t$name = $db_row['name'];\n-\t\t$message = $db_row['message'];\n+\t\t$name = core_display_text($db_row['name']);\n+\t\t$message = core_display_text($db_row['message']);\n \t\t$schedule_rule = $db_row['schedule_rule'];\n \t\tif ($id && $name && $message) {\n \t\t\t$content = _dialog() . \"\n@@ -51,32 +51,32 @@\n \t\t\t\t\t<td>\" . _('Schedule rule') . \"</td><td>\" . $plugin_config['schedule']['rules_display'][$schedule_rule] . \"</td>\n \t\t\t\t</tr>\n \t\t\t\t</table>\";\n-\t\t\t\n+\n \t\t\t// list of destinations\n-\t\t\t\n+\n \n \t\t\t$search_category = array(\n \t\t\t\t_('Schedule') => 'schedule',\n \t\t\t\t_('Name') => 'name',\n-\t\t\t\t_('Destination') => 'destination' \n+\t\t\t\t_('Destination') => 'destination'\n \t\t\t);\n \t\t\t$base_url = 'index.php?app=main&inc=feature_schedule&route=manage&op=list&id=' . $id;\n \t\t\t$search = themes_search($search_category, $base_url);\n-\t\t\t\n+\n \t\t\t$fields = '*';\n \t\t\t$conditions = array(\n-\t\t\t\t'schedule_id' => $id \n+\t\t\t\t'schedule_id' => $id\n \t\t\t);\n \t\t\t$keywords = $search['dba_keywords'];\n \t\t\t$count = dba_count(_DB_PREF_ . '_featureSchedule_dst', $conditions, $keywords);\n \t\t\t$nav = themes_nav($count, $search['url']);\n \t\t\t$extras = array(\n \t\t\t\t'ORDER BY' => 'schedule, name, destination',\n \t\t\t\t'LIMIT' => $nav['limit'],\n-\t\t\t\t'OFFSET' => $nav['offset'] \n+\t\t\t\t'OFFSET' => $nav['offset']\n \t\t\t);\n \t\t\t$list = dba_search(_DB_PREF_ . '_featureSchedule_dst', $fields, $conditions, $keywords, $extras);\n-\t\t\t\n+\n \t\t\t$content .= \"\n \t\t\t\t<h3>\" . _('List of destinations') . \"</h3>\n \t\t\t\t<form name=fm_schedule_dst_list id=fm_schedule_dst_list action='\" . $base_url . \"' method=post>\n@@ -94,14 +94,14 @@\n \t\t\t\t\t<th width=10%>\" . _('Action') . \"</th>\n \t\t\t\t</tr></thead>\n \t\t\t\t<tbody>\";\n-\t\t\tforeach ($list as $db_row) {\n+\t\t\tforeach ( $list as $db_row ) {\n \t\t\t\t$action = \"<a href=\\\"\" . _u('index.php?app=main&inc=feature_schedule&route=manage&op=dst_edit&schedule_id=' . $id . '&id=' . $db_row['id']) . \"\\\">\" . $icon_config['edit'] . \"</a>&nbsp;\";\n-\t\t\t\t$action .= \"<a href=\\\"javascript: ConfirmURL('\" . _('Are you sure you want to remove this number from SMS schedule ?') . \" (\" . $db_row['name'] . \" \" . $db_row['destination'] . \")','\" . _u('index.php?app=main&inc=feature_schedule&route=manage&op=dst_del&schedule_id=' . $id . '&id=' . $db_row['id']) . \"')\\\">\" . $icon_config['delete'] . \"</a>\";\n+\t\t\t\t$action .= \"<a href=\\\"javascript: ConfirmURL('\" . _('Are you sure you want to remove this number from SMS schedule ?') . \" (\" . core_display_text($db_row['name']) . \" \" . core_display_text($db_row['destination']) . \")','\" . _u('index.php?app=main&inc=feature_schedule&route=manage&op=dst_del&schedule_id=' . $id . '&id=' . $db_row['id']) . \"')\\\">\" . $icon_config['delete'] . \"</a>\";\n \t\t\t\t$i++;\n \t\t\t\t$content .= \"\n \t\t\t\t\t<tr>\n-\t\t\t\t\t\t<td>\" . $db_row['name'] . \"</td>\n-\t\t\t\t\t\t<td>\" . $db_row['destination'] . \"</td>\n+\t\t\t\t\t\t<td>\" . core_display_text($db_row['name']) . \"</td>\n+\t\t\t\t\t\t<td>\" . core_display_text($db_row['destination']) . \"</td>\n \t\t\t\t\t\t<td>\" . core_display_datetime($db_row['schedule']) . \"</td>\n \t\t\t\t\t\t<td>\" . $action . \"</td>\n \t\t\t\t\t</tr>\";\n@@ -112,21 +112,21 @@\n \t\t\t\t</div>\n \t\t\t\t<div class=pull-right>\" . $nav['form'] . \"</div>\n \t\t\t\t</form>\";\n-\t\t\t\n+\n \t\t\t$content .= \"<p>\" . _back('index.php?app=main&inc=feature_schedule&op=list');\n \t\t} else {\n \t\t\tauth_block();\n \t\t}\n \t\t_p($content);\n \t\tbreak;\n-\t\n+\n \tcase \"dst_add\":\n-\t\t$schedule_id = $_REQUEST['schedule_id'];\n+\t\t$schedule_id = (int) $_REQUEST['schedule_id'];\n \t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule WHERE uid='\" . $user_config['uid'] . \"' AND id='$schedule_id' AND flag_deleted='0'\";\n \t\t$db_result = dba_query($db_query);\n \t\t$db_row = dba_fetch_array($db_result);\n-\t\t$schedule_name = $db_row['name'];\n-\t\t$schedule_message = $db_row['message'];\n+\t\t$schedule_name = core_display_text($db_row['name']);\n+\t\t$schedule_message = core_display_text($db_row['message']);\n \t\tif ($schedule_id && $schedule_name && $schedule_message) {\n \t\t\t$content = _dialog() . \"\n \t\t\t\t<h2>\" . _('Schedule messages') . \"</h2>\n@@ -160,24 +160,24 @@\n \t\t}\n \t\t_p($content);\n \t\tbreak;\n-\t\n+\n \tcase \"dst_add_yes\":\n-\t\t$schedule_id = $_REQUEST['schedule_id'];\n+\t\t$schedule_id = (int) $_REQUEST['schedule_id'];\n \t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule WHERE uid='\" . $user_config['uid'] . \"' AND id='$schedule_id' AND flag_deleted='0'\";\n \t\t$db_result = dba_query($db_query);\n \t\t$db_row = dba_fetch_array($db_result);\n-\t\t$schedule_name = $db_row['name'];\n-\t\t$schedule_message = $db_row['message'];\n+\t\t$schedule_name = core_display_text($db_row['name']);\n+\t\t$schedule_message = core_display_text($db_row['message']);\n \t\tif ($schedule_id && $schedule_name && $schedule_message) {\n-\t\t\t$name = $_POST['name'];\n-\t\t\t$destination = $_POST['destination'];\n+\t\t\t$name = core_sanitize_string($_POST['name']);\n+\t\t\t$destination = core_sanitize_string($_POST['destination']);\n \t\t\t$schedule = trim($_POST['schedule']);\n \t\t\tif ($name && $destination && $schedule) {\n \t\t\t\t$schedule = ($schedule ? core_adjust_datetime($schedule) : '0000-00-00 00:00:00');\n \t\t\t\t$db_query = \"\n \t\t\t\tINSERT INTO \" . _DB_PREF_ . \"_featureSchedule_dst (schedule_id,schedule,name,destination)\n \t\t\t\tVALUES ('$schedule_id','$schedule','$name','$destination')\";\n-\t\t\t\tif ($new_uid = @dba_insert_id($db_query)) {\n+\t\t\t\tif ($new_uid = dba_insert_id($db_query)) {\n \t\t\t\t\t$_SESSION['dialog']['info'][] = _('New destination has been added');\n \t\t\t\t} else {\n \t\t\t\t\t$_SESSION['dialog']['info'][] = _('Fail to add new destination');\n@@ -191,16 +191,18 @@\n \t\t\tauth_block();\n \t\t}\n \t\tbreak;\n-\t\n+\n \tcase \"dst_del\":\n-\t\t$id = $_REQUEST['id']; // destination ID\n-\t\t$schedule_id = $_REQUEST['schedule_id']; // schedule ID\n-\t\tif ($id && $schedule_id && dba_isexists(_DB_PREF_ . \"_featureSchedule\", array(\n-\t\t\t'uid' => $user_config['uid'],\n-\t\t\t'id' => $schedule_id \n-\t\t), 'AND')) {\n+\t\t$id = (int) $_REQUEST['id']; // destination ID\n+\t\t$schedule_id = (int) $_REQUEST['schedule_id']; // schedule ID\n+\t\tif (\n+\t\t\t$id && $schedule_id && dba_isexists(_DB_PREF_ . \"_featureSchedule\", array(\n+\t\t\t\t'uid' => $user_config['uid'],\n+\t\t\t\t'id' => $schedule_id\n+\t\t\t), 'AND')\n+\t\t) {\n \t\t\t$db_query = \"DELETE FROM \" . _DB_PREF_ . \"_featureSchedule_dst WHERE schedule_id='$schedule_id' AND id='$id'\";\n-\t\t\tif (@dba_affected_rows($db_query)) {\n+\t\t\tif (dba_affected_rows($db_query)) {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('Destination has been deleted');\n \t\t\t} else {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('Fail to delete destination');\n@@ -210,25 +212,24 @@\n \t\t}\n \t\theader(\"Location: \" . _u('index.php?app=main&inc=feature_schedule&route=manage&op=list&id=' . $schedule_id));\n \t\texit();\n-\t\tbreak;\n-\t\n+\n \tcase \"dst_edit\":\n-\t\t$id = $_REQUEST['id']; // destination ID\n-\t\t$schedule_id = $_REQUEST['schedule_id']; // schedule ID\n+\t\t$id = (int) $_REQUEST['id']; // destination ID\n+\t\t$schedule_id = (int) $_REQUEST['schedule_id']; // schedule ID\n \t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule WHERE uid='\" . $user_config['uid'] . \"' AND id='$schedule_id' AND flag_deleted='0'\";\n \t\t$db_result = dba_query($db_query);\n \t\t$db_row = dba_fetch_array($db_result);\n-\t\t$schedule_name = $db_row['name'];\n-\t\t$schedule_message = $db_row['message'];\n+\t\t$schedule_name = core_display_text($db_row['name']);\n+\t\t$schedule_message = core_display_text($db_row['message']);\n \t\tif ($id && $schedule_id && $schedule_name && $schedule_message) {\n \t\t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule_dst WHERE schedule_id='$schedule_id' AND id='$id'\";\n \t\t\t$db_result = dba_query($db_query);\n \t\t\t$db_row = dba_fetch_array($db_result);\n \t\t\t$schedule = $db_row['schedule'];\n \t\t\t$schedule = ($schedule ? core_display_datetime($schedule) : '0000-00-00 00:00:00');\n-\t\t\t$name = $db_row['name'];\n-\t\t\t$destination = $db_row['destination'];\n-\t\t\t\n+\t\t\t$name = core_display_text($db_row['name']);\n+\t\t\t$destination = core_display_text($db_row['destination']);\n+\n \t\t\t$content = _dialog() . \"\n \t\t\t\t<h2>\" . _('Schedule messages') . \"</h2>\n \t\t\t\t<h3>\" . _('Manage schedule') . \"</h3>\n@@ -262,26 +263,26 @@\n \t\t}\n \t\t_p($content);\n \t\tbreak;\n-\t\n+\n \tcase \"dst_edit_yes\":\n-\t\t$id = $_REQUEST['id']; // destination ID\n-\t\t$schedule_id = $_REQUEST['schedule_id']; // schedule ID\n+\t\t$id = (int) $_REQUEST['id']; // destination ID\n+\t\t$schedule_id = (int) $_REQUEST['schedule_id']; // schedule ID\n \t\t$db_query = \"SELECT * FROM \" . _DB_PREF_ . \"_featureSchedule WHERE uid='\" . $user_config['uid'] . \"' AND id='$schedule_id' AND flag_deleted='0'\";\n \t\t$db_result = dba_query($db_query);\n \t\t$db_row = dba_fetch_array($db_result);\n-\t\t$schedule_name = $db_row['name'];\n-\t\t$schedule_message = $db_row['message'];\n+\t\t$schedule_name = core_display_text($db_row['name']);\n+\t\t$schedule_message = core_display_text($db_row['message']);\n \t\tif ($id && $schedule_id && $schedule_name && $schedule_message) {\n-\t\t\t$name = $_POST['name'];\n-\t\t\t$destination = $_POST['destination'];\n+\t\t\t$name = core_sanitize_string($_POST['name']);\n+\t\t\t$destination = core_sanitize_string($_POST['destination']);\n \t\t\t$schedule = trim($_POST['schedule']);\n \t\t\tif ($name && $destination && $schedule) {\n \t\t\t\t$schedule = ($schedule ? core_adjust_datetime($schedule) : '0000-00-00 00:00:00');\n \t\t\t\t$db_query = \"\n \t\t\t\t\tUPDATE \" . _DB_PREF_ . \"_featureSchedule_dst\n \t\t\t\t\tSET c_timestamp='\" . time() . \"',name='$name',destination='$destination',schedule='$schedule',scheduled='0000-00-00 00:00:00'\n \t\t\t\t\tWHERE schedule_id='$schedule_id' AND id='$id'\";\n-\t\t\t\tif (@dba_affected_rows($db_query)) {\n+\t\t\t\tif (dba_affected_rows($db_query)) {\n \t\t\t\t\t$_SESSION['dialog']['info'][] = _('Destination has been edited');\n \t\t\t\t} else {\n \t\t\t\t\t$_SESSION['dialog']['info'][] = _('Fail to edit destination');"
        },
        {
          "filename": "web/plugin/feature/schedule/schedule.php",
          "status": "modified",
          "additions": 24,
          "deletions": 23,
          "patch": "@@ -51,8 +51,8 @@\n \t\t\t$content .= \"\n \t\t\t\t\t<tr>\n \t\t\t\t\t\t<td>\" . $db_row['id'] . \"</td>\n-\t\t\t\t\t\t<td>\" . $db_row['name'] . \"</td>\n-\t\t\t\t\t\t<td>\" . $db_row['message'] . \"</td>\n+\t\t\t\t\t\t<td>\" . core_display_text($db_row['name']) . \"</td>\n+\t\t\t\t\t\t<td>\" . core_display_text($db_row['message']) . \"</td>\n \t\t\t\t\t\t<td>\" . $status . \"</td>\n \t\t\t\t\t\t<td>\" . $action . \"</td>\n \t\t\t\t\t</tr>\";\n@@ -64,7 +64,7 @@\n \t\t\t\" . _button('index.php?app=main&inc=feature_schedule&op=add', _('Add SMS schedule'));\n \t\t_p($content);\n \t\tbreak;\n-\t\n+\n \tcase \"add\":\n \t\t$content = _dialog() . \"\n \t\t\t<h2>\" . _('Schedule messages') . \"</h2>\n@@ -87,18 +87,18 @@\n \t\t\t\" . _back('index.php?app=main&inc=feature_schedule&op=list');\n \t\t_p($content);\n \t\tbreak;\n-\t\n+\n \tcase \"add_yes\":\n-\t\t$name = $_POST['name'];\n-\t\t$message = $_POST['message'];\n+\t\t$name = core_sanitize_string($_POST['name']);\n+\t\t$message = core_sanitize_string($_POST['message']);\n \t\t$schedule_rule = (int) $_POST['schedule_rule'];\n \t\tif ($name && $message) {\n \t\t\t// flag_active  : 1 active, 2 inactive, 0 considered inactive\n \t\t\t// flag_deleted : 1 deleted, other values considered non-deleted\n \t\t\t$db_query = \"\n \t\t\t\tINSERT INTO \" . _DB_PREF_ . \"_featureSchedule (c_timestamp,uid,name,message,schedule_rule,flag_active,flag_deleted)\n \t\t\t\tVALUES (\" . time() . \",'\" . $user_config['uid'] . \"','$name','$message','$schedule_rule','2','0')\";\n-\t\t\tif ($new_uid = @dba_insert_id($db_query)) {\n+\t\t\tif ($new_uid = dba_insert_id($db_query)) {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('New SMS schedule been added');\n \t\t\t} else {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('Fail to add new SMS schedule');\n@@ -108,18 +108,19 @@\n \t\t}\n \t\theader(\"Location: \" . _u('index.php?app=main&inc=feature_schedule&op=add'));\n \t\texit();\n-\t\tbreak;\n-\t\n+\n \tcase \"status\":\n \t\t$id = $_REQUEST['id'];\n-\t\tif ($id && dba_isexists(_DB_PREF_ . \"_featureSchedule\", array(\n-\t\t\t'uid' => $user_config['uid'],\n-\t\t\t'id' => $id,\n-\t\t\t'flag_deleted' => '0' \n-\t\t), 'AND')) {\n+\t\tif (\n+\t\t\t$id && dba_isexists(_DB_PREF_ . \"_featureSchedule\", array(\n+\t\t\t\t'uid' => $user_config['uid'],\n+\t\t\t\t'id' => $id,\n+\t\t\t\t'flag_deleted' => '0'\n+\t\t\t), 'AND')\n+\t\t) {\n \t\t\t$status = ($_REQUEST['status'] == 1 ? 1 : 2);\n \t\t\t$db_query = \"UPDATE \" . _DB_PREF_ . \"_featureSchedule SET c_timestamp='\" . time() . \"', flag_active='$status' WHERE uid='\" . $user_config['uid'] . \"' AND id='$id'\";\n-\t\t\tif (@dba_affected_rows($db_query)) {\n+\t\t\tif (dba_affected_rows($db_query)) {\n \t\t\t\tif ($status == 1) {\n \t\t\t\t\t$_SESSION['dialog']['info'][] = _('SMS schedule has been enabled');\n \t\t\t\t} else {\n@@ -129,16 +130,17 @@\n \t\t}\n \t\theader(\"Location: \" . _u('index.php?app=main&inc=feature_schedule&op=list'));\n \t\texit();\n-\t\tbreak;\n-\t\n+\n \tcase \"del\":\n \t\t$id = $_REQUEST['id'];\n-\t\tif ($id && dba_isexists(_DB_PREF_ . \"_featureSchedule\", array(\n-\t\t\t'uid' => $user_config['uid'],\n-\t\t\t'id' => $id \n-\t\t), 'AND')) {\n+\t\tif (\n+\t\t\t$id && dba_isexists(_DB_PREF_ . \"_featureSchedule\", array(\n+\t\t\t\t'uid' => $user_config['uid'],\n+\t\t\t\t'id' => $id\n+\t\t\t), 'AND')\n+\t\t) {\n \t\t\t$db_query = \"UPDATE \" . _DB_PREF_ . \"_featureSchedule SET c_timestamp='\" . time() . \"', flag_active='2', flag_deleted='1' WHERE uid='\" . $user_config['uid'] . \"' AND id='$id'\";\n-\t\t\tif (@dba_affected_rows($db_query)) {\n+\t\t\tif (dba_affected_rows($db_query)) {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('SMS schedule has been deleted');\n \t\t\t} else {\n \t\t\t\t$_SESSION['dialog']['info'][] = _('Fail to delete SMS schedule');\n@@ -148,5 +150,4 @@\n \t\t}\n \t\theader(\"Location: \" . _u('index.php?app=main&inc=feature_schedule&op=list'));\n \t\texit();\n-\t\tbreak;\n }"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 2,
        "max_directory_depth": 5
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "aa28ccb534f084ab1a6a7cf8e43397b4fe3924af",
            "date": "2024-11-19T08:34:01Z",
            "author_login": "antonraharja"
          },
          {
            "sha": "1f8a24c805a19766c448d0e539e31eca7f89e5b9",
            "date": "2024-11-18T15:31:09Z",
            "author_login": "antonraharja"
          },
          {
            "sha": "2ae54d0b526af157935e86409f1867e10e2a057f",
            "date": "2024-11-06T15:12:43Z",
            "author_login": "antonraharja"
          },
          {
            "sha": "1d227e989fd024bd6f4f2306e2cb0d704ecb6388",
            "date": "2024-11-06T13:23:06Z",
            "author_login": "antonraharja"
          },
          {
            "sha": "c6b83e97bc17d3e49d72ca1e4385f2ab997de168",
            "date": "2024-11-06T13:13:46Z",
            "author_login": "antonraharja"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-80",
    "description": "A vulnerability classified as problematic has been found in playSMS up to 1.4.7. Affected is an unknown function of the file /index.php?app=main&inc=feature_schedule&op=list of the component SMS Schedule Handler. The manipulation of the argument name/message leads to basic cross site scripting. It is possible to launch the attack remotely. Upgrading to version 1.4.8 is able to address this issue. The name of the patch is 7a88920f6b536c6a91512e739bcb4e8adefeed2b. It is recommended to upgrade the affected component. The identifier of this vulnerability is VDB-267912. NOTE: The code maintainer was contacted early about this disclosure and was eager to prepare a fix as quickly as possible.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-06-11T18:15:14.437",
    "last_modified": "2024-11-21T09:48:28.597",
    "fix_date": "2024-06-10T18:27:45Z"
  },
  "references": [
    {
      "url": "https://github.com/playsms/playsms/commit/7a88920f6b536c6a91512e739bcb4e8adefeed2b",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?ctiid.267912",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?id.267912",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?submit.347385",
      "source": "cna@vuldb.com",
      "tags": []
    },
    {
      "url": "https://github.com/playsms/playsms/commit/7a88920f6b536c6a91512e739bcb4e8adefeed2b",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?ctiid.267912",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?id.267912",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://vuldb.com/?submit.347385",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:26.364705",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "playsms",
    "owner": "playsms",
    "created_at": "2010-10-08T10:05:31Z",
    "updated_at": "2025-01-13T13:58:59Z",
    "pushed_at": "2024-11-19T08:34:10Z",
    "size": 31477,
    "stars": 772,
    "forks": 451,
    "open_issues": 64,
    "watchers": 772,
    "has_security_policy": false,
    "default_branch": "1.4.x",
    "protected_branches": [],
    "languages": {
      "PHP": 1237274,
      "HTML": 74659,
      "JavaScript": 72791,
      "CSS": 40025,
      "Shell": 23805
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-3.0"
    },
    "collected_at": "2025-01-14T20:47:51.084485"
  }
}