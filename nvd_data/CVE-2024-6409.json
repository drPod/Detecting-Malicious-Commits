{
  "cve_id": "CVE-2024-6409",
  "github_data": {
    "repository": "openela-main/openssh",
    "fix_commit": "c00da7741d42029e49047dd89e266d91dcfbffa0",
    "related_commits": [
      "c00da7741d42029e49047dd89e266d91dcfbffa0"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "c00da7741d42029e49047dd89e266d91dcfbffa0",
      "commit_date": "2024-07-10T17:24:02Z",
      "author": {
        "login": "openela-mship[bot]",
        "type": "Bot",
        "stats": null
      },
      "commit_message": {
        "title": "import openssh-8.7p1-38.el9_4.4",
        "length": 31,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 28,
        "additions": 25,
        "deletions": 3
      },
      "files": [
        {
          "filename": ".openssh.metadata",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1,4 +1,4 @@\n-9d440de6627940c09eadc342cc7d8bc9823654fd1a2be11c4f5820dd073054e0 SOURCES/pam_ssh_agent_auth-0.10.4.tar.gz\n b07d34756be72d4e294c05a91590355b68bbf3c3b466ea88d21aae168e97c7dc SOURCES/sshd-keygen.target\n 7ca34b8bb24ae9e50f33792b7091b3841d7e1b440ff57bc9fabddf01e2ed1e24 SOURCES/openssh-8.7p1.tar.gz\n bb18c454a3e5d3738cb26a1c89e17c467d7a59529ec92251b26461ae04771eba SOURCES/openssh-8.7p1.tar.gz.asc\n+9d440de6627940c09eadc342cc7d8bc9823654fd1a2be11c4f5820dd073054e0 SOURCES/pam_ssh_agent_auth-0.10.4.tar.gz"
        },
        {
          "filename": "SOURCES/openssh-9.8p1-upstream-cve-2024-6387.patch",
          "status": "modified",
          "additions": 12,
          "deletions": 0,
          "patch": "@@ -16,3 +16,15 @@ diff -up openssh-8.7p1/log.c.xxx openssh-8.7p1/log.c\n  \t_exit(1);\n  }\n  \n+diff -up openssh-8.7p1/sshd.c.xxx openssh-8.7p1/sshd.c\n+--- openssh-8.7p1/sshd.c.xxx\t2024-07-01 10:33:04.332907749 +0200\n++++ openssh-8.7p1/sshd.c\t2024-07-01 10:33:47.843998038 +0200\n+@@ -384,7 +384,7 @@ grace_alarm_handler(int sig)\n+ \n+ \t/* Log error and exit. */\n+ \tif (use_privsep && pmonitor != NULL && pmonitor->m_pid <= 0)\n+-\t\tcleanup_exit(255); /* don't log in privsep child */\n++\t\t_exit(255); /* don't log in privsep child */\n+ \telse {\n+ \t\tsigdie(\"Timeout before authentication for %s port %d\",\n+ \t\t    ssh_remote_ipaddr(the_active_state),"
        },
        {
          "filename": "SPECS/openssh.spec",
          "status": "modified",
          "additions": 12,
          "deletions": 2,
          "patch": "@@ -54,7 +54,7 @@\n Summary: An open source implementation of SSH protocol version 2\n Name: openssh\n Version: %{openssh_ver}\n-Release: %{openssh_rel}%{?dist}.1\n+Release: %{openssh_rel}%{?dist}.4\n URL: http://www.openssh.com/portable.html\n #URL1: https://github.com/jbeverly/pam_ssh_agent_auth/\n Source0: ftp://ftp.openbsd.org/pub/OpenBSD/OpenSSH/portable/openssh-%{version}.tar.gz\n@@ -363,7 +363,7 @@ Requires: openssh = %{version}-%{release}\n %package -n pam_ssh_agent_auth\n Summary: PAM module for authentication with ssh-agent\n Version: %{pam_ssh_agent_ver}\n-Release: %{pam_ssh_agent_rel}.%{openssh_rel}%{?dist}.1\n+Release: %{pam_ssh_agent_rel}.%{openssh_rel}%{?dist}.4\n License: BSD\n \n %description\n@@ -800,6 +800,16 @@ test -f %{sysconfig_anaconda} && \\\n %endif\n \n %changelog\n+* Wed Jul 03 2024 Dmitry Belyavskiy <dbelyavs@redhat.com> - 8.7p1-38.4\n+- rebuilt\n+\n+* Wed Jul 03 2024 Dmitry Belyavskiy <dbelyavs@redhat.com> - 8.7p1-38.3\n+- rebuilt\n+\n+* Mon Jul 01 2024 Dmitry Belyavskiy <dbelyavs@redhat.com> - 8.7p1-38.2\n+- Possible remote code execution due to a race condition (CVE-2024-6409)\n+  Resolves: RHEL-45740\n+\n * Fri Jun 28 2024 Dmitry Belyavskiy <dbelyavs@redhat.com> - 8.7p1-38.1\n - Possible remote code execution due to a race condition (CVE-2024-6387)\n   Resolves: RHEL-45347"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 3,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "3378a384831b70f9f157a8cb3687b522a5f4c17b",
            "date": "2024-11-12T06:40:33Z",
            "author_login": "openela-mship[bot]"
          },
          {
            "sha": "c00da7741d42029e49047dd89e266d91dcfbffa0",
            "date": "2024-07-10T17:24:02Z",
            "author_login": "openela-mship[bot]"
          },
          {
            "sha": "e1f438970e5a337a17070a637c1b9e19697cad09",
            "date": "2024-07-03T21:05:55Z",
            "author_login": "openela-mship[bot]"
          },
          {
            "sha": "6a423e4f4cd40165e537e782fc3eea80fa8c263b",
            "date": "2024-04-30T07:26:20Z",
            "author_login": "openela-mship[bot]"
          },
          {
            "sha": "7764fe140ae4a7da8ce14b403da9d3790a8b38dc",
            "date": "2024-03-14T23:29:10Z",
            "author_login": "openela-mship[bot]"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.0,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:H",
    "cwe_id": "CWE-364",
    "description": "A race condition vulnerability was discovered in how signals are handled by OpenSSH's server (sshd). If a remote attacker does not authenticate within a set time period, then sshd's SIGALRM handler is called asynchronously. However, this signal handler calls various functions that are not async-signal-safe, for example, syslog(). As a consequence of a successful attack, in the worst case scenario, an attacker may be able to perform a remote code execution (RCE) as an unprivileged user running the sshd server.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-07-08T18:15:09.487",
    "last_modified": "2024-11-21T09:49:35.850",
    "fix_date": "2024-07-10T17:24:02Z"
  },
  "references": [
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4457",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4613",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4716",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4910",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4955",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4960",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:5444",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2024-6409",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2295085",
      "source": "secalert@redhat.com",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/07/08/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/07/09/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/07/09/5",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/07/10/1",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/07/10/2",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4457",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4613",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2024:4716",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://access.redhat.com/security/cve/CVE-2024-6409",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://almalinux.org/blog/2024-07-09-cve-2024-6409/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2295085",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://bugzilla.suse.com/show_bug.cgi?id=1227217",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://explore.alas.aws.amazon.com/CVE-2024-6409.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://github.com/openela-main/openssh/commit/c00da7741d42029e49047dd89e266d91dcfbffa0",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security-tracker.debian.org/tracker/CVE-2024-6409",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20240712-0003/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://sig-security.rocky.page/issues/CVE-2024-6409/",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://ubuntu.com/security/CVE-2024-6409",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    },
    {
      "url": "https://www.suse.com/security/cve/CVE-2024-6409.html",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:31.418990",
    "processing_status": "enhanced"
  }
}