{
  "cve_id": "CVE-2024-6674",
  "github_data": {
    "repository": "parisneo/lollms-webui",
    "fix_commit": "c1bb1ad19752aa7541675b398495eaf98fd589f1",
    "related_commits": [
      "c1bb1ad19752aa7541675b398495eaf98fd589f1"
    ],
    "patch_url": "https://github.com/parisneo/lollms-webui/commit/c1bb1ad19752aa7541675b398495eaf98fd589f1.patch",
    "fix_commit_details": {
      "sha": "c1bb1ad19752aa7541675b398495eaf98fd589f1",
      "commit_date": "2024-07-10T20:43:14Z",
      "author": {
        "login": "ParisNeo",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "upgraded ui",
        "length": 11,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 470,
        "additions": 235,
        "deletions": 235
      },
      "files": [
        {
          "filename": "lollms_core",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -1 +1 @@\n-Subproject commit b670912834fac7e03253f5bfd4e4993f74e19d2c\n+Subproject commit 5dbce07f5d623065b37e3c7ccee860d9cc9ed46e"
        },
        {
          "filename": "web/dist/assets/index-635d7a9c.js",
          "status": "renamed",
          "additions": 213,
          "deletions": 213,
          "patch": null
        },
        {
          "filename": "web/dist/assets/index-e245928f.css",
          "status": "renamed",
          "additions": 1,
          "deletions": 1,
          "patch": null
        },
        {
          "filename": "web/dist/index.html",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -6,8 +6,8 @@\n     \n     <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n     <title>LoLLMS WebUI - Welcome</title>\n-    <script type=\"module\" crossorigin src=\"/assets/index-746e673b.js\"></script>\n-    <link rel=\"stylesheet\" href=\"/assets/index-28b1b09c.css\">\n+    <script type=\"module\" crossorigin src=\"/assets/index-635d7a9c.js\"></script>\n+    <link rel=\"stylesheet\" href=\"/assets/index-e245928f.css\">\n   </head>\n   <body>\n     <div id=\"app\"></div>"
        },
        {
          "filename": "web/src/main.js",
          "status": "modified",
          "additions": 1,
          "deletions": 1,
          "patch": "@@ -240,7 +240,7 @@ export const store = createStore({\n       async refreshConfig({ commit }) {\n         console.log(\"Fetching configuration\");\n         try {\n-          const configFile = await api_get_req('get_config')\n+          const configFile = await api_post_req('get_config', {client_id:this.state.client_id})\n           if(configFile.active_personality_id<0){\n             configFile.active_personality_id=0;\n           }"
        },
        {
          "filename": "web/src/views/DiscussionsView.vue",
          "status": "modified",
          "additions": 2,
          "deletions": 2,
          "patch": "@@ -661,7 +661,7 @@ export default {\n                                 // send new data\n                                 try {\n                                     axios.post('/set_active_binding_settings',\n-                                        res).then(response => {\n+                                    {client_id:this.$store.state.client_id, \"settings\":res}).then(response => {\n \n                                             if (response && response.data) {\n                                                 console.log('binding set with new settings', response.data)\n@@ -707,7 +707,7 @@ export default {\n             const res = await axios.post(\"/select_database\", {\"client_id\":this.client_id, \"name\": choice}, {headers: this.posts_headers});\n             if(res.status){\n                 console.log(\"Selected database\")\n-                this.$store.state.config = await axios.get(\"/get_config\");\n+                this.$store.state.config = await axios.post(\"/get_config\",{\"client_id\":this.client_id});\n                 console.log(\"new config loaded :\",this.$store.state.config)\n                 let dbs = await axios.get(\"/list_databases\")[\"data\"];\n                 console.log(\"New list of database: \",dbs)"
        },
        {
          "filename": "web/src/views/SettingsView.vue",
          "status": "modified",
          "additions": 15,
          "deletions": 15,
          "patch": "@@ -4350,7 +4350,7 @@ export default {\n \n         },\n         reinstallComfyUIService(){\n-            axios.get('install_comfyui')\n+            axios.post('install_comfyui', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4360,7 +4360,7 @@ export default {\n \n         },\n         upgradeComfyUIService(){\n-            axios.get('upgrade_comfyui')\n+            axios.post('upgrade_comfyui', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4370,7 +4370,7 @@ export default {\n \n         },\n         startComfyUIService(){\n-            axios.get('start_comfyui')\n+            axios.post('start_comfyui', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4380,7 +4380,7 @@ export default {\n \n         },        \n         showComfyui(){\n-            axios.get('show_comfyui')\n+            axios.post('show_comfyui', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4389,7 +4389,7 @@ export default {\n             });\n         },\n         reinstallMotionCtrlService(){\n-            axios.get('install_motion_ctrl')\n+            axios.post('install_motion_ctrl', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4398,7 +4398,7 @@ export default {\n             });\n         },\n         reinstallvLLMService(){\n-            axios.get('install_vllm')\n+            axios.post('install_vllm', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4408,7 +4408,7 @@ export default {\n \n         },\n         startvLLMService(){\n-            axios.get('start_vllm')\n+            axios.post('start_vllm', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4418,7 +4418,7 @@ export default {\n \n         },\n         startollamaService(){\n-            axios.get('start_ollama')\n+            axios.post('start_ollama', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4428,7 +4428,7 @@ export default {\n \n         },\n         reinstallPetalsService(){\n-            axios.get('install_petals')\n+            axios.post('install_petals', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4438,7 +4438,7 @@ export default {\n \n         },\n         reinstallOLLAMAService(){\n-        axios.get('install_ollama')\n+        axios.post('install_ollama', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4457,7 +4457,7 @@ export default {\n             });\n         },\n         startAudioService(){\n-            axios.get('start_xtts')\n+            axios.personalitiesFiltered('start_xtts', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -4466,7 +4466,7 @@ export default {\n             });\n         },\n         reinstallElasticSearchService(){\n-            axios.get('install_vllm')\n+            axios.post('install_vllm', {client_id:this.$store.state.client_id})\n             .then(response => {\n \n             })\n@@ -5315,7 +5315,7 @@ export default {\n                     this.isLoading = false\n                     if (res) {\n \n-                        console.log('binding sett', res)\n+                        console.log('binding setting', res)\n \n                         if (res.data && Object.keys(res.data).length > 0) {\n \n@@ -5325,11 +5325,11 @@ export default {\n                                 // send new data\n                                 try {\n                                     axios.post('/set_active_binding_settings',\n-                                        res, {headers: this.posts_headers}).then(response => {\n+                                        {client_id:this.$store.state.client_id, \"settings\":res}, {headers: this.posts_headers}).then(response => {\n                                             if (response && response.data) {\n                                                 console.log('binding set with new settings', response.data)\n                                                 this.$store.state.toast.showToast(\"Binding settings updated successfully!\", 4, true)\n-                                                axios.get('/update_binding_settings').then((res) => {\n+                                                axios.post('/update_binding_settings', {client_id:this.$store.state.client_id}).then((res) => {\n                                                     this.$store.state.toast.showToast(\"Binding settings committed successfully!\", 4, true)\n                                                     window.location.href = \"/\";\n                                                 })"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 5,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "074fbb5988845100e16e33abe200c6fb0906ee49",
            "date": "2025-01-14T17:11:50Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "15b0e5ee7d3fdcec02e74e6ffceb09ddc44b7264",
            "date": "2025-01-14T17:11:41Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "78b7303da280e81d7891d022430c9e7019036409",
            "date": "2025-01-14T08:22:08Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "858e69c34a9f91c02d64f4736c2c61032a930ef5",
            "date": "2025-01-14T07:56:40Z",
            "author_login": "ParisNeo"
          },
          {
            "sha": "953879e8b018a8602bd142844c1d7f008e8ab01c",
            "date": "2025-01-13T22:54:09Z",
            "author_login": "ParisNeo"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.1,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:L/A:N",
    "cwe_id": "CWE-346",
    "description": "A CORS misconfiguration in parisneo/lollms-webui prior to version 10 allows attackers to steal sensitive information such as logs, browser sessions, and settings containing private API keys from other services. This vulnerability can also enable attackers to perform actions on behalf of a user, such as deleting a project or sending a message. The issue impacts the confidentiality and integrity of the information.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-10-29T13:15:08.263",
    "last_modified": "2024-11-01T20:34:18.697",
    "fix_date": "2024-07-10T20:43:14Z"
  },
  "references": [
    {
      "url": "https://github.com/parisneo/lollms-webui/commit/c1bb1ad19752aa7541675b398495eaf98fd589f1",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/e688f71b-a3a4-4f6d-b48a-837073fa6908",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:27.104308",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "lollms-webui",
    "owner": "parisneo",
    "created_at": "2023-04-06T16:38:00Z",
    "updated_at": "2025-01-14T10:08:17Z",
    "pushed_at": "2025-01-14T08:22:08Z",
    "size": 154737,
    "stars": 4437,
    "forks": 557,
    "open_issues": 162,
    "watchers": 4437,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [
      "main"
    ],
    "languages": {
      "CSS": 2202947,
      "Vue": 1151251,
      "Python": 353630,
      "JavaScript": 179164,
      "Shell": 41865,
      "Batchfile": 30713,
      "Inno Setup": 27460,
      "HTML": 22305,
      "Jupyter Notebook": 3623,
      "Dockerfile": 1246
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "apache-2.0"
    },
    "collected_at": "2025-01-14T14:52:33.568829"
  }
}