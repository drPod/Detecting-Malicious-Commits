{
  "cve_id": "CVE-2024-7659",
  "github_data": {
    "repository": "projectsend/projectsend",
    "fix_commit": "aa27eb97edc2ff2b203f97e6675d7b5ba0a22a17",
    "related_commits": [
      "aa27eb97edc2ff2b203f97e6675d7b5ba0a22a17"
    ],
    "patch_url": "https://github.com/projectsend/projectsend/commit/aa27eb97edc2ff2b203f97e6675d7b5ba0a22a17.patch",
    "fix_commit_details": {
      "sha": "aa27eb97edc2ff2b203f97e6675d7b5ba0a22a17",
      "commit_date": "2024-08-02T00:21:51Z",
      "author": {
        "login": "ignacionelson",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "Generate secure random strings. Found by hassan al-khafaji",
        "length": 58,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 7,
        "additions": 1,
        "deletions": 6
      },
      "files": [
        {
          "filename": "includes/functions.php",
          "status": "modified",
          "additions": 1,
          "deletions": 6,
          "patch": "@@ -1231,12 +1231,7 @@ function make_excerpt($string, $length, $break = \"...\")\n  */\n function generate_random_string($length = 10)\n {\n-    $characters = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n-    $rnd_result = '';\n-    for ($i = 0; $i < $length; $i++) {\n-        $rnd_result .= $characters[rand(0, strlen($characters) - 1)];\n-    }\n-    return $rnd_result;\n+    return substr(bin2hex(random_bytes($length)), 0, $length);\n }\n \n function get_file_type_by_mime($full_path)"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 1
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "dedd05cd53642075dd72de30422990f9d2f5a351",
            "date": "2024-12-11T12:48:28Z",
            "author_login": "ignacionelson"
          },
          {
            "sha": "ae24fa6c227385295614099107ca64b6c5cd64f1",
            "date": "2024-12-11T07:12:39Z",
            "author_login": "jsellens"
          },
          {
            "sha": "f44ebd5d80cdc9ec01579d7340369d9b416e3fa8",
            "date": "2024-12-11T07:07:42Z",
            "author_login": "jsellens"
          },
          {
            "sha": "311098be5a06ec3a4cbb733d1ef790f885795cc2",
            "date": "2024-12-08T22:34:54Z",
            "author_login": "ignacionelson"
          },
          {
            "sha": "13d66acd8878aadcf8a3069bb4cdf1393e67ad11",
            "date": "2024-12-07T19:32:47Z",
            "author_login": "ignacionelson"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.7,
    "cvss_vector": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
    "cwe_id": "CWE-330",
    "description": "A vulnerability, which was classified as problematic, was found in projectsend up to r1605. Affected is the function generate_random_string of the file includes/functions.php of the component Password Reset Token Handler. The manipulation leads to insufficiently random values. It is possible to launch the attack remotely. The complexity of an attack is rather high. The exploitability is told to be difficult. Upgrading to version r1720 is able to address this issue. The name of the patch is aa27eb97edc2ff2b203f97e6675d7b5ba0a22a17. It is recommended to upgrade the affected component.",
    "attack_vector": "NETWORK",
    "attack_complexity": "HIGH"
  },
  "temporal_data": {
    "published_date": "2024-08-12T13:38:49.920",
    "last_modified": "2024-08-15T17:49:42.667",
    "fix_date": "2024-08-02T00:21:51Z"
  },
  "references": [
    {
      "url": "https://github.com/projectsend/projectsend/commit/aa27eb97edc2ff2b203f97e6675d7b5ba0a22a17",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/projectsend/projectsend/releases/tag/r1720",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.274116",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.274116",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?submit.385004",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:34.552153",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "projectsend",
    "owner": "projectsend",
    "created_at": "2014-03-12T08:06:39Z",
    "updated_at": "2025-01-13T23:54:16Z",
    "pushed_at": "2024-12-11T12:48:28Z",
    "size": 11294,
    "stars": 1460,
    "forks": 313,
    "open_issues": 514,
    "watchers": 1460,
    "has_security_policy": false,
    "default_branch": "develop",
    "protected_branches": [
      "develop"
    ],
    "languages": {
      "PHP": 1202341,
      "SCSS": 216014,
      "Less": 146690,
      "JavaScript": 106558,
      "HTML": 3039,
      "CSS": 897
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "gpl-2.0"
    },
    "collected_at": "2025-01-14T13:57:11.967732"
  }
}