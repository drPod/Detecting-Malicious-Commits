{
  "cve_id": "CVE-2024-8005",
  "github_data": {
    "repository": "demozx/gf_cms",
    "fix_commit": "be702ada7cb6fdabc02689d90b38139c827458a5",
    "related_commits": [
      "be702ada7cb6fdabc02689d90b38139c827458a5",
      "de51cc57a96ccca905c837ef925c2cc3a5241383"
    ],
    "patch_url": "https://github.com/demozx/gf_cms/commit/be702ada7cb6fdabc02689d90b38139c827458a5.patch",
    "fix_commit_details": {
      "sha": "be702ada7cb6fdabc02689d90b38139c827458a5",
      "commit_date": "2024-08-19T13:28:40Z",
      "author": {
        "login": "demozx",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "\u4fee\u590djwt\u5b89\u5168\u95ee\u9898\uff0c\u65b0\u589eserver.jwtKey\u914d\u7f6e\uff0c\u4e0d\u914d\u7f6e\u5219\u4f7f\u7528server.projectName",
        "length": 52,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 17,
        "additions": 15,
        "deletions": 2
      },
      "files": [
        {
          "filename": "internal/logic/auth/auth.go",
          "status": "modified",
          "additions": 3,
          "deletions": 2,
          "patch": "@@ -3,6 +3,7 @@ package auth\n import (\n \t\"context\"\n \t\"gf_cms/internal/logic/admin\"\n+\t\"gf_cms/internal/logic/util\"\n \t\"gf_cms/internal/model\"\n \t\"gf_cms/internal/service\"\n \t\"time\"\n@@ -33,8 +34,8 @@ func init() {\n \tservice.RegisterAuth(New())\n \n \tauth := jwt.New(&jwt.GfJWTMiddleware{\n-\t\tRealm:           \"test zone\",\n-\t\tKey:             []byte(\"secret key\"),\n+\t\tRealm:           util.Util().ProjectName() + \"_backend\",\n+\t\tKey:             []byte(util.Util().JwtKey()),\n \t\tTimeout:         time.Minute * 5,\n \t\tMaxRefresh:      time.Minute * 5,\n \t\tIdentityKey:     \"id\","
        },
        {
          "filename": "internal/logic/util/util.go",
          "status": "modified",
          "additions": 9,
          "deletions": 0,
          "patch": "@@ -78,6 +78,15 @@ func (*sUtil) ProjectName() string {\n \treturn ProjectName.String()\n }\n \n+// JwtKey \u83b7\u53d6JwtKey\n+func (*sUtil) JwtKey() string {\n+\tjwtKey := Util().GetConfig(\"server.jwtKey\")\n+\tif jwtKey == \"\" {\n+\t\treturn ProjectName.String()\n+\t}\n+\treturn jwtKey\n+}\n+\n // SystemRoot \u83b7\u53d6SystemRoot\n func (*sUtil) SystemRoot() string {\n \treturn SystemRoot"
        },
        {
          "filename": "internal/service/util.go",
          "status": "modified",
          "additions": 2,
          "deletions": 0,
          "patch": "@@ -18,6 +18,8 @@ type (\n \t\tDryRun() bool\n \t\t// ProjectName \u83b7\u53d6ProjectName\n \t\tProjectName() string\n+\t\t// JwtKey \u83b7\u53d6JwtKey\n+\t\tJwtKey() string\n \t\t// SystemRoot \u83b7\u53d6SystemRoot\n \t\tSystemRoot() string\n \t\t// BackendPrefix \u540e\u53f0\u5165\u53e3\u524d\u7f00"
        },
        {
          "filename": "manifest/config/config.yaml.example",
          "status": "modified",
          "additions": 1,
          "deletions": 0,
          "patch": "@@ -2,6 +2,7 @@ server:\n   projectName: \"gf_cms\"\n   backendPrefix: \"admin\"\n   address: \":8001\"\n+  jwtKey: \"\" # jwt\u5bc6\u94a5\uff0c\u4e0d\u914d\u7f6e\u5c06\u4f7f\u7528projectName\uff0c\u4e3a\u4e86\u5b89\u5168\u4e00\u5b9a\u8981\u914d\u7f6e\n   openapiPath: \"/api.json\"\n   #  swaggerPath: \"/swagger\" #\u4f7f\u7528\u81ea\u5b9a\u4e49SwaggerUI,\u9700\u6ce8\u91ca\u8be5\u884c\n   serverRoot: \"resource/public\""
        }
      ],
      "file_patterns": {
        "security_files": 1,
        "config_files": 1,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 4,
        "max_directory_depth": 3
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b2cacd85bdb85161e394169aa9cd34bf6e15bc89",
            "date": "2024-11-24T11:42:42Z",
            "author_login": "demozx"
          },
          {
            "sha": "94793babbf94664592310a9115d3da9f8dd9cbe1",
            "date": "2024-11-20T13:19:27Z",
            "author_login": "demozx"
          },
          {
            "sha": "25fa68c77659c0e0e2863f9b2790feb169732f68",
            "date": "2024-11-19T02:31:38Z",
            "author_login": "demozx"
          },
          {
            "sha": "b93379ace14a1f3cacb747bd218364ed2bba70e8",
            "date": "2024-09-26T09:04:50Z",
            "author_login": "demozx"
          },
          {
            "sha": "65dccd8d0f617799120c44fee3eb4ed7f1e07ac1",
            "date": "2024-09-10T02:12:24Z",
            "author_login": "demozx"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 7.3,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L",
    "cwe_id": "CWE-798",
    "description": "A vulnerability was found in demozx gf_cms 1.0/1.0.1. It has been classified as critical. This affects the function init of the file internal/logic/auth/auth.go of the component JWT Authentication. The manipulation leads to hard-coded credentials. It is possible to initiate the attack remotely. The exploit has been disclosed to the public and may be used. Upgrading to version 1.0.2 is able to address this issue. The patch is named be702ada7cb6fdabc02689d90b38139c827458a5. It is recommended to upgrade the affected component.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-20T14:15:11.130",
    "last_modified": "2024-08-21T15:49:59.470",
    "fix_date": "2024-08-19T13:28:40Z"
  },
  "references": [
    {
      "url": "https://github.com/demozx/gf_cms/commit/be702ada7cb6fdabc02689d90b38139c827458a5",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/demozx/gf_cms/commit/de51cc57a96ccca905c837ef925c2cc3a5241383",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/demozx/gf_cms/issues/5",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/demozx/gf_cms/issues/5#issuecomment-2296590417",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.275199",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?id.275199",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?submit.393981",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.373868",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "gf_cms",
    "owner": "demozx",
    "created_at": "2023-11-17T04:03:10Z",
    "updated_at": "2025-01-08T02:06:14Z",
    "pushed_at": "2024-11-24T11:42:47Z",
    "size": 10406,
    "stars": 58,
    "forks": 17,
    "open_issues": 0,
    "watchers": 58,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Go": 14110997
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-14T16:11:24.525570"
  }
}