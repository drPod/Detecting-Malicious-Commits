{
  "cve_id": "CVE-2024-8006",
  "github_data": {
    "repository": "the-tcpdump-group/libpcap",
    "fix_commit": "0f8a103469ce87d2b8d68c5130a46ddb7fb5eb29",
    "related_commits": [
      "0f8a103469ce87d2b8d68c5130a46ddb7fb5eb29",
      "8a633ee5b9ecd9d38a587ac9b204e2380713b0d6"
    ],
    "patch_url": null,
    "fix_commit_details": {
      "sha": "0f8a103469ce87d2b8d68c5130a46ddb7fb5eb29",
      "commit_date": "2024-08-19T10:31:53Z",
      "author": {
        "login": "vwvw",
        "type": "User",
        "stats": {
          "total_commits": 2,
          "average_weekly_commits": 0.0015128593040847202,
          "total_additions": 11,
          "total_deletions": 3,
          "weeks_active": 1
        }
      },
      "commit_message": {
        "title": "makes pcap_findalldevs_ex errors out if the directory does not exist",
        "length": 68,
        "has_description": false,
        "references_issue": false
      },
      "stats": {
        "total": 9,
        "additions": 8,
        "deletions": 1
      },
      "files": [
        {
          "filename": "pcap.c",
          "status": "modified",
          "additions": 8,
          "deletions": 1,
          "patch": "@@ -4826,14 +4826,21 @@ pcap_findalldevs_ex(const char *source, struct pcap_rmtauth *auth _USED_FOR_REMO\n #else\n \t\t/* opening the folder */\n \t\tunixdir= opendir(path);\n+\t\tif (unixdir == NULL) {\n+\t\t\tDIAG_OFF_FORMAT_TRUNCATION\n+\t\t\tsnprintf(errbuf, PCAP_ERRBUF_SIZE,\n+\t\t\t    \"Error when listing files: does folder '%s' exist?\", path);\n+\t\t\tDIAG_ON_FORMAT_TRUNCATION\n+\t\t\treturn (PCAP_ERROR);\n+\t\t}\n \n \t\t/* get the first file into it */\n \t\tfiledata= readdir(unixdir);\n \n \t\tif (filedata == NULL) {\n \t\t\tDIAG_OFF_FORMAT_TRUNCATION\n \t\t\tsnprintf(errbuf, PCAP_ERRBUF_SIZE,\n-\t\t\t    \"Error when listing files: does folder '%s' exist?\", path);\n+\t\t\t    \"Error when listing files: does folder '%s' contain files?\", path);\n \t\t\tDIAG_ON_FORMAT_TRUNCATION\n \t\t\tclosedir(unixdir);\n \t\t\treturn (PCAP_ERROR);"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "b7af3524d2ad694021d68f91aa8cc4894f837c1a",
            "date": "2025-01-25T16:33:33Z",
            "author_login": "infrastation"
          },
          {
            "sha": "cae8bdc7557382835440fba026353a2e52af6ad7",
            "date": "2025-01-24T20:32:08Z",
            "author_login": "infrastation"
          },
          {
            "sha": "f9f9b228943efeb18f9d5867e4dd0b8deb11feb5",
            "date": "2025-01-23T19:13:38Z",
            "author_login": "infrastation"
          },
          {
            "sha": "31e311a5537fa6c30284ea05f91bc91a52d9e107",
            "date": "2025-01-24T22:21:51Z",
            "author_login": "infrastation"
          },
          {
            "sha": "e3d34e7e69b2aa37cbc124411ec7a862ee3694b3",
            "date": "2025-01-21T20:55:30Z",
            "author_login": "guyharris"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 4.4,
    "cvss_vector": "CVSS:3.1/AV:L/AC:L/PR:H/UI:N/S:U/C:N/I:N/A:H",
    "cwe_id": "CWE-476",
    "description": "Remote packet capture support is disabled by default in libpcap.  When a user builds libpcap with remote packet capture support enabled, one of the functions that become available is pcap_findalldevs_ex().  One of the function arguments can be a filesystem path, which normally means a directory with input data files.  When the specified path cannot be used as a directory, the function receives NULL from opendir(), but does not check the return value and passes the NULL value to readdir(), which causes a NULL pointer derefence.",
    "attack_vector": "LOCAL",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-08-31T00:15:05.743",
    "last_modified": "2024-09-19T17:46:03.447",
    "fix_date": "2024-08-19T10:31:53Z"
  },
  "references": [
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/commit/0f8a103469ce87d2b8d68c5130a46ddb7fb5eb29",
      "source": "security@tcpdump.org",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/the-tcpdump-group/libpcap/commit/8a633ee5b9ecd9d38a587ac9b204e2380713b0d6",
      "source": "security@tcpdump.org",
      "tags": [
        "Patch"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:08:37.419510",
    "processing_status": "enhanced"
  },
  "repository_context": {
    "name": "libpcap",
    "owner": "the-tcpdump-group",
    "created_at": "2013-04-14T21:46:36Z",
    "updated_at": "2025-01-25T16:38:11Z",
    "pushed_at": "2025-01-25T16:38:06Z",
    "size": 19363,
    "stars": 2766,
    "forks": 862,
    "open_issues": 133,
    "watchers": 2766,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "libpcap-0.6",
      "libpcap-0.7",
      "libpcap-0.8",
      "libpcap-0.9",
      "libpcap-1.0",
      "libpcap-1.1",
      "libpcap-1.2",
      "libpcap-1.3",
      "libpcap-1.4",
      "libpcap-1.5",
      "libpcap-1.6",
      "libpcap-1.7",
      "libpcap-1.8",
      "libpcap-1.9",
      "libpcap-1.10",
      "master"
    ],
    "languages": {
      "C": 2213383,
      "Roff": 196005,
      "Perl": 171557,
      "CMake": 160284,
      "M4": 86167,
      "Shell": 48212,
      "Makefile": 38449,
      "Lex": 18192,
      "Python": 10732
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "other"
    },
    "collected_at": "2025-01-26T08:02:57.455284"
  }
}