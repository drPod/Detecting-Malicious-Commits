{
  "cve_id": "CVE-2024-8572",
  "github_data": {
    "repository": "gouniverse/cms",
    "fix_commit": "3e661cdfb4beeb9fe2ad507cdb8104c0b17d072c",
    "related_commits": [
      "3e661cdfb4beeb9fe2ad507cdb8104c0b17d072c"
    ],
    "patch_url": "https://github.com/gouniverse/cms/commit/3e661cdfb4beeb9fe2ad507cdb8104c0b17d072c.patch",
    "fix_commit_details": {
      "sha": "3e661cdfb4beeb9fe2ad507cdb8104c0b17d072c",
      "commit_date": "2024-09-05T07:40:42Z",
      "author": {
        "login": "lesichkovm",
        "type": "User",
        "stats": null
      },
      "commit_message": {
        "title": "fix potential XSS vulnerability",
        "length": 31,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 23,
        "additions": 15,
        "deletions": 8
      },
      "files": [
        {
          "filename": "PageBuildHtml.go",
          "status": "modified",
          "additions": 15,
          "deletions": 8,
          "patch": "@@ -4,6 +4,7 @@ import (\n \t\"net/http\"\n \t\"strings\"\n \n+\t\"github.com/gouniverse/hb\"\n \t\"github.com/samber/lo\"\n )\n \n@@ -12,18 +13,24 @@ func (cms *Cms) PageRenderHtmlByAlias(r *http.Request, alias string, language st\n \tpage, err := cms.PageFindByAlias(alias)\n \n \tif err != nil {\n-\t\tcms.LogStore.ErrorWithContext(\"At pageBuldHTMLByAlias\", err.Error())\n-\t\treturn \"Page with alias '\" + alias + \"' not found\"\n+\t\tcms.LogStore.ErrorWithContext(\"At PageRenderHtmlByAlias\", err.Error())\n+\t\treturn hb.NewDiv().\n+\t\t\tText(`Page with alias '`).Text(alias).Text(`' not found`).\n+\t\t\tToHTML()\n \t}\n \n \tif page == nil {\n-\t\treturn \"Page with alias '\" + alias + \"' not found\"\n+\t\treturn hb.NewDiv().\n+\t\t\tText(`Page with alias '`).Text(alias).Text(`' not found`).\n+\t\t\tToHTML()\n \t}\n \n \tpageAttrs, err := page.GetAttributes()\n \n \tif err != nil {\n-\t\treturn \"Page '\" + alias + \"' io exception\"\n+\t\treturn hb.NewDiv().\n+\t\t\tText(`Page with alias '`).Text(alias).Text(`' io exception`).\n+\t\t\tToHTML()\n \t}\n \n \tpageContent := \"\"\n@@ -60,7 +67,7 @@ func (cms *Cms) PageRenderHtmlByAlias(r *http.Request, alias string, language st\n \tfinalContent := lo.If(pageTemplateID == \"\", pageContent).ElseF(func() string {\n \t\tcontent, err := cms.TemplateContentFindByID(pageTemplateID)\n \t\tif err != nil {\n-\t\t\tcms.LogStore.ErrorWithContext(\"At pageBuldHTMLByAlias\", err.Error())\n+\t\t\tcms.LogStore.ErrorWithContext(\"At PageRenderHtmlByAlias\", err.Error())\n \t\t}\n \t\treturn content\n \t})\n@@ -82,19 +89,19 @@ func (cms *Cms) PageRenderHtmlByAlias(r *http.Request, alias string, language st\n \tfinalContent, err = cms.ContentRenderBlocks(finalContent)\n \n \tif err != nil {\n-\t\tcms.LogStore.ErrorWithContext(\"At pageBuldHTMLByAlias\", err.Error())\n+\t\tcms.LogStore.ErrorWithContext(\"At PageRenderHtmlByAlias\", err.Error())\n \t}\n \n \tfinalContent, err = cms.ContentRenderShortcodes(r, finalContent)\n \n \tif err != nil {\n-\t\tcms.LogStore.ErrorWithContext(\"At pageBuldHTMLByAlias\", err.Error())\n+\t\tcms.LogStore.ErrorWithContext(\"At PageRenderHtmlByAlias\", err.Error())\n \t}\n \n \tfinalContent, err = cms.ContentRenderTranslations(finalContent, language)\n \n \tif err != nil {\n-\t\tcms.LogStore.ErrorWithContext(\"At pageBuldHTMLByAlias\", err.Error())\n+\t\tcms.LogStore.ErrorWithContext(\"At PageRenderHtmlByAlias\", err.Error())\n \t}\n \n \treturn finalContent"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 0
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "1bab0756f35d03acef396f2cb2f3f9907811066b",
            "date": "2024-12-11T08:08:47Z",
            "author_login": "Sinevia"
          },
          {
            "sha": "852b641d468acb8dd902a0ce4ac9ac7ec85bdf35",
            "date": "2024-11-28T20:49:27Z",
            "author_login": "Sinevia"
          },
          {
            "sha": "db33d4eaf5d7f3c0615a03ba9702c5510abe7248",
            "date": "2024-11-24T18:10:59Z",
            "author_login": "Sinevia"
          },
          {
            "sha": "1db88fcf191d6ec65f3b9a0ac4843bfcb4fc1d8b",
            "date": "2024-11-24T12:17:40Z",
            "author_login": "lesichkovm"
          },
          {
            "sha": "79d2007842c84ce4d5635a71e7013fc3a5eee9e6",
            "date": "2024-11-24T12:16:51Z",
            "author_login": "lesichkovm"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": 3.5,
    "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
    "cwe_id": "CWE-79",
    "description": "A vulnerability was found in Gouniverse GoLang CMS 1.4.0. It has been declared as problematic. This vulnerability affects the function PageRenderHtmlByAlias of the file FrontendHandler.go. The manipulation of the argument alias leads to cross site scripting. The attack can be initiated remotely. Upgrading to version 1.4.1 is able to address this issue. The patch is identified as 3e661cdfb4beeb9fe2ad507cdb8104c0b17d072c. It is recommended to upgrade the affected component.",
    "attack_vector": "NETWORK",
    "attack_complexity": "LOW"
  },
  "temporal_data": {
    "published_date": "2024-09-08T08:15:13.443",
    "last_modified": "2024-09-11T15:59:57.040",
    "fix_date": "2024-09-05T07:40:42Z"
  },
  "references": [
    {
      "url": "https://github.com/gouniverse/cms/commit/3e661cdfb4beeb9fe2ad507cdb8104c0b17d072c",
      "source": "cna@vuldb.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/gouniverse/cms/issues/5",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/gouniverse/cms/issues/5#issuecomment-2330848731",
      "source": "cna@vuldb.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://github.com/gouniverse/cms/releases/tag/v1.4.1",
      "source": "cna@vuldb.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://vuldb.com/?ctiid.276802",
      "source": "cna@vuldb.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://vuldb.com/?id.276802",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://vuldb.com/?submit.401896",
      "source": "cna@vuldb.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:00.104418",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "cms",
    "owner": "gouniverse",
    "created_at": "2020-12-26T18:54:05Z",
    "updated_at": "2025-01-09T16:51:14Z",
    "pushed_at": "2024-12-11T08:09:37Z",
    "size": 774,
    "stars": 25,
    "forks": 7,
    "open_issues": 0,
    "watchers": 25,
    "has_security_policy": false,
    "default_branch": "main",
    "protected_branches": [],
    "languages": {
      "Go": 317345
    },
    "commit_activity": {
      "total_commits_last_year": 0,
      "avg_commits_per_week": 0,
      "days_active_last_year": 0
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": false,
      "has_wiki": true,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T17:46:22.368653"
  }
}