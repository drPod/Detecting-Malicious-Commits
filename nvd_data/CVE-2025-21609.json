{
  "cve_id": "CVE-2025-21609",
  "github_data": {
    "repository": "siyuan-note/siyuan",
    "fix_commit": "d9887aeec1b27073bec66299a9a4181dc42969f3",
    "related_commits": [
      "d9887aeec1b27073bec66299a9a4181dc42969f3"
    ],
    "patch_url": "https://github.com/siyuan-note/siyuan/commit/d9887aeec1b27073bec66299a9a4181dc42969f3.patch",
    "fix_commit_details": {
      "sha": "d9887aeec1b27073bec66299a9a4181dc42969f3",
      "commit_date": "2025-01-03T01:48:08Z",
      "author": {
        "login": "88250",
        "type": "User",
        "stats": {
          "total_commits": 7635,
          "average_weekly_commits": 33.34061135371179,
          "total_additions": 0,
          "total_deletions": 0,
          "weeks_active": 221
        }
      },
      "commit_message": {
        "title": ":lock: Arbitrary file deletion vulnerability https://github.com/siyuan-note/siyuan/issues/13709",
        "length": 95,
        "has_description": false,
        "references_issue": true
      },
      "stats": {
        "total": 11,
        "additions": 9,
        "deletions": 2
      },
      "files": [
        {
          "filename": "kernel/model/history.go",
          "status": "modified",
          "additions": 9,
          "deletions": 2,
          "patch": "@@ -18,6 +18,7 @@ package model\n \n import (\n \t\"encoding/json\"\n+\t\"errors\"\n \t\"fmt\"\n \t\"io/fs\"\n \t\"math\"\n@@ -148,6 +149,13 @@ func ClearWorkspaceHistory() (err error) {\n }\n \n func GetDocHistoryContent(historyPath, keyword string, highlight bool) (id, rootID, content string, isLargeDoc bool, err error) {\n+\tif !util.IsAbsPathInWorkspace(historyPath) {\n+\t\tmsg := \"Path [\" + historyPath + \"] is not in workspace\"\n+\t\tlogging.LogErrorf(msg)\n+\t\terr = errors.New(msg)\n+\t\treturn\n+\t}\n+\n \tif !gulu.File.IsExist(historyPath) {\n \t\tlogging.LogWarnf(\"doc history [%s] not exist\", historyPath)\n \t\treturn\n@@ -163,8 +171,7 @@ func GetDocHistoryContent(historyPath, keyword string, highlight bool) (id, root\n \tluteEngine := NewLute()\n \thistoryTree, err := filesys.ParseJSONWithoutFix(data, luteEngine.ParseOptions)\n \tif err != nil {\n-\t\tlogging.LogErrorf(\"parse tree from file [%s] failed, remove it\", historyPath)\n-\t\tos.RemoveAll(historyPath)\n+\t\tlogging.LogErrorf(\"parse tree from file [%s] failed: %s\", historyPath, err)\n \t\treturn\n \t}\n \tid = historyTree.Root.ID"
        }
      ],
      "file_patterns": {
        "security_files": 0,
        "config_files": 0,
        "dependency_files": 0,
        "test_files": 0,
        "unique_directories": 1,
        "max_directory_depth": 2
      },
      "context": {
        "surrounding_commits": [
          {
            "sha": "56f8ea4ab9d59cb9e3f0e907c0deb2909f30f32c",
            "date": "2025-01-07T00:40:03Z",
            "author_login": "88250"
          },
          {
            "sha": "593b6527936e46ea5c8b50443d6a4f7ed4ed5196",
            "date": "2025-01-07T00:36:09Z",
            "author_login": "88250"
          },
          {
            "sha": "db5bdac6328090c3443fbb93a2e25b1c33a7048b",
            "date": "2025-01-07T00:35:58Z",
            "author_login": "88250"
          },
          {
            "sha": "878ea8e06a6d42bb51fc3a6ac3e92113dba9be87",
            "date": "2025-01-07T00:38:26Z",
            "author_login": "Vanessa219"
          },
          {
            "sha": "3b2d8be02337b2f7356f77dee2af99a2764c6260",
            "date": "2025-01-07T00:38:14Z",
            "author_login": "Vanessa219"
          }
        ]
      }
    }
  },
  "vulnerability_details": {
    "cvss_score": null,
    "cvss_vector": null,
    "cwe_id": "CWE-459",
    "description": "SiYuan is self-hosted, open source personal knowledge management software. SiYuan Note version 3.1.18 has an arbitrary file deletion vulnerability. The vulnerability exists in the `POST /api/history/getDocHistoryContent` endpoint. An attacker can craft a payload to exploit this vulnerability, resulting in the deletion of arbitrary files on the server. Commit d9887aeec1b27073bec66299a9a4181dc42969f3 fixes this vulnerability and is expected to be available in version 3.1.19.",
    "attack_vector": null,
    "attack_complexity": null
  },
  "temporal_data": {
    "published_date": "2025-01-03T17:15:09.147",
    "last_modified": "2025-01-03T17:15:09.147",
    "fix_date": "2025-01-03T01:48:08Z"
  },
  "references": [
    {
      "url": "https://github.com/siyuan-note/siyuan/commit/d9887aeec1b27073bec66299a9a4181dc42969f3",
      "source": "security-advisories@github.com",
      "tags": []
    },
    {
      "url": "https://github.com/siyuan-note/siyuan/security/advisories/GHSA-8fx8-pffw-w498",
      "source": "security-advisories@github.com",
      "tags": []
    }
  ],
  "collection_metadata": {
    "collected_at": "2025-01-11T23:09:52.951922",
    "processing_status": "raw"
  },
  "repository_context": {
    "name": "siyuan",
    "owner": "siyuan-note",
    "created_at": "2020-08-30T09:21:35Z",
    "updated_at": "2025-01-14T13:21:53Z",
    "pushed_at": "2025-01-14T13:03:22Z",
    "size": 442111,
    "stars": 26412,
    "forks": 1780,
    "open_issues": 286,
    "watchers": 26412,
    "has_security_policy": false,
    "default_branch": "master",
    "protected_branches": [
      "master"
    ],
    "languages": {
      "TypeScript": 4227331,
      "Go": 2196671,
      "JavaScript": 730761,
      "SCSS": 200616,
      "HTML": 97587,
      "CSS": 17262,
      "Smarty": 8421,
      "Shell": 6060,
      "Python": 5971,
      "NSIS": 2640,
      "Batchfile": 2106,
      "Dockerfile": 1845
    },
    "commit_activity": {
      "total_commits_last_year": 4633,
      "avg_commits_per_week": 89.09615384615384,
      "days_active_last_year": 327
    },
    "security_features": {
      "has_security_policy": false,
      "has_protected_branches": true,
      "has_wiki": false,
      "has_issues": true,
      "allow_forking": true,
      "is_template": false,
      "license": "agpl-3.0"
    },
    "collected_at": "2025-01-14T13:23:13.488258"
  }
}